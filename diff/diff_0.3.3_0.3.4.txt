diff --git a/extension/chrome.manifest b/extension/chrome.manifest
index 82184d1..dc3e81d 100644
--- a/extension/chrome.manifest
+++ b/extension/chrome.manifest
@@ -18,3 +18,4 @@ locale  fireie  en  chrome/locale/en/
 locale  fireie  zh-CN  chrome/locale/zh-CN/
 locale  fireie  zh-TW  chrome/locale/zh-TW/
 locale  fireie  ru-RU  chrome/locale/ru-RU/
+locale  fireie  pl  chrome/locale/pl/
diff --git a/extension/chrome/content/about.js b/extension/chrome/content/about.js
new file mode 100644
index 0000000..efd067c
--- /dev/null
+++ b/extension/chrome/content/about.js
@@ -0,0 +1,159 @@
+/*
+This file is part of Fire-IE.
+
+Fire-IE is free software: you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation, either version 3 of the License, or
+(at your option) any later version.
+
+Fire-IE is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+
+You should have received a copy of the GNU General Public License
+along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+/* This Source Code Form is subject to the terms of the Mozilla Public
+ * License, v. 2.0. If a copy of the MPL was not distributed with this
+ * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
+ 
+function init()
+{
+  if (window.arguments && window.arguments[0])
+  {
+    initAddon(window.arguments[0]);
+    // Show the close button if it is open as a standalone dialog
+    document.getElementById("fireieAbout").buttons = "accept";
+  }
+  else
+  {
+    Cu.import("resource://gre/modules/AddonManager.jsm");
+    AddonManager.getAddonByID(Utils.addonID, initAddon);
+  }
+}
+
+function initAddon(addon)
+{
+  var extensionsStrings = document.getElementById("extensionsStrings");
+  
+  document.documentElement.setAttribute("addontype", addon.type);
+
+  if (addon.iconURL)
+  {
+    var extensionIcon = document.getElementById("extensionIcon");
+    extensionIcon.src = addon.iconURL;
+  }
+
+  document.title = extensionsStrings.getFormattedString("aboutWindowTitle", [addon.name]);
+  var extensionName = document.getElementById("extensionName");
+  extensionName.textContent = addon.name;
+
+  var extensionVersion = document.getElementById("extensionVersion");
+  if (addon.version)
+    extensionVersion.setAttribute("value", extensionsStrings.getFormattedString("aboutWindowVersionString", [addon.version]));
+  else
+    extensionVersion.hidden = true;
+  var extensionDescription = document.getElementById("extensionDescription");
+  if (addon.description)
+    extensionDescription.textContent = addon.description;
+  else
+    extensionDescription.hidden = true;
+  extensionDescription.value = addon.description;
+  var numDetails = 0;
+
+  var extensionCreator = document.getElementById("extensionCreator");
+  if (addon.creator) {
+    extensionCreator.setAttribute("value", addon.creator);
+    numDetails++;
+  } else {
+    extensionCreator.hidden = true;
+    var extensionCreatorLabel = document.getElementById("extensionCreatorLabel");
+    extensionCreatorLabel.hidden = true;
+  }
+
+  numDetails += appendToList("extensionDevelopers", "developersBox", addon.developers);
+  numDetails += appendToList("extensionTranslators", "translatorsBox", addon.translators);
+  numDetails += appendToList("extensionContributors", "contributorsBox", addon.contributors);
+
+  if (numDetails == 0) {
+    var groove = document.getElementById("groove");
+    groove.hidden = true;
+    var extensionDetailsBox = document.getElementById("extensionDetailsBox");
+    extensionDetailsBox.hidden = true;
+  }
+
+  var acceptButton = document.documentElement.getButton("accept");
+  acceptButton.label = extensionsStrings.getString("aboutWindowCloseButton");
+  
+  processDescriptions();
+  
+  Utils.runAsync(function()
+  {
+    doSizeToContent(window, document);
+    Utils.runAsyncTimeout(function()
+    {
+      document.getElementById("extensionDetailsBox").scrollTop = 0;
+    }, this, 0);
+  }, this);
+}
+
+function appendToList(aHeaderId, aNodeId, aItems) {
+  var header = document.getElementById(aHeaderId);
+  var node = document.getElementById(aNodeId);
+
+  if (!aItems || aItems.length == 0) {
+    header.hidden = true;
+    return 0;
+  }
+
+  for (let currentItem of aItems) {
+    var label = document.createElement("label");
+    label.textContent = currentItem;
+    label.setAttribute("class", "contributor");
+    node.appendChild(label);
+  }
+
+  return aItems.length;
+}
+
+function openLink(url)
+{
+  Utils.loadInBrowser(url);
+}
+
+function processDescription(desc)
+{
+  let template = desc.getAttribute("_textTemplate");
+  if (template)
+  {
+    let html = template.replace(/\[link\s+href\s*=\s*'(.*?)'\](.*?)\[\/link\]/g,
+                       function(str, url, linkText)
+                       {
+                         if (!linkText) linkText = url;
+                         return ["<label class=\"text-link\" tooltiptext=\"", url, "\" ",
+                                 "onclick=\"if (event.button == 0) openLink('", url, "')\">",
+                                 linkText, "</label>"].join("");
+                       })
+                       .replace(/\[(\w+)\]/g, "<html:$1>")
+                       .replace(/\[\/(\w+)\]/g, "</html:$1>")
+                       .replace(/\[(\w+)\s*\/\]/g, "<html:$1 />")
+                       .replace(/\[\.([\w\d.#]+)\]/g, "&$1;");
+    desc.innerHTML = html;
+  }
+  else if (!desc.textContent)
+  {
+    desc.hidden = true;
+  }
+}
+
+function processDescriptions()
+{
+  let descs = document.getElementsByTagName("description");
+  for (let i = 0; i < descs.length; i++)
+  {
+    let desc = descs[i];
+    processDescription(desc);
+  }
+}
diff --git a/extension/chrome/content/about.xul b/extension/chrome/content/about.xul
new file mode 100644
index 0000000..9e06e9d
--- /dev/null
+++ b/extension/chrome/content/about.xul
@@ -0,0 +1,94 @@
+<?xml version="1.0"?>
+<!--
+This file is part of Fire-IE.
+
+Fire-IE is free software: you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation, either version 3 of the License, or
+(at your option) any later version.
+
+Fire-IE is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+
+You should have received a copy of the GNU General Public License
+along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
+-->
+
+<!-- This Source Code Form is subject to the terms of the Mozilla Public
+   - License, v. 2.0. If a copy of the MPL was not distributed with this
+   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->
+
+<?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
+<?xml-stylesheet href="chrome://mozapps/skin/extensions/about.css" type="text/css"?> 
+<?xml-stylesheet href="chrome://fireie/skin/about.css" type="text/css"?>
+
+<!DOCTYPE dialog [
+  <!ENTITY % globalDTD
+    SYSTEM "chrome://mozapps/locale/extensions/about.dtd">
+  %globalDTD;
+  <!ENTITY % aboutDTD
+    SYSTEM "chrome://fireie/locale/about.dtd">
+  %aboutDTD;
+]>
+
+<dialog
+  xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
+  xmlns:html="http://www.w3.org/1999/xhtml"
+  buttons="none"
+  id="fireieAbout"
+  windowtype="fireie:about"
+  onload="init()"
+  onaccept="close();"
+  defaultButton="accept">
+        
+  <script type="application/x-javascript" src="utils.js"/>
+  <script type="application/x-javascript" src="about.js"/>
+  
+  <stringbundleset id="aboutSet">
+    <stringbundle id="extensionsStrings" src="chrome://mozapps/locale/extensions/extensions.properties"/>
+  </stringbundleset>
+
+  <vbox id="clientBox" flex="1">
+    <hbox class="basic-info">
+      <vbox pack="center">
+        <image id="extensionIcon"/>
+      </vbox>
+      <vbox flex="1">
+        <label id="extensionName"></label>
+        <label id="extensionVersion" crop="end"/>
+      </vbox>
+    </hbox>
+    <html:p id="extensionDescription" class="boxIndent"/>
+
+    <separator id="groove" class="groove"/>
+    
+    <vbox id="extensionDetailsBox" flex="1">
+      <label id="longDescLabel" class="sectionTitle">&about.longDesc.label;</label>
+      <description id="longDesc" class="boxIndent" _textTemplate="&about.longDesc;"></description>
+
+      <label id="whyLabel" class="sectionTitle">&about.why.label;</label>
+      <description id="why" class="boxIndent" _textTemplate="&about.why;"></description>
+
+      <label id="whatsNextLabel" class="sectionTitle">&about.whatsNext.label;</label>
+      <description id="whatsNext" class="boxIndent" _textTemplate="&about.whatsNext;"></description>
+      
+      <label id="linksLabel" class="sectionTitle">&about.links.label;</label>
+      <description id="links" class="boxIndent" _textTemplate="&about.links;"></description>
+      
+      <label id="extensionCreatorLabel" class="sectionTitle">&creator.label;</label>
+      <hbox id="creatorBox" class="boxIndent">
+        <label id="extensionCreator" flex="1" crop="end"/>
+      </hbox>
+      
+      <label id="extensionDevelopers" class="sectionTitle">&developers.label;</label>
+      <vbox flex="1" id="developersBox" class="boxIndent"/>
+      <label id="extensionTranslators" class="sectionTitle">&translators.label;</label>
+      <vbox flex="1" id="translatorsBox" class="boxIndent"/>
+      <label id="extensionContributors" class="sectionTitle">&contributors.label;</label>
+      <vbox flex="1" id="contributorsBox" class="boxIndent"/>
+    </vbox>
+    
+  </vbox>
+</dialog>
diff --git a/extension/chrome/content/container.js b/extension/chrome/content/container.js
index ca0357e..0576775 100644
--- a/extension/chrome/content/container.js
+++ b/extension/chrome/content/container.js
@@ -77,7 +77,16 @@ let FireIEContainer = {};
 
   function needPrivateBrowsingWarning()
   {
-    return gFireIE && gFireIE.isPrivateBrowsing() && Prefs.privatebrowsingwarning && !gFireIE.isResumeFromPBW();
+    let need = gFireIE && gFireIE.isPrivateBrowsing() && Prefs.privatebrowsingwarning && !gFireIE.isResumeFromPBW();
+    // If we have fireieNavigateParams.id, the tab is a new window opened from IE
+    // We should attach to it as soon as possible, ignoring privatebrowsingwarning
+    if (need)
+    {
+      let tab = Utils.getTabFromDocument(document);
+      let params = Utils.getTabAttributeJSON(tab, "fireieNavigateParams");
+      need = !params || !params.id;
+    }
+    return !!need;
   }
 
   function destory()
@@ -141,24 +150,12 @@ let FireIEContainer = {};
     window.addEventListener("CloseIETab", onCloseIETab, false);
     window.addEventListener("IEDocumentComplete", onIEDocumentComplete, false);
     window.addEventListener("IEProgressChanged", onIEProgressChange, false);
+    window.addEventListener("IEURLChanged", onIEURLChanged, false);
     E(Utils.containerPluginId).addEventListener("focus", onPluginFocus, false);
     E(Utils.statusBarId).addEventListener("SetStatusText", onSetStatusText, false);
     E(Utils.statusBarId).addEventListener("mousemove", onStatusMouseMove, false);
     // support focus on plain DOMMouseScroll
     E("container").addEventListener("DOMMouseScroll", onDOMMouseScroll, false);
-    // Use the following code to check mouse events
-    /*
-    window.addEventListener("mousedown", function(e)
-    {
-      Utils.ERROR((e.button == 0 ? "left" : (e.button == 1 ? "middle" : "right")) + "mousedown " +
-        "from " + e.originalTarget.toString());
-    }, false);
-    window.addEventListener("mouseup", function(e)
-    {
-      Utils.ERROR((e.button == 0 ? "left" : (e.button == 1 ? "middle" : "right")) + "mouseup " +
-        "from " + e.originalTarget.toString());
-    }, false);
-    */
   }
 
   function unregisterEventHandler()
@@ -167,6 +164,7 @@ let FireIEContainer = {};
     window.removeEventListener("CloseIETab", onCloseIETab, false);
     window.removeEventListener("IEDocumentComplete", onIEDocumentComplete, false);
     window.removeEventListener("IEProgressChanged", onIEProgressChange, false);
+    window.removeEventListener("IEURLChanged", onIEURLChanged, false);
     E(Utils.containerPluginId).removeEventListener("focus", onPluginFocus, false);
     E(Utils.statusBarId).removeEventListener("SetStatusText", onSetStatusText, false);
     E(Utils.statusBarId).removeEventListener("mousemove", onStatusMouseMove, false);
@@ -205,6 +203,36 @@ let FireIEContainer = {};
     syncURL();
   }
   
+  function onIEURLChanged(event)
+  {
+    checkSwitchBack(event.detail);
+  }
+  
+  let bSwitchEngineInitiated = false;
+
+  function checkSwitchBack(url)
+  {
+    if (bSwitchEngineInitiated)
+      return true;
+
+    if (url)
+    {
+      let containerUrl = Utils.toContainerUrl(url);
+      if (window.location.href != containerUrl)
+      {
+        // Issue #51: check if we need to switch back to Firefox engine
+        if (gFireIE && gFireIE.shouldSwitchBack(url))
+        {
+          bSwitchEngineInitiated = true;
+          gFireIE.switchEngine(Utils.getTabFromWindow(window), true, url);
+          return true;
+        }
+      }
+    }
+    
+    return false;
+  }
+  
   /** sync recorded url when IE engine navigates to another location */
   function syncURL()
   {
@@ -213,14 +241,17 @@ let FireIEContainer = {};
     
     let url = po.URL;
     if (!url) return;
-    
-    url = Utils.toContainerUrl(url);
-    if (window.location.href != url)
+
+    if (checkSwitchBack(url))
+      return;
+      
+    let containerUrl = Utils.toContainerUrl(url);
+    if (window.location.href != containerUrl)
     {
       // HTML5 history manipulation,
       // see http://spoiledmilk.com/blog/html5-changing-the-browser-url-without-refreshing-page
       if (window.history)
-        window.history.replaceState("", document.title, url);
+        window.history.replaceState("", document.title, containerUrl);
     }
   }
   
diff --git a/extension/chrome/content/options2.js b/extension/chrome/content/options2.js
index 77c9c01..a1f6cba 100644
--- a/extension/chrome/content/options2.js
+++ b/extension/chrome/content/options2.js
@@ -76,23 +76,18 @@ Options.apply = function(quiet)
   Prefs.handleUrlBar = E("handleurl").checked;
   Prefs.autoswitch_enabled = !E("disableAutoSwitch").checked;
   let newKey = E("shortcut-key").value;
-  if (Prefs.shortcutEnabled && Prefs.shortcut_key != newKey)
+  if (Prefs.shortcut_key != newKey)
   {
     requiresRestart = true;
   }
   Prefs.shortcut_key = newKey;
   let newModifiers = E("shortcut-modifiers").value;
-  if (Prefs.shortcutEnabled && Prefs.shortcut_modifiers != newModifiers)
+  if (Prefs.shortcut_modifiers != newModifiers)
   {
     requiresRestart = true;
   }
   Prefs.shortcut_modifiers = newModifiers;
-  let newEnabled = E("shortcutEnabled").checked;
-  if (Prefs.shortcutEnabled != newEnabled)
-  {
-    requiresRestart = true;
-    Prefs.shortcutEnabled = E("shortcutEnabled").checked;
-  }
+  Prefs.shortcutEnabled = E("shortcutEnabled").checked;
   Prefs.privatebrowsingwarning = E("privatebrowsingwarning").checked;
   Prefs.showUrlBarLabel = (E("iconDisplay").value == "iconAndText");
   Prefs.hideUrlBarButton = (E("iconDisplay").value == "iconHidden");
@@ -278,29 +273,7 @@ Options.applyGPURenderingState = function()
 // Get IE's main version number
 Options.getIEMainVersion = function()
 {
-  let wrk = Components.classes["@mozilla.org/windows-registry-key;1"].createInstance(Components.interfaces.nsIWindowsRegKey);
-  let version = 6;
-  try
-  {
-    wrk.create(wrk.ROOT_KEY_LOCAL_MACHINE, "SOFTWARE\\Microsoft\\Internet Explorer", wrk.ACCESS_READ);
-    let versionString = wrk.readStringValue("version");
-    version = parseInt(versionString, 10);
-    // for IE 10, version equals to "9.10.*.*", which should be handled specially
-    if (version == 9)
-    {
-      versionString = wrk.readStringValue("svcVersion");
-      version = parseInt(versionString, 10);
-    }
-  }
-  catch (e)
-  {
-    Utils.LOG("Failed to get IE version from registry: " + e);
-  }
-  finally
-  {
-    wrk.close();
-  }
-  return version;
+  return Utils.ieMajorVersion;
 };
 
 Options.updateIEModeTab = function(restore)
@@ -432,14 +405,7 @@ Options.handleShortcutEnabled = function(e)
 
 Options.sizeToContent = function()
 {
-  // for multi-line label sizing problem
-  window.sizeToContent();
-  let vboxes = document.querySelectorAll("prefpane > vbox");
-  Array.prototype.forEach.call(vboxes, function(vbox)
-  {
-    vbox.height = vbox.boxObject.height;
-  });
-  window.sizeToContent();
+  doSizeToContent(window, document);
 };
 
 Options.init = function()
diff --git a/extension/chrome/content/options2.xul b/extension/chrome/content/options2.xul
index c68f0b9..08b5270 100644
--- a/extension/chrome/content/options2.xul
+++ b/extension/chrome/content/options2.xul
@@ -5,7 +5,14 @@
 <?xml-stylesheet href="chrome://global/skin/preferences.css" type="text/css"?>
 <?xml-stylesheet href="chrome://fireie/skin/options.css" type="text/css"?>
 
-<!DOCTYPE prefwindow SYSTEM "chrome://fireie/locale/fireie.dtd">
+<!DOCTYPE prefwindow [
+  <!ENTITY % globalDTD
+    SYSTEM "chrome://mozapps/locale/extensions/extensions.dtd">
+  %globalDTD;
+  <!ENTITY % fireieDTD
+    SYSTEM "chrome://fireie/locale/fireie.dtd">
+  %fireieDTD;
+]>
 
 <prefwindow id="fireie-options"
             xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
@@ -88,6 +95,18 @@
               <menuitem value="7" label="7" />
               <menuitem value="8" label="8" />
               <menuitem value="9" label="9" />
+              <menuitem value="VK_F1" label="F1" />
+              <menuitem value="VK_F2" label="F2" />
+              <menuitem value="VK_F3" label="F3" />
+              <menuitem value="VK_F4" label="F4" />
+              <menuitem value="VK_F5" label="F5" />
+              <menuitem value="VK_F6" label="F6" />
+              <menuitem value="VK_F7" label="F7" />
+              <menuitem value="VK_F8" label="F8" />
+              <menuitem value="VK_F9" label="F9" />
+              <menuitem value="VK_F10" label="F10" />
+              <menuitem value="VK_F11" label="F11" />
+              <menuitem value="VK_F12" label="F12" />
             </menupopup>
           </menulist>
         </hbox>
@@ -136,7 +155,7 @@
               <hbox align="center">
                 <radio id="iconAndText-radio" label="&fireie.options.ui.iconAndText;" value="iconAndText" />
                 <spacer flex="1"/>
-                <image class="icon-and-text" width="150" height="24" onclick="event.button == 0 &amp;&amp; Options.setIconDisplayValue('iconAndText')" style="list-style-image: url('&fireie.options.ui.buttonStylesURL;');" />
+                <image class="icon-and-text" width="150" height="24" onclick="event.button == 0 &amp;&amp; Options.setIconDisplayValue('iconAndText')" style="list-style-image: url('chrome://fireie/locale/url-button-styles.png');" />
               </hbox>
             </radiogroup>
           </vbox>
@@ -226,7 +245,11 @@
         &fireie.options.restart.descr;</label>
     </vbox>
   </prefpane>
-  
+
+  <prefpane id="aboutPane" label="&cmd.about.label;" image="chrome://fireie/skin/icon.png" flex="1">
+    <iframe src="chrome://fireie/content/about.xul" flex="1" />
+  </prefpane>
+
   <hbox class="prefWindow-dlgbuttons">
     <button id="mySettingManager" type="menu"
     label="&fireie.options.manager;">
diff --git a/extension/chrome/content/overlay.js b/extension/chrome/content/overlay.js
index 4fdd0e0..775c35a 100644
--- a/extension/chrome/content/overlay.js
+++ b/extension/chrome/content/overlay.js
@@ -131,7 +131,12 @@ var gFireIE = null;
     {
       let container = gBrowser.tabContainer;
       container.addEventListener("TabOpen", function(e) { hookBrowserGetter(e.target.linkedBrowser); }, true);
-      container.addEventListener("TabClose", function(e) { unhookBrowserGetter(e.target.linkedBrowser); }, false);
+      container.addEventListener("TabClose", function(e)
+      {
+        unhookBrowserGetter(e.target.linkedBrowser);
+        // Check dangling new window on tab close
+        UtilsPluginManager.checkDanglingNewWindow(e.target);
+      }, false);
     }
     catch (ex)
     {
@@ -238,7 +243,8 @@ var gFireIE = null;
           {
             browsers = [];
             let dropCount = dt.mozItemCount;
-            for (let i = 0; i < dropCount; ++i) {
+            for (let i = 0; i < dropCount; ++i)
+            {
               let flavor = this.getFirstValidFlavor(dt.mozTypesAt(i));
               if (!flavor) return;
               let data = dt.mozGetDataAt(flavor, i);
@@ -261,8 +267,8 @@ var gFireIE = null;
       // Show bookmark state (the star icon in URL bar) when using IE engine
       if (typeof(PlacesStarButton) != "undefined" && typeof(PlacesStarButton.updateState) == "function")
         HM.hookCodeHeadTail("PlacesStarButton.updateState",
-                          function() { gBrowser.mCurrentBrowser.FireIE_bUseRealURI = true; },
-                          function() { gBrowser.mCurrentBrowser.FireIE_bUseRealURI = false; });
+                            function() { gBrowser.mCurrentBrowser.FireIE_bUseRealURI = true; },
+                            function() { gBrowser.mCurrentBrowser.FireIE_bUseRealURI = false; });
 
       // Firefox 23 : PlacesStarButton has been changed to BookmarksMenuButton
       if (typeof(BookmarksMenuButton) != "undefined" && typeof(BookmarksMenuButton.updateStarState) == "function")
@@ -270,6 +276,13 @@ var gFireIE = null;
                             function() { gBrowser.mCurrentBrowser.FireIE_bUseRealURI = true; },
                             function() { gBrowser.mCurrentBrowser.FireIE_bUseRealURI = false; });
       
+      // Firefox 24 : BookmarksMenuButton is again changed into BookmarkingUI...
+      //  WTF... I mean, Welcome To Firefox!!
+      if (typeof(BookmarkingUI) != "undefined" && typeof(BookmarkingUI.updateStarState) == "function")
+        HM.hookCodeHeadTail("BookmarkingUI.updateStarState",
+                            function() { gBrowser.mCurrentBrowser.FireIE_bUseRealURI = true; },
+                            function() { gBrowser.mCurrentBrowser.FireIE_bUseRealURI = false; });
+      
       // Show number of bookmarks in the overlay editing panel when using IE engine
       HM.hookCodeHeadTail("StarUI._doShowEditBookmarkPanel",
                           function() { gBrowser.mCurrentBrowser.FireIE_bUseRealURI = true; },
@@ -511,7 +524,7 @@ var gFireIE = null;
         let pluginURL = pluginObject.URL;
         if (pluginURL)
         {
-          let url = this.FireIE_bUseRealURI ? pluginURL : (Utils.containerUrl + encodeURI(pluginURL));
+          let url = this.FireIE_bUseRealURI ? pluginURL : (Utils.containerUrl + encodeURI(pluginURL));     
           return RET.modifyValue(Utils.makeURI(url));
         }
       }
@@ -527,7 +540,6 @@ var gFireIE = null;
       if (entry.URI.spec != uri.spec)
       {
         entry.QueryInterface(Components.interfaces.nsISHEntry).setURI(uri);
-        if (this.parentNode.__SS_data) delete this.parentNode.__SS_data;
       }
     }
   };
diff --git a/extension/chrome/content/overlay.xul b/extension/chrome/content/overlay.xul
index e116f2c..7e227f1 100644
--- a/extension/chrome/content/overlay.xul
+++ b/extension/chrome/content/overlay.xul
@@ -13,10 +13,6 @@ xmlns:html="http://www.w3.org/1999/xhtml">
   <commandset id="mainCommandSet">
     <command id="cmd_fireieSwitch" oncommand="gFireIE.switchEngine();" />
   </commandset>
-  <keyset id="mainKeyset">
-    <key id="key_fireieSwitch" command="cmd_fireieSwitch" modifiers="alt"
-    key="C" />
-  </keyset>
   <!-- urlbar switch button -->
   <textbox id="urlbar">
     <toolbarbutton id="fireie-urlbar-switch" insertbefore="urlbar-go-button"
diff --git a/extension/chrome/content/pluginNotFound.js b/extension/chrome/content/pluginNotFound.js
index dd82153..ed0a1d9 100644
--- a/extension/chrome/content/pluginNotFound.js
+++ b/extension/chrome/content/pluginNotFound.js
@@ -17,18 +17,19 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 
 function init()
 {
-  generateLinkText(E("visitHomepage"));
-
-  let element = E("correctVersion");
-  let template = element.getAttribute("_textTemplate");
-  element.textContent = template.replace(/\[bit\]/, Utils.is64bit ? "64" : "32");
+  ["makeSure", "reinstall"].forEach(function(id)
+  {
+    generateLinkText(E(id));
+  });
+  doSizeToContent(window, document);
 }
 
 function generateLinkText(element)
 {
   let template = element.getAttribute("_textTemplate");
   let url = element.querySelector("label.text-link").getAttribute("_url");
-  template = template.replace(/\[host\]/, Utils.getHostname(url));
+  if (url)
+    template = template.replace(/\[host\]/, Utils.getHostname(url));
   
   let beforeLink, linkText, afterLink;
   if (/(.*)\[link\](.*)\[\/link\](.*)/.test(template))
@@ -48,8 +49,19 @@ function generateLinkText(element)
   element.appendChild(document.createTextNode(afterLink));
 }
 
+function closeDialog()
+{
+  document.documentElement.acceptDialog();
+}
+
 function visitHomepage(element)
 {
   Utils.loadInBrowser(element.getAttribute("_url"));
-  document.documentElement.acceptDialog();
+  closeDialog();
+}
+
+function openPluginManager()
+{
+  Utils.openAddonsMgr("addons://list/plugin");
+  closeDialog();
 }
diff --git a/extension/chrome/content/pluginNotFound.xul b/extension/chrome/content/pluginNotFound.xul
index 201d96f..5600235 100644
--- a/extension/chrome/content/pluginNotFound.xul
+++ b/extension/chrome/content/pluginNotFound.xul
@@ -1,6 +1,7 @@
 <?xml version="1.0"?>
 
 <?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
+<?xml-stylesheet href="chrome://fireie/skin/pluginNotFound.css" type="text/css"?>
 
 <!DOCTYPE dialog SYSTEM "chrome://fireie/locale/pluginNotFound.dtd">
 
@@ -14,13 +15,15 @@
 
   <script type="application/x-javascript;version=1.7" src="utils.js"/>
   <script type="application/x-javascript;version=1.7" src="pluginNotFound.js"/>
-
+  
   <vbox>
     <description>&pluginNotFound1;</description>
-    <description>&pluginNotFound2;</description>
-    <description id="correctVersion" _textTemplate="&correctVersion;"></description>
-    <description id="visitHomepage" _textTemplate="&visitHomepage;">
-      <label class="text-link" _url="&homepage;" onclick="visitHomepage(this);"/>
+    <description>&pluginNotFound3;</description>
+    <description id="makeSure" _textTemplate="&makeSure;">
+      <label class="text-link" onclick="if (event.button == 0) openPluginManager();"/>
+    </description>
+    <description id="reinstall" _textTemplate="&reinstall;">
+      <label class="text-link" _url="&homepage;" onclick="if (event.button == 0) visitHomepage(this);"/>
     </description>
   </vbox>
 </dialog>
diff --git a/extension/chrome/content/rules.xul b/extension/chrome/content/rules.xul
index dffe2be..3bd1587 100644
--- a/extension/chrome/content/rules.xul
+++ b/extension/chrome/content/rules.xul
@@ -138,7 +138,7 @@
       <!-- subscripted switching rules -->  
       <tabpanel id="subscriptionsTab" orient="vertical" flex="1">
         <hbox>
-          <checkbox id="subscriptionsAutoUpdate" label="&subscription.autoupdate;" accesskey="A" oncommand="Prefs.subscriptions_autoupdate=this.checked;" />
+          <checkbox id="subscriptionsAutoUpdate" label="&subscription.autoupdate.label;" accesskey="&subscription.autoupdate.accesskey;" oncommand="Prefs.subscriptions_autoupdate=this.checked;" />
           <spacer flex="1"/>
           <button id="selectSubscriptionButton" label="&addSubscription.label;" accesskey="&addSubscription.accesskey;" command="subscription-add-command"/>
         </hbox>
diff --git a/extension/chrome/content/utils.js b/extension/chrome/content/utils.js
index 6d69a10..e9f915c 100644
--- a/extension/chrome/content/utils.js
+++ b/extension/chrome/content/utils.js
@@ -29,4 +29,18 @@ Cu.import("resource://gre/modules/Services.jsm");
 function E(id)
 {
   return document.getElementById(id);
-}
\ No newline at end of file
+}
+
+/**
+ * for multi-line label sizing problem
+ */
+function doSizeToContent(window, document)
+{
+  window.sizeToContent();
+  let vboxes = document.querySelectorAll("prefpane > vbox");
+  Array.prototype.forEach.call(vboxes, function(vbox)
+  {
+    vbox.height = vbox.boxObject.height;
+  });
+  window.sizeToContent();
+}
diff --git a/extension/chrome/locale/en/about.dtd b/extension/chrome/locale/en/about.dtd
new file mode 100644
index 0000000..4ddb6a5
--- /dev/null
+++ b/extension/chrome/locale/en/about.dtd
@@ -0,0 +1,32 @@
+<!ENTITY about.longDesc.label     "About this Add-on:">
+<!ENTITY about.why.label          "Why was this Add-on created?">
+<!ENTITY about.whatsNext.label    "What's next for this Add-on?">
+<!ENTITY about.links.label        "Links:">
+
+<!--
+    To embed html tags in the description, use [tag][/tag] or [tag/];
+    To embed entities in the description, use [.entity], e.g. [.amp] stands for "&amp;"(&), and [.quot] stands for "&quot;"(");
+    To embed links, use [link href='url']link_text[/link].
+-->
+<!ENTITY about.longDesc           "[p]Fire-IE is another ietab-like extension. It embeds the IE engine to handle IE-only websites. You could change the browser engine from Firefox to IE by a simple click.[/p]
+                                   [p]Moreover, you can write auto-switch rules so that Fire-IE will automatically switch to IE engine when you visit certain sites. Like Adblock Plus, you can also subscribe to existing rule lists. We currently maintain an auto-switch rule list for Chinese sites.[/p]
+                                   [p]When you switch to the IE engine, cookies will be synchronized so that you do not need to relogin. Most of the shortcut keys of Firefox will be available under the IE engine as well. For example you could use [.quot]Ctrl + +[.quot] and [.quot]Ctrl + -[.quot] to zoom in and out, [.quot]Ctrl + F[.quot] to search inside the document and so on.[/p]
+                                   [p]It also supports mouse gestures for the IE engine with the FireGuestures or All-in-One Gestures extension installed.[/p]
+                                   [p]Adblock Plus is supported now. You will no longer be annoyed by ads in the IE engine.[/p]
+                                   [p]From 0.3.3 on, 32bit and 64bit versions are combined into a single package. We will no longer offer standalone 64bit xpi packages.[/p]">
+
+<!ENTITY about.why                "[p]Fire-IE is created mainly to address compatibility problems of Firefox in China, where there are many IE-only sites. The add-on will allow users to access these sites in Firefox.[/p]">
+
+<!ENTITY about.whatsNext          "[p]Intelligent switching feature.[/p]">
+
+<!ENTITY about.links              "[p]Project home: [link href='http://fireie.org/en'][/link][/p]
+                                   [p]FAQ: [link href='http://fireie.org/en/faq'][/link][br/]
+                                      Skins: [link href='http://fireie.org/en/skins'][/link][br/]
+                                      How to write switch rules: [link href='http://fireie.org/en/switch_rules'][/link]
+                                   [/p]
+                                   [p]Source code: [link href='https://github.com/yxl/Fire-IE'][/link][br/]
+                                      Give us feedback on issues, suggestions or translations:
+                                   [ul][li][link href='https://getsatisfaction.com/fireie'][/link] (English support forum)[/li]
+                                       [li][link href='https://github.com/yxl/Fire-IE/issues'][/link] (GitHub issues)[/li]
+                                   [/ul]
+                                   [/p]">
diff --git a/extension/chrome/locale/en/fireie.dtd b/extension/chrome/locale/en/fireie.dtd
index 316688b..596b941 100644
--- a/extension/chrome/locale/en/fireie.dtd
+++ b/extension/chrome/locale/en/fireie.dtd
@@ -34,7 +34,6 @@
 <!ENTITY fireie.options.ui.showTooltipText "Show engine status when hovering URL bar button">
 <!ENTITY fireie.options.ui.statusBarCaption "Floating Status Bar">
 <!ENTITY fireie.options.ui.showStatusText "Show IE engine's status in the floating status bar">
-<!ENTITY fireie.options.ui.buttonStylesURL "chrome://fireie/skin/url-button-styles.png">
 <!ENTITY fireie.options.ui.faviconCaption "Tab Icon">
 <!ENTITY fireie.options.ui.faviconSite "Use website's favicon">
 <!ENTITY fireie.options.ui.faviconIE "Use IE engine's icon">
diff --git a/extension/chrome/locale/en/global.properties b/extension/chrome/locale/en/global.properties
index daaeb4a..c429bc4 100644
--- a/extension/chrome/locale/en/global.properties
+++ b/extension/chrome/locale/en/global.properties
@@ -21,7 +21,7 @@ fireie.options.alert.restart=Firefox must be restarted for all changes to take e
 fireie.options.alert.modified=The preferences are modified. Save changes?
 fireie.security.notEntrypted=Your connection to this website is not encrypted
 fireie.security.partiallyEncrypted=Your connection to this site is only partially encrypted
-fireie.security.encrypted=Your connection to this website is encrypted\nEncryption strenth: 
+fireie.security.encrypted=Your connection to this website is encrypted\nEncryption strength: 
 fireie.security.encryption.bit=bit
 fireie.security.encryption.unknown=Unknown
 fireie.pbw.title=Warning: IE Engine Does Not Support Private Browsing
diff --git a/extension/chrome/locale/en/pluginNotFound.dtd b/extension/chrome/locale/en/pluginNotFound.dtd
index 52ca5b8..ca35201 100644
--- a/extension/chrome/locale/en/pluginNotFound.dtd
+++ b/extension/chrome/locale/en/pluginNotFound.dtd
@@ -4,3 +4,7 @@
 <!ENTITY correctVersion             "According to your configuration, you should use the [bit]-bit version.">
 <!ENTITY homepage                   "http://yxl.github.com/Fire-IE">
 <!ENTITY visitHomepage              "Please visit [link][host][/link] to download and install.">
+
+<!ENTITY pluginNotFound3            "You may have installed a wrong version of Fire IE; The plugin may have been removed or disabled in Add-ons Manager.">
+<!ENTITY makeSure                   "Make sure &quot;Fire IE DLL&quot; is enabled in the [link]Add-ons Manager[/link].">
+<!ENTITY reinstall                  "You can also try re-install Fire IE from [link][host][/link]">
diff --git a/extension/chrome/locale/en/rules.dtd b/extension/chrome/locale/en/rules.dtd
index db61d8f..f06b222 100644
--- a/extension/chrome/locale/en/rules.dtd
+++ b/extension/chrome/locale/en/rules.dtd
@@ -3,7 +3,8 @@
 <!ENTITY subscriptions.tab.label              "Rule subscriptions">
 <!ENTITY rules.tab.label                    "Custom rules">
 
-<!ENTITY subscription.autoupdate              "Update automatically">
+<!ENTITY subscription.autoupdate.label        "Update automatically">
+<!ENTITY subscription.autoupdate.accesskey    "a">
 <!ENTITY addSubscription.label                "Add rule subscription">
 <!ENTITY addSubscription.accesskey            "f">
 
@@ -11,7 +12,7 @@
 <!ENTITY addSubscriptionCancel.label          "Cancel">
 <!ENTITY addSubscriptionOther.label           "Add a different subscription">
 
-<!ENTITY noSubscriptions.text                 "You haven't added any rule subscriptions yet. Fire IE won't automatically switch browser engine and synchronize cookie without rules, please use &quot;Add rule subscription&quot; toadd some.">
+<!ENTITY noSubscriptions.text                 "You haven't added any rule subscriptions yet. Fire IE won't automatically switch browser engine and synchronize cookie without rules, please use &quot;Add rule subscription&quot; to add some.">
 <!ENTITY subscription.homepage.label          "Homepage">
 <!ENTITY subscription.external.label          "Updated by another extension">
 <!ENTITY subscription.source.label            "Rule list">
@@ -96,8 +97,8 @@
 
 <!ENTITY backup.error                         "There was an error writing rules to the file. Make sure that the file isn't write protected or in use by another application.">
 <!ENTITY restore.error                        "The file's data could not be processed, maybe this isn't a Fire IE backup file?">
-<!ENTITY restore.complete.warning             "All your rule preferences will be replaced by the contents of the selected file. Do you want to proceeed?">
-<!ENTITY restore.custom.warning               "All your custom rules will be replaced by the contents of the selected file. Do you want to proceeed?">
+<!ENTITY restore.complete.warning             "All your rule preferences will be replaced by the contents of the selected file. Do you want to proceed?">
+<!ENTITY restore.custom.warning               "All your custom rules will be replaced by the contents of the selected file. Do you want to proceed?">
 <!ENTITY restore.minVersion.warning           "Warning: the file has been created with a newer Fire IE version. You should update to the latest Fire IE version before restoring from this file.">
 
 <!ENTITY find.label                           "Find">
diff --git a/extension/chrome/locale/en/url-button-styles.png b/extension/chrome/locale/en/url-button-styles.png
new file mode 100644
index 0000000..56a8075
Binary files /dev/null and b/extension/chrome/locale/en/url-button-styles.png differ
diff --git a/extension/chrome/locale/pl/about.dtd b/extension/chrome/locale/pl/about.dtd
new file mode 100644
index 0000000..a538a3d
--- /dev/null
+++ b/extension/chrome/locale/pl/about.dtd
@@ -0,0 +1,27 @@
+<!ENTITY about.longDesc.label     "Więcej o tym dodatku:">
+<!ENTITY about.why.label          "Why was this Add-on created?">
+<!ENTITY about.whatsNext.label    "What's next for this Add-on?">
+<!ENTITY about.links.label        "Links:">
+
+<!ENTITY about.longDesc           "[p]Fire-IE to jeszcze jeden dodatek typu IE Tab. Dostarcza silnik IE do stron obsługujących tylko tą przeglądarkę. W nim możesz zmieniać silnik z Firefoksa na IE za pomocą prostego kliknięcia.[/p]
+                                   [p]Co więcej można napisać reguły do automatycznej zmiany silnika takie, że Fire-IE przestawi silnik na IE przy otwieraniu wybranych stron. Podobnie jak w Adblock Plus możesz też subskrybować istniejące zestawy reguł. My aktualnie zarządzamy zestawem reguł dla chińskich stron.[/p]
+                                   [p]Kiedy przestawisz silnik na IE, ciasteczka pozostaną zsynchronizowane, dzięki temu nie będziesz musiał się logować od nowa. Większość skrótów klawiszowych Firefoksa będzie dostępna też pod silnikiem IE. Przykładowo do powiększania lub zmniejszania stron możesz używać [.quot]Ctrl + +[.quot] i [.quot]Ctrl + -[.quot], do szukania [.quot]Ctrl + F[.quot], itd.[/p]
+                                   [p]Ten dodatek wspiera także gesty myszy dla silnika IE z dodatkami FireGestures lub All-in-One Gestures.[/p]
+                                   [p]Teraz jest też wspierany Adblock Plus. Nie będziesz już więcej irytowany reklamami w silniku IE.[/p]
+                                   [p]Od wersji 0.3.3 wersje 32 i 64-bitowe są zintegrowane w jednej paczce. Nie będziemy już więcej udostępniać oddzielnej wersji 64-bitowej.[/p]">
+
+<!ENTITY about.why                "[p]Fire-IE został stworzony głównie do naprawienia problemów niekompatybilności stron z Firefoksem w Chinach. Jest wiele takich stron dostępnych tylko pod IE na kontynencie Chin i Tajwanu. Fire-IE pozwoli użytkownikom na dostęp do tych stron z Firefoksa.[/p]">
+
+<!ENTITY about.whatsNext          "[p]Intelligent switching feature.[/p]">
+
+<!ENTITY about.links              "[p]Project home: [link href='http://fireie.org/en'][/link][/p]
+                                   [p]FAQ: [link href='http://fireie.org/en/faq'][/link][br/]
+                                      Skins: [link href='http://fireie.org/en/skins'][/link][br/]
+                                      How to write switch rules: [link href='http://fireie.org/en/switch_rules'][/link]
+                                   [/p]
+                                   [p]Source code: [link href='https://github.com/yxl/Fire-IE'][/link][br/]
+                                      Give us feedback on issues, suggestions or translations:
+                                   [ul][li][link href='https://getsatisfaction.com/fireie'][/link] (English support forum)[/li]
+                                       [li][link href='https://github.com/yxl/Fire-IE/issues'][/link] (GitHub issues)[/li]
+                                   [/ul]
+                                   [/p]">
diff --git a/extension/chrome/locale/pl/fireie.dtd b/extension/chrome/locale/pl/fireie.dtd
new file mode 100644
index 0000000..046b72a
--- /dev/null
+++ b/extension/chrome/locale/pl/fireie.dtd
@@ -0,0 +1,78 @@
+<!ENTITY fireie.switchButton.label "Fire IE">
+
+<!ENTITY fireie.urlbar.switch.tooltip1 "Zmień silnik renderujący">
+<!ENTITY fireie.urlbar.switch.tooltip1.disabled "Nie można zmienić na tej stronie">
+<!ENTITY fireie.urlbar.switch.tooltip3 "Prawy: Pokaż ustawienia Fire IE">
+<!ENTITY urlbar.switchRules.label "Reguły zmieniające silnik">
+<!ENTITY internetProperties.lable "Opcje internetowe IE">
+<!ENTITY fireie.autoswitch.disable "Nie zmieniaj automatycznie nigdzie">
+<!ENTITY openInIE.label "Otwórz tę stronę w IE">
+<!ENTITY skin.label "Skórki">
+<!ENTITY default.lable "Domyślna">
+<!ENTITY skin.more.lable "Więcej...">
+
+<!ENTITY fireie.options.title "Fire IE - Opcje">
+
+<!ENTITY fireie.options.general.tab "Ogólne">
+<!ENTITY fireie.options.general.pane "Ogólne">
+<!ENTITY fireie.options.switch.caption "Kiedy zmieniać silnik renderujący:">
+<!ENTITY fireie.options.switch.handleurl "Zawsze używaj tego samego silnika przy otwieraniu linku">
+<!ENTITY fireie.options.switch.disableAutoSwitch "Wyłącz automatyczne zmiany silnika">
+<!ENTITY fireie.options.shorcut.caption "Skrót klawiszowy">
+<!ENTITY fireie.options.shorcut.enable "Włącz">
+<!ENTITY fireie.options.private.caption "Przeglądanie prywatne">
+<!ENTITY fireie.options.private.privatebrowsingwarning "Pokazuj ostrzeżenie przy przeglądaniu prywatnym">
+<!ENTITY fireie.options.private.descr "Karty w trybie IE nie mogą być przeglądane prywatnie. Możesz wybrać, czy chcesz pokazywać ostrzeżenie w takiej sytuacji.">
+<!ENTITY fireie.options.ui.tab "Interfejs">
+<!ENTITY fireie.options.ui.pane "Interfejs">
+<!ENTITY fireie.options.ui.urlBarButtonCaption "Przycisk paska adresu">
+<!ENTITY fireie.options.ui.iconDisplayLabel "Sposób wyświetlania:">
+<!ENTITY fireie.options.ui.iconHidden "Ukryty">
+<!ENTITY fireie.options.ui.iconOnly "Pokazuj tylko ikonę">
+<!ENTITY fireie.options.ui.iconAndText "Pokazuj ikonę i etykietę">
+<!ENTITY fireie.options.ui.tooltipLabel "Dymek:">
+<!ENTITY fireie.options.ui.showTooltipText "Pokazuj status silnika przy wskazywaniu paska adresu">
+<!ENTITY fireie.options.ui.statusBarCaption "Pasek dodatków">
+<!ENTITY fireie.options.ui.showStatusText "Pokaż status silnika IE na pasku dodatków (stanu)">
+<!ENTITY fireie.options.ui.faviconCaption "Ikona karty">
+<!ENTITY fireie.options.ui.faviconSite "Używaj favikony strony">
+<!ENTITY fireie.options.ui.faviconIE "Używaj ikony silnika IE">
+<!ENTITY fireie.options.ui.customLabelLabel "Dostosuj etykiety:">
+<!ENTITY fireie.options.integration.tab "Integracja">
+<!ENTITY fireie.options.integration.pane "Integracja">
+<!ENTITY fireie.options.integration.mgCaption "Wsparcie gestów myszy">
+<!ENTITY fireie.options.integration.mgDescr "Rozszerzenia i skrypty do obsługi gestów są wykrywane automatycznie. Jeżeli Twój dodatek lub skrypt nie jest wykrywany, możesz spróbować tej opcji.">
+<!ENTITY fireie.options.integration.forceMGSupport "Wymuś aktywację wsparcia gestów myszy w kartach trybu IE">
+<!ENTITY fireie.options.integration.alreadyEnabledMGSupport "Wsparcie gestów myszy jest aktywne.">
+<!ENTITY fireie.options.integration.abpCaption "Wsparcie Adblock Plus">
+<!ENTITY fireie.options.integration.abpDescr "Używaj filtrów Adblock Plus, żeby blokować reklamy w silniku IE.">
+<!ENTITY fireie.options.integration.abpSupportEnabled "Włącz wsparcie dla Adblock Plus">
+<!ENTITY fireie.options.integration.abpStatusLabel "Aktualny status: ">
+<!ENTITY fireie.options.integration.abpStatusNotDetected "Nie wykryto Adblock Plus">
+<!ENTITY fireie.options.integration.abpStatusEnabled "Włączono">
+<!ENTITY fireie.options.integration.abpStatusDisabled "Wyłączono">
+<!ENTITY fireie.options.integration.abpStatusLoading "Ładowanie filtrów">
+<!ENTITY fireie.options.integration.abpStatusLoadFailed "Nie powiodło się wczytywanie filtrów">
+<!ENTITY fireie.options.integration.otherOptions "Inne ustawienia">
+<!ENTITY fireie.options.integration.cookieSyncEnabled "Synchronizuj ciasteczka pomiędzy silnikami IE i Firefox">
+
+<!ENTITY fireie.options.ieoptions.tab  "Silnik IE">
+<!ENTITY fireie.options.ieoptions.pane "Silnik IE">
+<!ENTITY fireie.options.iecompat.group "Tryb kompatybilności z IE">
+<!ENTITY fireie.options.iecompat.ie7   "IE7 - Tryb standardowy">
+<!ENTITY fireie.options.iecompat.ie8   "IE8 - Tryb standardowy">
+<!ENTITY fireie.options.iecompat.ie8f  "IE8 - Wymuszony tryb standardowy">
+<!ENTITY fireie.options.iecompat.ie9   "IE9 - Tryb standardowy">
+<!ENTITY fireie.options.iecompat.ie9f  "IE9 - Wymuszony tryb standardowy">
+<!ENTITY fireie.options.iecompat.ie10  "IE10 - Tryb standardowy">
+<!ENTITY fireie.options.iecompat.ie10f "IE10 - Wymuszony tryb standardowy">
+<!ENTITY fireie.options.iecompat.notSupported "Twoja wersja IE nie nie wspiera trybu kompatybilności lub zaawansowanych możliwości.">
+<!ENTITY fireie.options.iefeat.group   "Zaawansowane możliwości">
+<!ENTITY fireie.options.iefeat.gpuRendering "Włącz renderowanie wspomagane sprzętowo">
+
+<!ENTITY fireie.options.apply "Zastosuj">
+<!ENTITY fireie.options.manager "Menedżer ustawień">
+<!ENTITY fireie.options.default "Przywróć domyślne">
+<!ENTITY fireie.options.import "Importuj plik z ustawieniami">
+<!ENTITY fireie.options.export "Eksportuj plik z ustawieniami">
+<!ENTITY fireie.options.restart.descr "Uruchom ponownie Firefox, aby ustawienia zaczęły działać.">
diff --git a/extension/chrome/locale/pl/firstRun.dtd b/extension/chrome/locale/pl/firstRun.dtd
new file mode 100644
index 0000000..917edb7
--- /dev/null
+++ b/extension/chrome/locale/pl/firstRun.dtd
@@ -0,0 +1,7 @@
+<!ENTITY dialog.title               "Instalacja Fire IE zakończona">
+<!ENTITY confirmation               "Dziękujemy za zainstalowanie Fire IE. Od tej chwili silnik IE jest dostępny. Baw się dobrze!">
+<!ENTITY advancedSection            "Ustawienia zaawansowane">
+<!ENTITY listSelection1             "Ustawiono następującą listę reguł do automatycznego zmieniania silnika:">
+<!ENTITY noList                     "Brak list reguł">
+<!ENTITY visitHomepage.label        "Odwiedź stronę z listami reguł (po angielsku)">
+<!ENTITY listSelection2             "Można zawsze zmienić ten wybór w You can change this selection at any time in the [link]ustawieniach reguł[/link].">
diff --git a/extension/chrome/locale/pl/global.properties b/extension/chrome/locale/pl/global.properties
new file mode 100644
index 0000000..5b9e513
--- /dev/null
+++ b/extension/chrome/locale/pl/global.properties
@@ -0,0 +1,44 @@
+fireie.urlbar.switch.label.fx=Szybko
+fireie.urlbar.switch.label.ie=Kompatybilnie
+fireie.urlbar.switch.tooltip2.fx=Bieżący silnik: Firefox
+fireie.urlbar.switch.tooltip2.ie=Bieżący silnik: IE
+fireie.erc.enableOnPage=Włącz automatyczną zmianę silnika dla tej strony
+fireie.erc.enableOnSite=Włącz automatyczną zmianę silnika dla --
+fireie.erc.enableOnUrl=Włącz automatyczną zmianę silnika dla --
+fireie.erc.disableOnPage=Wyłącz automatyczną zmianę silnika dla tej strony
+fireie.erc.disableOnSite=Wyłącz automatyczną zmianę silnika dla --
+fireie.erc.disableOnUrl=Wyłącz automatyczną zmianę silnika dla --
+fireie.erc.uaRules=Opcje User Agenta
+fireie.erc.uaOnSite=Używaj IE UA na tej stronie
+fireie.erc.uaESROnSite=Używaj ESR UA na tej stronie
+fireie.erc.uaOnPage=Używaj IE UA na --
+fireie.erc.uaESROnPage=Używaj ESR UA na --
+fireie.erc.uaDefaultOnSite=Używaj domyślnego UA na tej stronie
+fireie.erc.uaDefaultOnPage=Używaj domyślnego UA na --
+fireie.options.import.error=Nie udało się zaimportować.
+fireie.options.alert.title=Fire IE - Opcje
+fireie.options.alert.restart=Należy zrestartować Firefoksa, żeby wszyskie zmiany zaczęły działać.
+fireie.options.alert.modified=Ustawienia zostały zmienione. Zapisać zmiany?
+fireie.security.notEntrypted=Twoje połączenie na tej stronie nie jest szyfrowane
+fireie.security.partiallyEncrypted=Twoje połączenie na tej stronie jest tylko częściowo szyfrowane
+fireie.security.encrypted=Twoje połączenie na tej stronie jest szyfrowane\nSiła szyfrowania: 
+fireie.security.encryption.bit=bitów
+fireie.security.encryption.unknown=Nieznana
+fireie.pbw.title=Ostrzeżenie: Silnik IE nie wspiera przeglądania prywatnego
+Synchronizer.invalidUrl=Nieprawidłowy adres
+Synchronizer.connectionError=Błąd połączenia
+Synchronizer.invalidData=Nieprawidłowa zawartość reguł
+Synchronizer.checksumMismatch=Niezgodność sum kontrolnych
+newGroup.title=Nowy zestaw reguł
+switchGroup.title=Switch rule group
+exceptionalGroup.title=Exceptional rule group
+customGroup.title=Własny zestaw reguł
+uaExceptionalGroup.title=Exceptional user-agent rule group
+uaGroup.title=Zestaw reguł User Agenta
+remove_subscription_warning=Czy na pewno chcesz usunąć ten zestaw?
+rule_regexp_tooltip=Ta reguła jest albo wyrażeniem regularnym albo zbyt krótka, żeby mogła być zoptymalizowana. Zbyt wiele takich reguł może spowolnić przeglądanie.
+default_dialog_title=Fire IE
+
+
+
+
diff --git a/extension/chrome/locale/pl/overlaySanitize.dtd b/extension/chrome/locale/pl/overlaySanitize.dtd
new file mode 100644
index 0000000..13e1432
--- /dev/null
+++ b/extension/chrome/locale/pl/overlaySanitize.dtd
@@ -0,0 +1,2 @@
+<!ENTITY itemClearFireieCache.label "Pliki tymczasowe Fire IE">
+<!ENTITY itemClearFireieCookies.label "Ciasteczka Fire IE">
diff --git a/extension/chrome/locale/pl/overlaySanitizePref.dtd b/extension/chrome/locale/pl/overlaySanitizePref.dtd
new file mode 100644
index 0000000..c8478e8
--- /dev/null
+++ b/extension/chrome/locale/pl/overlaySanitizePref.dtd
@@ -0,0 +1,3 @@
+<!ENTITY fireieSection.label "Fire IE">
+<!ENTITY itemFireieCache.label "Pliki tymczasowe">
+<!ENTITY itemFireieCookies.label "Ciasteczka">
diff --git a/extension/chrome/locale/pl/pluginNotFound.dtd b/extension/chrome/locale/pl/pluginNotFound.dtd
new file mode 100644
index 0000000..e114b53
--- /dev/null
+++ b/extension/chrome/locale/pl/pluginNotFound.dtd
@@ -0,0 +1,10 @@
+<!ENTITY dialog.title               "Nie wczytano wtyczki Fire IE">
+<!ENTITY pluginNotFound1            "Fire IE wykrył, że plik wtyczki &quot;Fire IE DLL&quot; nie został poprawnie załadowany.">
+<!ENTITY pluginNotFound2            "Być może masz zainstalowaną nieodpowiednią wersję Fire IE.">
+<!ENTITY correctVersion             "Zgodnie z Twoją przeglądarką powinieneś używać wersji [bit]-bitowej.">
+<!ENTITY homepage                   "http://yxl.github.com/Fire-IE">
+<!ENTITY visitHomepage              "Odwiedź  [link][host][/link], żeby pobrać i zainstalować.">
+
+<!ENTITY pluginNotFound3            "Być może masz zainstalowaną nieodpowiednią wersję Fire IE; Wtyczka mogła zostać usunięta w menedżerze dodatków.">
+<!ENTITY makeSure                   "Upewnij się, czy wtyczka &quot;Fire IE DLL&quot; jest włączona w [link]menedżerze dodatków[/link].">
+<!ENTITY reinstall                  "Możesz też spróbować zreinstalować Fire IE z [link][host][/link]">
diff --git a/extension/chrome/locale/pl/private.dtd b/extension/chrome/locale/pl/private.dtd
new file mode 100644
index 0000000..0021c62
--- /dev/null
+++ b/extension/chrome/locale/pl/private.dtd
@@ -0,0 +1,5 @@
+<!ENTITY privatebrowsingwarning.title "Silnik IE nie wspiera przeglądania prywatnego">
+<!ENTITY privatebrowsingwarning.intro1 "Masz aktywowane przeglądanie prywatne w &brandShortName;, ale nie jest ono wspierane przez silnik IE.">
+<!ENTITY privatebrowsingwarning.intro2 "Jeśli zmienisz silnik na IE, Twoja historia przeglądania, wyszukiwania, pobierania, formularzy, ciasteczka i tymczasowe pliki internetowe będą zapisane w dzienniku historii IE.">
+<!ENTITY privatewarning.whatShouldIDo.content "jeśli nie chcesz, żeby Twoje prywatne dane były rejestrowane, powróć do silnika &brandShortName;.">
+<!ENTITY privatewarning.expert.content "Jeśli mimo to dalej chcesz zmienić silnik na IE, kliknij &quot;Kontynuuj&quot;. Zauważ, że pozostałe karty nie korzystające z silnika IE, będą dalej przeglądane prywatnie">
diff --git a/extension/chrome/locale/pl/rules.dtd b/extension/chrome/locale/pl/rules.dtd
new file mode 100644
index 0000000..07306e2
--- /dev/null
+++ b/extension/chrome/locale/pl/rules.dtd
@@ -0,0 +1,107 @@
+<!ENTITY dialog.title                         "Fire-IE - Ustawienia reguł">
+
+<!ENTITY subscriptions.tab.label              "Subskrypcje reguł">
+<!ENTITY rules.tab.label                    "Własne reguły">
+
+<!ENTITY subscription.autoupdate.label        "Aktualizuj automatycznie">
+<!ENTITY subscription.autoupdate.accesskey    "a">
+<!ENTITY addSubscription.label                "Dodaj subskrypcję reguł">
+<!ENTITY addSubscription.accesskey            "f">
+
+<!ENTITY addSubscriptionAdd.label             "Dodaj">
+<!ENTITY addSubscriptionCancel.label          "Anuluj">
+<!ENTITY addSubscriptionOther.label           "Wybierz inną subskrypcję">
+
+<!ENTITY noSubscriptions.text                 "Jeszcze nie dodano żadnego zestawu reguł. Fire IE nie może zmieniać silnika przeglądarki i synchronizować ciasteczek bez reguł. Naciśnij przycisk „Dodaj subskrypcję reguł”, by dodać jakąś regułę.">
+<!ENTITY subscription.homepage.label          "Strona domowa">
+<!ENTITY subscription.external.label          "Updated by another extension">
+<!ENTITY subscription.source.label            "Zestaw reguł">
+<!ENTITY subscription.enabled.label           "Włączony">
+<!ENTITY subscription.lastDownload.label      "Ostatnio pobierany:">
+<!ENTITY subscription.lastDownload.inProgress "Pobieranie…">
+<!ENTITY subscription.lastDownload.unknown    "nieznane">
+<!ENTITY subscription.lastDownload.invalidURL "Nie powiodło się – nieprawidłowy adres">
+<!ENTITY subscription.lastDownload.connectionError "Nie powiodło się – błąd pobierania">
+<!ENTITY subscription.lastDownload.invalidData "Nie powiodło się – nieprawidłowy zestaw reguł">
+<!ENTITY subscription.lastDownload.checksumMismatch "Nie powiodło się – niepoprawna suma kontrolna">
+<!ENTITY subscription.lastDownload.success    "Sukces">
+<!ENTITY subscription.minVersion.warning      "Ten zestaw reguł działa z najnowszą wersją Fire IE. Zaktualizuj Fire IE.">
+<!ENTITY subscription.disabledRules.warning "Niektóre filtry w tym zestawie są wyłączone.">
+<!ENTITY subscription.disabledRules.enable  "Włącz zdezaktywowane reguły">
+
+<!ENTITY subscription.actions.label           "Działania">
+<!ENTITY subscription.update.label            "Aktualizuj reguły">
+<!ENTITY subscription.editTitle.label         "Edytuj tytuł">
+<!ENTITY subscription.delete.label            "Usuń">
+<!ENTITY subscription.showHideRules.label   "Pokaż/Ukryj szczegóły">
+<!ENTITY subscription.moveUp.label            "Przesuń wyżej">
+<!ENTITY subscription.moveDown.label          "Przesuń niżej">
+
+<!ENTITY viewList.label                       "Zobacz listę">
+
+<!ENTITY addGroup.label                       "Dodaj zestaw reguł">
+<!ENTITY addGroup.accesskey                   "g">
+
+<!ENTITY noRules.text                       "Nie dodałeś jeszcze żadnych własnych reguł.">
+
+<!ENTITY addRule.label                      "Dodaj regułę">
+<!ENTITY addRule.accesskey                  "d">
+
+<!ENTITY rule.actions.label                 "Działania reguły">
+<!ENTITY rule.edit.label                    "Edytuj">
+<!ENTITY rule.cut.label                     "Wytnij">
+<!ENTITY rule.copy.label                    "Kopiuj">
+<!ENTITY rule.paste.label                   "Wklej">
+<!ENTITY rule.delete.label                  "Usuń">
+<!ENTITY rule.selectAll.label               "Zaznacz wszystko">
+<!ENTITY rule.resetHitCounts.label          "Resetuj statystyki użyćReset hit statistics">
+<!ENTITY rule.moveUp.label                  "Przesuń wyżej">
+<!ENTITY rule.moveDown.label                "Przesuń niżej">
+<!ENTITY viewMenu.label                       "Widok">
+
+<!ENTITY rule.column                        "Reguła zmiany silnika">
+<!ENTITY rule.accesskey                     "F">
+<!ENTITY slow.column                          "Powolne reguły">
+<!ENTITY slow.accesskey                       "w">
+<!ENTITY enabled.column                       "Aktywna">
+<!ENTITY enabled.accesskey                    "n">
+<!ENTITY hitcount.column                      "Użycia">
+<!ENTITY hitcount.accesskey                   "H">
+<!ENTITY lasthit.column                       "Ostatnie użycie">
+<!ENTITY lasthit.accesskey                    "L">
+
+<!ENTITY sort.label                           "Sortuj wg">
+<!ENTITY sort.accesskey                       "S">
+<!ENTITY sort.none.label                      "Nieposortowane">
+<!ENTITY sort.none.accesskey                  "U">
+<!ENTITY sort.ascending.label                 "w kolejności A > Z">
+<!ENTITY sort.ascending.accesskey             "A">
+<!ENTITY sort.descending.label                "w kolejności Z > A">
+<!ENTITY sort.descending.accesskey            "Z">
+
+<!ENTITY noGroupSelected.text                 "Aby reguły mogły być wyświetlane, należy najpierw wybrać grupę.">
+<!ENTITY noRulesInGroup.text                "Wybrany zestaw jest pusty">
+
+<!ENTITY rules.remove.warning               "Czy jesteś pewien, że chcesz usunąć wszystkie reguły">
+
+<!ENTITY backupButton.label                   "Tworzenie i odtwarzanie kopii">
+<!ENTITY backupButton.accesskey               "B">
+
+<!ENTITY backup.label                         "Utwórz nową kopię">
+<!-- Note: the placeholder ?1? will be replaced by date/time of the automatic backup -->
+<!ENTITY restore.default.label                "Odtwórz kopię z dnia ?1?">
+<!ENTITY restore.own.label                    "Odtwórz własną kopię">
+
+<!ENTITY backup.complete.title                "Wszystkie reguły i zestawy">
+<!ENTITY backup.custom.title                  "Tylko własne reguły">
+
+<!ENTITY backup.error                         "W trakcie zapisu reguł wystąpił błąd. Sprawdź, czy czasami plik nie ma zabezpieczenia przed zapisem lub nie jest używany przez inną aplikację.">
+<!ENTITY restore.error                        "Nie można przetworzyć danych filtra. Może to nie jest plik kopii zapasowej Fire IE?">
+<!ENTITY restore.complete.warning             "Wszystkie ustawienia reguł zostaną zastąpione zawartością wybranego pliku. Czy chcesz kontynuować?">
+<!ENTITY restore.custom.warning               "Wszystkie własne reguły zostaną zastąpione zawartością wybranego pliku. Czy chcesz kontynuować?">
+<!ENTITY restore.minVersion.warning           "Ostrzeżenie! Plik został utworzony za pomocą najnowszej wersji Fire IE. Przed odtworzeniem zawartości tego pliku, należy zainstalować najnowszą wersję Fire IE.">
+
+<!ENTITY find.label                           "Znajdź">
+<!ENTITY find.accesskey                       "n">
+
+<!ENTITY close.label                          "Zamknij">
diff --git a/extension/chrome/locale/pl/subscriptionSelection.dtd b/extension/chrome/locale/pl/subscriptionSelection.dtd
new file mode 100644
index 0000000..9235f66
--- /dev/null
+++ b/extension/chrome/locale/pl/subscriptionSelection.dtd
@@ -0,0 +1,25 @@
+<!ENTITY dialog.title               "Subskrypcja reguł">
+
+<!ENTITY subscriptionSelector.label "Proszę wybrać subskrypcję reguł z listy:">
+
+<!ENTITY viewList.label             "Zobacz reguły">
+<!ENTITY visitHomepage.label        "Odwiedź stronę domową">
+
+<!ENTITY addSubscription.label      "Dodaj subskrypcję">
+
+<!ENTITY list.download.failed       "Nie udało się uzyskać listy dostępnych subskrypcji.">
+<!ENTITY list.download.retry        "Ponów próbę">
+<!ENTITY list.download.website      "View website">
+
+<!ENTITY fromWeb.description        "Potwierdź, że chcesz dodać tej subskrypcji reguł. Możesz zmienić tytuł subskrypcji lub lokalizację przed dodaniem jej">
+
+<!ENTITY title.label                "Tytuł subskrypcji:">
+<!ENTITY title.accesskey            "t">
+<!ENTITY location.label             "Lokalizacja listy reguł:">
+<!ENTITY location.accesskey         "l">
+
+<!-- Note: the placeholder (?1?) will be replaced by the name of the rule subscription required -->
+<!ENTITY supplementMessage          "Ta subskrypcja reguł musi byc używana z zestawem „?1?”, który nie jest jeszcze subskrybowany.">
+<!-- Note: the placeholder (?1?) will be replaced by the name of the rule subscription required -->
+<!ENTITY addMain.label              "Dodaj także subskypcję „?1?”">
+<!ENTITY addMain.accesskey          "s">
diff --git a/extension/chrome/locale/pl/url-button-styles.png b/extension/chrome/locale/pl/url-button-styles.png
new file mode 100644
index 0000000..5f15117
Binary files /dev/null and b/extension/chrome/locale/pl/url-button-styles.png differ
diff --git a/extension/chrome/locale/ru-RU/about.dtd b/extension/chrome/locale/ru-RU/about.dtd
new file mode 100644
index 0000000..24ed4a2
--- /dev/null
+++ b/extension/chrome/locale/ru-RU/about.dtd
@@ -0,0 +1,27 @@
+<!ENTITY about.longDesc.label     "About this Add-on:">
+<!ENTITY about.why.label          "Why was this Add-on created?">
+<!ENTITY about.whatsNext.label    "What's next for this Add-on?">
+<!ENTITY about.links.label        "Links:">
+
+<!ENTITY about.longDesc           "[p]Fire-IE is another ietab-like extension. It embeds the IE engine to handle IE-only websites. You could change the browser engine from Firefox to IE by a simple click.[/p]
+                                   [p]Moreover, you can write auto-switch rules so that Fire-IE will automatically switch to IE engine when you visit certain sites. Like Adblock Plus, you can also subscribe to existing rule lists. We currently maintain an auto-switch rule list for Chinese sites.[/p]
+                                   [p]When you switch to the IE engine, cookies will be synchronized so that you do not need to relogin. Most of the shortcut keys of Firefox will be available under the IE engine as well. For example you could use [.quot]Ctrl + +[.quot] and [.quot]Ctrl + -[.quot] to zoom in and out, [.quot]Ctrl + F[.quot] to search inside the document and so on.[/p]
+                                   [p]It also supports mouse gestures for the IE engine with the FireGuestures or All-in-One Gestures extension installed.[/p]
+                                   [p]Adblock Plus is supported now. You will no longer be annoyed by ads in the IE engine.[/p]
+                                   [p]From 0.3.3 on, 32bit [.amp] 64bit versions are combined into a single package. We will no longer offer standalone 64bit xpi packages.[/p]">
+
+<!ENTITY about.why                "[p]Fire-IE is created mainly to address compatibility problems of Firefox in China, where there are many IE-only sites. The add-on will allow users to access these sites in Firefox.[/p]">
+
+<!ENTITY about.whatsNext          "[p]Intelligent switching feature.[/p]">
+
+<!ENTITY about.links              "[p]Project home: [link href='http://fireie.org/en'][/link][/p]
+                                   [p]FAQ: [link href='http://fireie.org/en/faq'][/link][br/]
+                                      Skins: [link href='http://fireie.org/en/skins'][/link][br/]
+                                      How to write switch rules: [link href='http://fireie.org/en/switch_rules'][/link]
+                                   [/p]
+                                   [p]Source code: [link href='https://github.com/yxl/Fire-IE'][/link][br/]
+                                      Give us feedback on issues, suggestions or translations:
+                                   [ul][li][link href='https://getsatisfaction.com/fireie'][/link] (English support forum)[/li]
+                                       [li][link href='https://github.com/yxl/Fire-IE/issues'][/link] (GitHub issues)[/li]
+                                   [/ul]
+                                   [/p]">
diff --git a/extension/chrome/locale/ru-RU/fireie.dtd b/extension/chrome/locale/ru-RU/fireie.dtd
index 4da6028..2c7385b 100644
--- a/extension/chrome/locale/ru-RU/fireie.dtd
+++ b/extension/chrome/locale/ru-RU/fireie.dtd
@@ -34,7 +34,6 @@
 <!ENTITY fireie.options.ui.showTooltipText "Показывать статус движка при наведении курсора на кнопку">
 <!ENTITY fireie.options.ui.statusBarCaption "Всплывающая строка статуса">
 <!ENTITY fireie.options.ui.showStatusText "Показывать статус во всплывающей строке статуса при активном IE движке">
-<!ENTITY fireie.options.ui.buttonStylesURL "chrome://fireie/skin/url-button-styles.png">
 <!ENTITY fireie.options.ui.faviconCaption "Tab Icon">
 <!ENTITY fireie.options.ui.faviconSite "Use website's favicon">
 <!ENTITY fireie.options.ui.faviconIE "Use IE engine's icon">
diff --git a/extension/chrome/locale/ru-RU/pluginNotFound.dtd b/extension/chrome/locale/ru-RU/pluginNotFound.dtd
index 7b86c02..bce656e 100644
--- a/extension/chrome/locale/ru-RU/pluginNotFound.dtd
+++ b/extension/chrome/locale/ru-RU/pluginNotFound.dtd
@@ -4,3 +4,7 @@
 <!ENTITY correctVersion             "Согласно вашей конфигурации, вы должны использовать [bit]-bit версию.">
 <!ENTITY homepage                   "http://yxl.github.com/Fire-IE">
 <!ENTITY visitHomepage              "Для скачивания и установки, пожалуйста, посетите [link][host][/link].">
+
+<!ENTITY pluginNotFound3            "You may have installed a wrong version of Fire IE; The plugin may have been removed or disabled in Add-ons Manager.">
+<!ENTITY makeSure                   "Make sure &quot;Fire IE DLL&quot; is enabled in the [link]Add-ons Manager[/link].">
+<!ENTITY reinstall                  "You can also try re-install Fire IE from [link][host][/link]">
diff --git a/extension/chrome/locale/ru-RU/rules.dtd b/extension/chrome/locale/ru-RU/rules.dtd
index e869962..91cc037 100644
--- a/extension/chrome/locale/ru-RU/rules.dtd
+++ b/extension/chrome/locale/ru-RU/rules.dtd
@@ -3,7 +3,8 @@
 <!ENTITY subscriptions.tab.label              "Подписки на правила">
 <!ENTITY rules.tab.label                    "Правила пользователя">
 
-<!ENTITY subscription.autoupdate              "Обновлять автоматически">
+<!ENTITY subscription.autoupdate.label        "Обновлять автоматически">
+<!ENTITY subscription.autoupdate.accesskey    "a">
 <!ENTITY addSubscription.label                "Побавить подписку">
 <!ENTITY addSubscription.accesskey            "f">
 
diff --git a/extension/chrome/locale/ru-RU/url-button-styles.png b/extension/chrome/locale/ru-RU/url-button-styles.png
new file mode 100644
index 0000000..56a8075
Binary files /dev/null and b/extension/chrome/locale/ru-RU/url-button-styles.png differ
diff --git a/extension/chrome/locale/zh-CN/about.dtd b/extension/chrome/locale/zh-CN/about.dtd
new file mode 100644
index 0000000..23ad71a
--- /dev/null
+++ b/extension/chrome/locale/zh-CN/about.dtd
@@ -0,0 +1,27 @@
+<!ENTITY about.longDesc.label     "关于此附加组件：">
+<!ENTITY about.why.label          "开发此附加组件的缘由：">
+<!ENTITY about.whatsNext.label    "此附加组件的下一步计划：">
+<!ENTITY about.links.label        "链接：">
+
+<!ENTITY about.longDesc           "[p]解雇IE(Fire IE)是一个火狐浏览器双核浏览扩展，可以让火狐浏览器额外使用 Internet Explorer (IE) 内核浏览网页。只需鼠标轻轻一点，即可在Firefox和IE内核之间进行切换。[/p]
+                                   [p]使用解雇IE，您可以编写自动切换规则，这样在访问特定站点时解雇IE可以自动切换到IE引擎。类似于 Adblock Plus，您也可以订阅现有的切换规则列表。我们目前维护一个针对中文站点的切换规则列表。[/p]
+                                   [p]解雇IE会保持IE内核和Firefox内核的Cookie同步，因此切换内核浏览时无需重复登陆。大多数快捷键和功能在IE内核下仍然起作用，比如“Ctrl +”和“Ctrl -”缩放页面，“Ctrl F”搜索文本，“Ctrl D”保存书签等。[/p]
+                                   [p]扩展还支持在IE内核下使用鼠标手势，只要您安装了 FireGestures、All-in-One Gestures 或类似的扩展，就可以同样在IE内核下使用它们。[/p]
+                                   [p]扩展已支持 Adblock Plus，您将不再被IE引擎下的广告所打扰。[/p]
+                                   [p]从0.3.3版本起，32位和64位扩展已合并，我们不再单独提供64位扩展。[/p]">
+
+<!ENTITY about.why                "[p]解雇IE主要目是为了解决火狐浏览器在中国市场的网页兼容问题。中国大陆及台湾地区存在大量只支持IE浏览器网站，解雇IE可以让用户在火狐浏览器下无障碍地访问这些网站。[/p]">
+
+<!ENTITY about.whatsNext          "[p]智能切换功能。[/p]">
+
+<!ENTITY about.links              "[p]项目主页： [link href='http://fireie.org/zh-CN'][/link][/p]
+                                   [p]常见问题： [link href='http://fireie.org/zh-CN/faq'][/link][br/]
+                                      更换皮肤： [link href='http://fireie.org/zh-CN/skins'][/link][br/]
+                                      如何编写切换规则： [link href='http://fireie.org/zh-CN/switch_rules'][/link]
+                                   [/p]
+                                   [p]源代码： [link href='https://github.com/yxl/Fire-IE'][/link][br/]
+                                      您可以通过下列URL反馈问题、提出建议或是提供翻译：
+                                   [ul][li][link href='https://g.mozest.com/forum-83-1'][/link] (中文支持论坛)[/li]
+                                       [li][link href='https://github.com/yxl/Fire-IE/issues'][/link] (GitHub issue 列表)[/li]
+                                   [/ul]
+                                   [/p]">
diff --git a/extension/chrome/locale/zh-CN/fireie.dtd b/extension/chrome/locale/zh-CN/fireie.dtd
index 7dfd933..8066f0e 100644
--- a/extension/chrome/locale/zh-CN/fireie.dtd
+++ b/extension/chrome/locale/zh-CN/fireie.dtd
@@ -34,7 +34,6 @@
 <!ENTITY fireie.options.ui.showTooltipText "鼠标悬停时显示引擎状态信息">
 <!ENTITY fireie.options.ui.statusBarCaption "浮动状态栏">
 <!ENTITY fireie.options.ui.showStatusText "在浮动状态栏中显示IE引擎的状态消息">
-<!ENTITY fireie.options.ui.buttonStylesURL "chrome://fireie/skin/url-button-styles-cn.png">
 <!ENTITY fireie.options.ui.faviconCaption "标签页图标">
 <!ENTITY fireie.options.ui.faviconSite "使用网站图标">
 <!ENTITY fireie.options.ui.faviconIE "使用IE引擎图标">
diff --git a/extension/chrome/locale/zh-CN/pluginNotFound.dtd b/extension/chrome/locale/zh-CN/pluginNotFound.dtd
index 6e77de1..766337d 100644
--- a/extension/chrome/locale/zh-CN/pluginNotFound.dtd
+++ b/extension/chrome/locale/zh-CN/pluginNotFound.dtd
@@ -4,3 +4,7 @@
 <!ENTITY correctVersion             "根据您的配置，您应该使用[bit]位版本。">
 <!ENTITY homepage                   "http://fireie.org/zh-CN">
 <!ENTITY visitHomepage              "请至 [link][host][/link] 下载安装。">
+
+<!ENTITY pluginNotFound3            "您可能安装了错误版本的解雇IE；插件可能被移除，或者在附加组件管理器中被禁用。">
+<!ENTITY makeSure                   "请确认在 [link]附加组件管理器[/link] 中已启用了 &quot;Fire IE DLL&quot; 。">
+<!ENTITY reinstall                  "或者，您也可尝试从 [link][host][/link] 重新安装解雇IE。">
diff --git a/extension/chrome/locale/zh-CN/rules.dtd b/extension/chrome/locale/zh-CN/rules.dtd
index 34220d5..ea8fe2e 100644
--- a/extension/chrome/locale/zh-CN/rules.dtd
+++ b/extension/chrome/locale/zh-CN/rules.dtd
@@ -1,7 +1,8 @@
 <!ENTITY dialog.title "解雇IE切换规则参数">
 <!ENTITY subscriptions.tab.label "已订阅的规则">
 <!ENTITY rules.tab.label "自定义规则">
-<!ENTITY subscription.autoupdate "自动更新">
+<!ENTITY subscription.autoupdate.label "自动更新">
+<!ENTITY subscription.autoupdate.accesskey "a">
 <!ENTITY addSubscription.label "订阅新规则">
 <!ENTITY addSubscription.accesskey "f">
 <!ENTITY addSubscriptionAdd.label "订阅">
diff --git a/extension/chrome/locale/zh-CN/url-button-styles.png b/extension/chrome/locale/zh-CN/url-button-styles.png
new file mode 100644
index 0000000..baa27ac
Binary files /dev/null and b/extension/chrome/locale/zh-CN/url-button-styles.png differ
diff --git a/extension/chrome/locale/zh-TW/about.dtd b/extension/chrome/locale/zh-TW/about.dtd
new file mode 100644
index 0000000..92c4f8a
--- /dev/null
+++ b/extension/chrome/locale/zh-TW/about.dtd
@@ -0,0 +1,27 @@
+<!ENTITY about.longDesc.label     "關於此附加元件：">
+<!ENTITY about.why.label          "開發此附加元件的緣由：">
+<!ENTITY about.whatsNext.label    "此附加元件的下一步計畫：">
+<!ENTITY about.links.label        "連結：">
+
+<!ENTITY about.longDesc           "[p]解雇IE(Fire IE)是一個火狐瀏覽器雙核瀏覽拓展，可以讓火狐瀏覽器額外使用 Internet Explorer (IE) 內核瀏覽網頁。只需滑鼠輕輕一點，即可在Firefox和IE內核之間進行切換。[/p]
+                                   [p]使用解雇IE，您可以編寫自動切換規則，這樣在訪問特定網站時解雇IE可以自動切換到IE引擎。類似於 Adblock Plus，您也可以訂閱現有的切換規則清單。我們目前維護一個針對中文網站的切換規則清單。[/p]
+                                   [p]解雇IE會保持IE內核和Firefox內核的Cookie同步，因此切換內核瀏覽時無需重複登陸。大多數快速鍵和功能在IE內核下仍然起作用，比如“Ctrl +”和“Ctrl -”縮放頁面，“Ctrl F”搜索文本，“Ctrl D”保存書簽等。[/p]
+                                   [p]拓展還支援在IE內核下使用滑鼠手勢，只要您安裝了 FireGestures、All-in-One Gestures 或類似的拓展，就可以同樣在IE內核下使用它們。[/p]
+                                   [p]拓展已支援 Adblock Plus，您將不再被IE引擎下的廣告所打擾。[/p]
+                                   [p]從0.3.3版本起，32位和64位拓展已合併，我們不再單獨提供64位拓展。[/p]">
+
+<!ENTITY about.why                "[p]解雇IE主要目的是為了解決火狐瀏覽器在中國市場的網頁相容問題。中國大陸及臺灣地區存在大量僅支援IE瀏覽器網站，解雇IE可以讓用戶在火狐瀏覽器下無障礙地訪問這些網站。[/p]">
+
+<!ENTITY about.whatsNext          "[p]智能切換功能。[/p]">
+
+<!ENTITY about.links              "[p]項目主頁： [link href='http://fireie.org/zh-CN'][/link][/p]
+                                   [p]常見問題： [link href='http://fireie.org/zh-CN/faq'][/link][br/]
+                                      更換面板： [link href='http://fireie.org/zh-CN/skins'][/link][br/]
+                                      如何編寫切換規則： [link href='http://fireie.org/zh-CN/switch_rules'][/link]
+                                   [/p]
+                                   [p]原始程式碼： [link href='https://github.com/yxl/Fire-IE'][/link][br/]
+                                      您可以通過下列URL回饋問題、提出建議或是提供翻譯：
+                                   [ul][li][link href='https://g.mozest.com/forum-83-1'][/link] (中文支援論壇)[/li]
+                                       [li][link href='https://github.com/yxl/Fire-IE/issues'][/link] (GitHub issue 列表)[/li]
+                                   [/ul]
+                                   [/p]">
diff --git a/extension/chrome/locale/zh-TW/fireie.dtd b/extension/chrome/locale/zh-TW/fireie.dtd
index cb7c783..9b25d4b 100644
--- a/extension/chrome/locale/zh-TW/fireie.dtd
+++ b/extension/chrome/locale/zh-TW/fireie.dtd
@@ -34,7 +34,6 @@
 <!ENTITY fireie.options.ui.showTooltipText "滑鼠懸停時顯示引擎狀態資訊">
 <!ENTITY fireie.options.ui.statusBarCaption "浮動狀態列">
 <!ENTITY fireie.options.ui.showStatusText "在浮動狀態列中顯示IE引擎的狀態訊息">
-<!ENTITY fireie.options.ui.buttonStylesURL "chrome://fireie/skin/url-button-styles-cn.png">
 <!ENTITY fireie.options.ui.faviconCaption "分頁圖示">
 <!ENTITY fireie.options.ui.faviconSite "使用網站圖示">
 <!ENTITY fireie.options.ui.faviconIE "使用IE引擎圖示">
diff --git a/extension/chrome/locale/zh-TW/pluginNotFound.dtd b/extension/chrome/locale/zh-TW/pluginNotFound.dtd
index a704ebf..f75a97f 100644
--- a/extension/chrome/locale/zh-TW/pluginNotFound.dtd
+++ b/extension/chrome/locale/zh-TW/pluginNotFound.dtd
@@ -4,3 +4,7 @@
 <!ENTITY correctVersion             "根據您的配置，您應該使用[bit]位版本。">
 <!ENTITY homepage                   "http://fireie.org/zh-CN">
 <!ENTITY visitHomepage              "請至 [link][host][/link] 下載安裝。">
+
+<!ENTITY pluginNotFound3            "您可能安裝了錯誤版本的解雇IE；外掛程式可能被移除，或者在附加元件管理員中被禁用。">
+<!ENTITY makeSure                   "請確認在 [link]附加元件管理員[/link] 中已啟用了 &quot;Fire IE DLL&quot; 。">
+<!ENTITY reinstall                  "或者，您也可嘗試從 [link][host][/link] 重新安裝解雇IE。">
diff --git a/extension/chrome/locale/zh-TW/rules.dtd b/extension/chrome/locale/zh-TW/rules.dtd
index 2ebcc47..d7bcb97 100644
--- a/extension/chrome/locale/zh-TW/rules.dtd
+++ b/extension/chrome/locale/zh-TW/rules.dtd
@@ -1,7 +1,8 @@
 <!ENTITY dialog.title "解雇IE切換規則參數">
 <!ENTITY subscriptions.tab.label "已訂閱的規則">
 <!ENTITY rules.tab.label "自定義規則">
-<!ENTITY subscription.autoupdate "自動更新">
+<!ENTITY subscription.autoupdate.label "自動更新">
+<!ENTITY subscription.autoupdate.accesskey "a">
 <!ENTITY addSubscription.label "訂閱新規則">
 <!ENTITY addSubscription.accesskey "f">
 <!ENTITY addSubscriptionAdd.label "訂閱">
diff --git a/extension/chrome/locale/zh-TW/url-button-styles.png b/extension/chrome/locale/zh-TW/url-button-styles.png
new file mode 100644
index 0000000..baa27ac
Binary files /dev/null and b/extension/chrome/locale/zh-TW/url-button-styles.png differ
diff --git a/extension/chrome/skin/about.css b/extension/chrome/skin/about.css
new file mode 100644
index 0000000..8a2d50a
--- /dev/null
+++ b/extension/chrome/skin/about.css
@@ -0,0 +1,49 @@
+/*
+This file is part of Fire-IE.
+
+Fire-IE is free software: you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation, either version 3 of the License, or
+(at your option) any later version.
+
+Fire-IE is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+
+You should have received a copy of the GNU General Public License
+along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
+*/
+
+@namespace url("http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul");
+@namespace html url("http://www.w3.org/1999/xhtml");
+
+#fireieAbout {
+  padding: 0px;
+  min-height: 200px;
+  max-height: 600px;
+  width: 50em;
+}
+
+@media (-moz-windows-compositor) {
+  #fireieAbout {
+    -moz-appearance: -moz-win-glass;
+    background: transparent;
+  }
+}
+
+.text-link {
+  border: none;
+  margin: 0;
+  padding: 0;
+}
+
+#links html|ul {
+  list-style-type: none;
+  margin: 0;
+  padding: 0;
+}
+
+#links html|ul html|li {
+  margin: 0 18px;
+}
diff --git a/extension/chrome/skin/fireie.css b/extension/chrome/skin/fireie.css
index 24d04c3..dd459be 100644
--- a/extension/chrome/skin/fireie.css
+++ b/extension/chrome/skin/fireie.css
@@ -1,6 +1,7 @@
 @namespace url("http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul");
 
-#fireie-urlbar-switch-image, #fireie-toolbar-palette-button{
+/* Force priority over chrome default CSS */
+#fireie-urlbar-switch[fx-icon-url][ie-icon-url], #fireie-urlbar-switch-image, #fireie-toolbar-palette-button {
   list-style-image: url("chrome://fireie/skin/engine-fx.png");
 }
 
@@ -24,11 +25,11 @@
   display: none;
 }
 
-#fireie-urlbar-switch[disabled="true"] #fireie-urlbar-switch-tooltip1 {
+#fireie-urlbar-switch-tooltip.btndisabled #fireie-urlbar-switch-tooltip1 {
   display: none;
 }
 
-#fireie-urlbar-switch[disabled="true"] #fireie-urlbar-switch-tooltip1-disabled {
+#fireie-urlbar-switch-tooltip.btndisabled #fireie-urlbar-switch-tooltip1-disabled {
   display: inline;
 }
 
diff --git a/extension/chrome/skin/pluginNotFound.css b/extension/chrome/skin/pluginNotFound.css
new file mode 100644
index 0000000..eb1df9f
--- /dev/null
+++ b/extension/chrome/skin/pluginNotFound.css
@@ -0,0 +1,11 @@
+@namespace url("http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul");
+
+description {
+  width: 350px;
+}
+
+.text-link {
+  border: none;
+  margin: 0;
+  padding: 0;
+}
diff --git a/extension/chrome/skin/url-button-styles-cn.png b/extension/chrome/skin/url-button-styles-cn.png
deleted file mode 100644
index baa27ac..0000000
Binary files a/extension/chrome/skin/url-button-styles-cn.png and /dev/null differ
diff --git a/extension/defaults/preferences/fireie.js b/extension/defaults/preferences/fireie.js
index f6734c6..796d878 100644
--- a/extension/defaults/preferences/fireie.js
+++ b/extension/defaults/preferences/fireie.js
@@ -19,6 +19,7 @@ pref("extensions.fireie.savestats", true);
 // General
 pref("extensions.fireie.handleUrlBar", false);
 pref("extensions.fireie.autoswitch_enabled", true);
+pref("extensions.fireie.autoSwitchBackEnabled", true);
 pref("extensions.fireie.shortcutEnabled", true);
 pref("extensions.fireie.shortcut_modifiers", "alt");
 pref("extensions.fireie.shortcut_key", "C");
@@ -37,6 +38,7 @@ pref("extensions.fireie.ieLabel", "");
 pref("extensions.fireie.forceMGSupport", false);
 pref("extensions.fireie.abpSupportEnabled", true);
 pref("extensions.fireie.cookieSyncEnabled", true);
+pref("extensions.fireie.fontSyncEnabled", true);
 
 // IE Options
 pref("extensions.fireie.compatMode", "ie7mode");
diff --git a/extension/install.rdf b/extension/install.rdf
index bf6d811..e450ef4 100644
--- a/extension/install.rdf
+++ b/extension/install.rdf
@@ -5,13 +5,14 @@
 
    <em:id>fireie@fireie.org</em:id>
    <em:name>Fire IE</em:name>
-   <em:version>0.3.3</em:version>
+   <em:version>0.3.4</em:version>
    <em:description>Switch to IE engine in one click and give up your Internet Explorer.</em:description>
    <em:creator>Yuan Xulei</em:creator>
    <em:contributor>Wei Deng</em:contributor>
    <em:contributor>Yifan Wu</em:contributor>
    <em:homepageURL>http://fireie.org/</em:homepageURL>
    <em:optionsURL>chrome://fireie/content/options2.xul</em:optionsURL>
+   <em:aboutURL>chrome://fireie/content/about.xul</em:aboutURL>
    <em:iconURL>chrome://fireie/skin/icon.png</em:iconURL>
    <em:targetPlatform>WINNT</em:targetPlatform>
    <em:unpack>true</em:unpack>
@@ -21,7 +22,7 @@
      <Description>
        <em:id>{ec8030f7-c20a-464f-9b0e-13a3a9e97384}</em:id>
        <em:minVersion>6.0</em:minVersion>
-       <em:maxVersion>23.0a1</em:maxVersion>
+       <em:maxVersion>25.0a1</em:maxVersion>
      </Description>
    </em:targetApplication>
 
@@ -34,8 +35,9 @@
        <em:contributor>Yifan Wu</em:contributor>
        <em:translator>cck168 (zh-TW)</em:translator>
        <em:translator>Alexander Gvaramiya (ru-RU)</em:translator>
+       <em:translator>github.com/piotrex (pl)</em:translator>
        <em:homepageURL>http://fireie.org/en</em:homepageURL>
-       <em:description>Switch to IE engine in one click and give up your Internet Explorer.</em:description>
+       <em:description>Embeds Internet Explorer(IE) to use the powerful Firefox add-ons. Not only an enhanced IE Tab, but also an enhanced Internet Explorer with Addblock plus and FireGestures support. Switch to the IE engine in one click and dismiss your IE.</em:description>
      </Description>
    </em:localized>
 
@@ -48,8 +50,9 @@
        <em:contributor>吴一帆</em:contributor>
        <em:translator>cck168 (zh-TW)</em:translator>
        <em:translator>Alexander Gvaramiya (ru-RU)</em:translator>
+       <em:translator>github.com/piotrex (pl)</em:translator>
        <em:homepageURL>http://fireie.org/zh-CN</em:homepageURL>
-       <em:description>一键切换IE内核, 让你彻底抛弃IE。</em:description>
+       <em:description>让火狐兼容IE的双核扩展，一键切换至IE内核，网银支付无忧愁。支持Adblock plus和FireGestures，在IE中使用鼠标手势和屏蔽广告。</em:description>
      </Description>
    </em:localized>
 
@@ -62,8 +65,9 @@
        <em:contributor>吴一帆</em:contributor>
        <em:translator>cck168 (zh-TW)</em:translator>
        <em:translator>Alexander Gvaramiya (ru-RU)</em:translator>
+       <em:translator>github.com/piotrex (pl)</em:translator>
        <em:homepageURL>http://fireie.org/zh-CN</em:homepageURL>
-       <em:description>一鍵切換IE內核, 讓你徹底拋棄IE</em:description>
+       <em:description>讓火狐相容IE的雙核拓展，一鍵切換至IE內核，網路銀行支付無憂愁。支援Adblock plus和FireGestures，在IE中使用滑鼠手勢和遮罩廣告。</em:description>
      </Description>
    </em:localized>
 
@@ -76,8 +80,24 @@
        <em:contributor>Yifan Wu</em:contributor>
        <em:translator>cck168 (zh-TW)</em:translator>
        <em:translator>Alexander Gvaramiya (ru-RU)</em:translator>
+       <em:translator>github.com/piotrex (pl)</em:translator>
        <em:homepageURL>http://fireie.org/en</em:homepageURL>
-       <em:description>Switch to IE engine in one click and give up your Internet Explorer.</em:description>
+       <em:description>Embeds Internet Explorer(IE) to use the powerful Firefox add-ons. Not only an enhanced IE Tab, but also an enhanced Internet Explorer with Addblock plus and FireGestures support. Switch to the IE engine in one click and dismiss your IE.</em:description>
+     </Description>
+   </em:localized>
+   
+   <em:localized>
+     <Description>
+       <em:locale>pl</em:locale>
+       <em:name>Fire IE</em:name>
+       <em:creator>Yuan Xulei</em:creator>
+       <em:contributor>Wei Deng</em:contributor>
+       <em:contributor>Yifan Wu</em:contributor>
+       <em:translator>cck168 (zh-TW)</em:translator>
+       <em:translator>Alexander Gvaramiya (ru-RU)</em:translator>
+       <em:translator>github.com/piotrex (pl)</em:translator>
+       <em:homepageURL>http://fireie.org/en</em:homepageURL>
+       <em:description>Osadza Internet Explorer (IE) do korzystania ze świetnych dodatków do Firefoksa. Jest to nie tylko ulepszone IE Tab, ale też ulepszony IE ze wparciem dla AdblockPlus i gestów FireGestures. Zmieniaj jednym kliknięciem silnik na IE i porzuć swój IE.</em:description>
      </Description>
    </em:localized>
 
diff --git a/extension/modules/AppIntegration.jsm b/extension/modules/AppIntegration.jsm
index 2f7dbc5..bff5552 100644
--- a/extension/modules/AppIntegration.jsm
+++ b/extension/modules/AppIntegration.jsm
@@ -69,8 +69,8 @@ function init()
   Prefs.addListener(function(name)
   {
     if (name == "showUrlBarLabel" || name == "hideUrlBarButton" || name == "showTooltipText"
-      || name == "shortcut_key" || name == "shortcut_modifiers" || name == "currentTheme"
-      || name == "fxLabel" || name == "ieLabel")
+      || name == "shortcut_key" || name == "shortcut_modifiers" || name == "shortcutEnabled"
+      || name == "currentTheme" || name == "fxLabel" || name == "ieLabel")
     {
       reloadPrefs();
     }
@@ -385,6 +385,7 @@ WindowWrapper.prototype = {
     this.window.addEventListener("mousedown", this._bindMethod(this._onMouseDown), true);
     this.E("urlbar-reload-button").addEventListener("click", this._bindMethod(this._onClickInsideURLBar), false);
     this.E("urlbar-stop-button").addEventListener("click", this._bindMethod(this._onClickInsideURLBar), false);
+    this.E("star-button").addEventListener("click", this._bindMethod(this._onClickInsideURLBar), false);
     
     // Listen to plugin events
     this.window.addEventListener("IEProgressChanged", this._bindMethod(this._onIEProgressChange), false);
@@ -519,6 +520,8 @@ WindowWrapper.prototype = {
         this.window.PlacesStarButton.updateState();
       else if (this.window.BookmarksMenuButton && this.window.BookmarksMenuButton.updateStarState)
         this.window.BookmarksMenuButton.updateStarState();
+      else if (this.window.BookmarkingUI && this.window.BookmarkingUI.updateStarState)
+        this.window.BookmarkingUI.updateStarState();
 
       function escapeURLForCSS(url)
       {
@@ -526,12 +529,15 @@ WindowWrapper.prototype = {
       }
 
       // Update the engine button on the URL bar
-      urlbarButton = this.E("fireie-urlbar-switch");
+      let urlbarButton = this.E("fireie-urlbar-switch");
       urlbarButton.disabled = Utils.isFirefoxOnly(url); // disable engine switch for firefox-only urls
       urlbarButton.style.visibility = "visible";
+      let tooltip = this.E("fireie-urlbar-switch-tooltip");
+      tooltip.className = urlbarButton.disabled ? "btndisabled" : "";
       let fxURL = LightweightTheme.fxIconUrl;
       let ieURL = LightweightTheme.ieIconUrl;
       let engineIconCSS = 'url("' + escapeURLForCSS(isIEEngine ? ieURL : fxURL) + '")';
+      this.E("fireie-urlbar-switch").style.listStyleImage = engineIconCSS;
       this.E("fireie-urlbar-switch-image").style.listStyleImage = engineIconCSS;
       let urlbarButtonLabel = this.E("fireie-urlbar-switch-label");
       urlbarButtonLabel.value = isIEEngine ? (Prefs.ieLabel || Utils.getString("fireie.urlbar.switch.label.ie"))
@@ -619,22 +625,53 @@ WindowWrapper.prototype = {
    */
   _configureKeys: function()
   {
+    /*
+      <key id="key_fireieSwitch" command="cmd_fireieSwitch" modifiers="alt"
+      key="C" />
+    */
     try
     {
-      let keyItem = this.E('key_fireieSwitch');
-      if (keyItem)
+      let isFirst = false;
+      let keyItem = this.E("key_fireieSwitch");
+      if (!keyItem)
       {
-        if (Prefs.shortcutEnabled)
+        keyItem = this.CE("key")
+        keyItem.setAttribute("id", "key_fireieSwitch");
+        keyItem.setAttribute("command", "cmd_fireieSwitch");
+        this.E("mainKeyset").appendChild(keyItem);
+        isFirst = true;
+      }
+
+      // Modifying shortcut keys & modifiers requires a restart,
+      // while modifying the disabled state does not.
+      if (isFirst)
+      {
+        // Default key is "C"
+        let shortcut_key = Prefs.shortcut_key;
+        // Normalize to VK_* keycode
+        if (Utils.startsWith(shortcut_key, "VK_"))
         {
-          // Default key is "C"
-          keyItem.setAttribute('key', Prefs.shortcut_key);
-          // Default modifiers is "alt"
-          keyItem.setAttribute('modifiers', Prefs.shortcut_modifiers);
+          keyItem.setAttribute("keycode", shortcut_key);
+          keyItem.removeAttribute("key");
         }
         else
         {
-          keyItem.parentNode.removeChild(keyItem);
+          keyItem.setAttribute("key", shortcut_key);
+          keyItem.removeAttribute("keycode");
         }
+
+        // Default modifiers is "alt"
+        let shortcut_modifiers = Prefs.shortcut_modifiers;
+        keyItem.setAttribute("modifiers", shortcut_modifiers);
+      }
+
+      if (Prefs.shortcutEnabled)
+      {
+        keyItem.removeAttribute("disabled");
+      }
+      else
+      {
+        keyItem.setAttribute("disabled", "true");
       }
     }
     catch (e)
@@ -732,7 +769,13 @@ WindowWrapper.prototype = {
     }
     return null;
   },
-
+  
+  /** Check whether we should switch back to Firefox engine */
+  shouldSwitchBack: function(url)
+  {
+    return Prefs.autoswitch_enabled && Prefs.autoSwitchBackEnabled && Policy.checkEngineExceptionalRule(url);
+  },
+  
   /** Check whether current engine is IE.*/
   isIEEngine: function(aTab)
   {
@@ -748,13 +791,13 @@ WindowWrapper.prototype = {
   /**
    *  Switch the engine of specified tab.
    */
-  _switchTabEngine: function(aTab)
+  _switchTabEngine: function(aTab, automatic, overrideUrl)
   {
     if (aTab && aTab.localName == "tab")
     {
 
       // getURL retrieves the actual URL from, maybe, container url
-      let url = this.getURL(aTab);
+      let url = overrideUrl || this.getURL(aTab);
 
       let isIEEngineAfterSwitch = !this.isIEEngine(aTab);
 
@@ -763,15 +806,17 @@ WindowWrapper.prototype = {
         let browserNode = aTab.linkedBrowser.QueryInterface(Components.interfaces.nsIDOMNode);
         if (browserNode)
         {
-          if (!isIEEngineAfterSwitch)
+          if (!automatic)
           {
-            // User manually switches to Firefox engine.
-            // We have to tell ContentPolicy to stop monitoring this tab until user navigates another website.
-            browserNode.setAttribute('manuallySwitchToFirefox', Utils.getHostname(url));
+            // User manually switch engine.
+            // We have to tell ContentPolicy to stop monitoring this tab until user navigates to another website.
+            Policy.setManuallySwitched(browserNode, url);
           }
           else
           {
-            browserNode.removeAttribute('manuallySwitchToFirefox');
+            // prevent automatic switching on manuallySwitched tabs, until user navigates to another website.
+            if (Policy.isManuallySwitched(browserNode, url))
+              return;
           }
         }
       }
@@ -846,25 +891,20 @@ WindowWrapper.prototype = {
       let browserNode = aTab.linkedBrowser.QueryInterface(Components.interfaces.nsIDOMNode);
       if (browserNode)
       {
-        let isIEEngineAfterSwitch = this.isIEEngine(aTab);
-        if (!isIEEngineAfterSwitch)
-        {
-          // User manually switches to Firefox engine.
-          // We have to tell ContentPolicy to stop monitoring this tab until user navigates another website.
-          browserNode.setAttribute('manuallySwitchToFirefox', Utils.getHostname(url));
-        }
-        else
-        {
-          browserNode.removeAttribute('manuallySwitchToFirefox');
-        }
+        if (Utils.isIEEngine(url)) url = Utils.fromContainerUrl(url);
+        // User manually switch engine.
+        // We have to tell ContentPolicy to stop monitoring this tab until user navigates another website.
+        Policy.setManuallySwitched(browserNode, url);
       }
     }
   },
 
-  /** Switch current tab's engine */
-  switchEngine: function()
+  /** Switch the specified tab's engine, or current tab's engine if tab is not provided*/
+  /** If the switch is not initiated by the user, use automatic = true */
+  /** Override new url by providing the 3rd argument */
+  switchEngine: function(tab, automatic, overrideUrl)
   {
-    this._switchTabEngine(this.window.gBrowser.mCurrentTab);
+    this._switchTabEngine(tab || this.window.gBrowser.mCurrentTab, automatic, overrideUrl);
   },
 
   /** Show the options dialog */
@@ -959,7 +999,7 @@ WindowWrapper.prototype = {
         let originalURL = this.getURL();
         let isBlank = (originalURL == "about:blank");
         let handleUrlBar = Prefs.handleUrlBar;
-        let isSimilar = Utils.getHostname(originalURL) == Utils.getHostname(url);
+        let isSimilar = Utils.getEffectiveHost(originalURL) == Utils.getEffectiveHost(url);
         if (isBlank || handleUrlBar || isSimilar) return Utils.toContainerUrl(url);
       }
     }
@@ -1015,13 +1055,52 @@ WindowWrapper.prototype = {
     let data = JSON.parse(event.detail);
     let url = data.url;
     let id = data.id;
-    let newTab = this.window.gBrowser.addTab(Utils.toContainerUrl(url));
-    this.window.gBrowser.selectedTab = newTab;
+    var gBrowser = this.window.gBrowser;
+    let newTab = gBrowser.addTab("about:blank",
+      { relatedToCurrent: true }); // it is highly probable that the new tab is related to current
+
+    let shift = data.shift;
+    let ctrl = data.ctrl;
+    // shift  ctrl  value  where
+    //    0     0     0    current
+    //    0     1     1    tab
+    //    1     0     2    window
+    //    1     1     3    tabshifted
+    let where = shift ? (ctrl ? "tabshifted" : "window") : (ctrl ? "tab" : "current");
+    let loadInBackground = Utils.shouldLoadInBackground();
+
+    switch (where)
+    {
+    case "window":
+      gBrowser.hideTab(newTab);
+      gBrowser.replaceTabWithWindow(newTab);
+      break;
+    case "current":
+      gBrowser.selectedTab = newTab;
+      break;
+    case "tabshifted":
+      loadInBackground = !loadInBackground;
+      // fall through
+    case "tab":
+    default:
+      if (!loadInBackground)
+        gBrowser.selectedTab = newTab;
+      // otherwise, A background tab has been opened, nothing else to do here.
+      break;
+    }
 
     let param = {
       id: id
     };
     Utils.setTabAttributeJSON(newTab, "fireieNavigateParams", param);
+    
+    // load URI outside of addTab() to supress potential load error message caused by switch back
+    const flags = Ci.nsIWebNavigation.LOAD_FLAGS_STOP_CONTENT;
+    try
+    {
+      newTab.linkedBrowser.loadURIWithFlags(Utils.toContainerUrl(url), flags);
+    }
+    catch (ex) { }
   },
 
   _onIESetSecureLockIcon: function(event)
@@ -1897,7 +1976,8 @@ WindowWrapper.prototype = {
     {
       // switch behavior similar to the reload button
       let where = this.window.whereToOpenLink(e, false, true);
-
+      let loadInBackground = Utils.shouldLoadInBackground();
+      
       if (where == "current")
         this.switchEngine();
       else
@@ -1907,13 +1987,12 @@ WindowWrapper.prototype = {
         {
           let url = this._getURLAfterSwitch(gBrowser.selectedTab);
           // should load actual url after setting the manuallyswitched flag
-          let newTab = gBrowser.addTab("about:blank");
+          let newTab = gBrowser.addTab("about:blank",
+            { relatedToCurrent: true });
           // first set manual switch flags
           this._setManuallySwitchFlag(newTab, url);
-          // and then load the actual url
-          const flags = Ci.nsIWebNavigation.LOAD_FLAGS_STOP_CONTENT;
-          newTab.linkedBrowser.loadURIWithFlags(url, flags);
           
+          // determine the tab location
           switch (where)
           {
           case "window":
@@ -1921,12 +2000,22 @@ WindowWrapper.prototype = {
             gBrowser.replaceTabWithWindow(newTab);
             break;
           case "tabshifted":
-            // A background tab has been opened, nothing else to do here.
-            break;
+            loadInBackground = !loadInBackground;
+            // fall through
           case "tab":
-            gBrowser.selectedTab = newTab;
+            if (!loadInBackground)
+              gBrowser.selectedTab = newTab;
+            // otherwise, A background tab has been opened, nothing else to do here.
             break;
           }
+
+          // and then load the actual url
+          const flags = Ci.nsIWebNavigation.LOAD_FLAGS_STOP_CONTENT;
+          try
+          {
+            newTab.linkedBrowser.loadURIWithFlags(url, flags);
+          }
+          catch (ex) { }
         }
       }
     }
diff --git a/extension/modules/ContentPolicy.jsm b/extension/modules/ContentPolicy.jsm
index 74a7000..0fff2bc 100644
--- a/extension/modules/ContentPolicy.jsm
+++ b/extension/modules/ContentPolicy.jsm
@@ -28,12 +28,14 @@ let baseURL = Cc["@fireie.org/fireie/private;1"].getService(Ci.nsIURI);
 
 Cu.import("resource://gre/modules/XPCOMUtils.jsm");
 Cu.import("resource://gre/modules/Services.jsm");
+Cu.import("resource://gre/modules/NetUtil.jsm");
 
 Cu.import(baseURL.spec + "Utils.jsm");
 Cu.import(baseURL.spec + "Prefs.jsm");
 Cu.import(baseURL.spec + "RuleStorage.jsm");
 Cu.import(baseURL.spec + "RuleClasses.jsm");
 Cu.import(baseURL.spec + "Matcher.jsm");
+Cu.import(baseURL.spec + "UtilsPluginManager.jsm");
 
 /**
  * Public policy checking functions and auxiliary objects
@@ -99,6 +101,23 @@ var Policy = {
   },
 
   /**
+   * Checks whether the page should be loaded in Firefox engine. 
+   * @param {String} url
+   * @return {Boolean} true if Firefox engine should be used.
+   */
+  checkEngineExceptionalRule: function(url)
+  {
+    if (Utils.isFirefoxOnly(url)) return true;
+    let docDomain = Utils.getHostname(url);
+    let match = EngineMatcher.matchesAny(url, docDomain);
+    if (match)
+    {
+      RuleStorage.increaseHitCount(match);
+    }
+    return match && match instanceof EngineExceptionalRule;
+  },
+
+  /**
    * Checks whether IE user agent should be used. 
    * @param {String} url
    * @return {UserAgentRule} the rule if there's any match
@@ -121,6 +140,28 @@ var Policy = {
   isSwitchableScheme: function(location)
   {
     return !(location.scheme in Policy.ignoredSchemes);
+  },
+  
+  /**
+   * Checks whether user has manually switched engine on current tab & url
+   * @param {nsIDOMNode} browserNode
+   * @param {String} url
+   * @return {Boolean}
+   */
+  isManuallySwitched: function(browserNode, url)
+  {
+    let hostName = Utils.getEffectiveHost(url);
+    return hostName && browserNode.getAttribute('manuallySwitched') == hostName;
+  },
+  
+  /**
+   * Sets the manually switched flag on current tab & url
+   * @param {nsIDOMNode} browserNode
+   * @param {String} url
+   */
+  setManuallySwitched: function(browserNode, url)
+  {
+    browserNode.setAttribute('manuallySwitched', Utils.getEffectiveHost(url));
   }
 };
 
@@ -162,9 +203,9 @@ var PolicyPrivate = {
     catch (ex) { }
     if (!browserNode) return Ci.nsIContentPolicy.ACCEPT;
 
-    // User has manually switched to Firefox engine
-    let hostName = Utils.getHostname(location.spec);
-    if (hostName && browserNode.getAttribute('manuallySwitchToFirefox') == hostName) return Ci.nsIContentPolicy.ACCEPT;
+    // User has manually switched engine
+    if (Policy.isManuallySwitched(browserNode, location.spec))
+      return Ci.nsIContentPolicy.ACCEPT;
 
     // Check engine switch list
     if (Policy.checkEngineRule(location.spec))
@@ -175,7 +216,25 @@ var PolicyPrivate = {
       }, this);
       return Ci.nsIContentPolicy.REJECT_OTHER;
     }
-
+    // Check engine switch back list
+    if (Prefs.autoSwitchBackEnabled && Utils.isIEEngine(location.spec))
+    {
+      let url = Utils.fromContainerUrl(location.spec);
+      if (Policy.isManuallySwitched(browserNode, url))
+        return Ci.nsIContentPolicy.ACCEPT;
+      if (Policy.checkEngineExceptionalRule(url))
+      {
+        Utils.runAsync(function()
+        {
+          browserNode.loadURI(url);
+          // Check dangling CIEHostWindow s, as we just skipped attaching them to a plugin Object
+          let tab = Utils.getTabFromBrowser(browserNode);
+          UtilsPluginManager.checkDanglingNewWindow(tab);
+        }, this);
+        return Ci.nsIContentPolicy.REJECT_OTHER;
+      }
+    }
+    
     return Ci.nsIContentPolicy.ACCEPT;
   },
 
@@ -228,9 +287,8 @@ var PolicyPrivate = {
             if (browserNode)
             {
               // User has manually switched to Firefox engine
-              let hostName = Utils.getHostname(url);
-              let manualSwitch = hostName && browserNode.getAttribute('manuallySwitchToFirefox') == Utils.getHostname(url);
-              if (manualSwitch) return;
+              if (Policy.isManuallySwitched(browserNode, url))
+                return;
             }
 
             // Check engine switch list
diff --git a/extension/modules/Favicon.jsm b/extension/modules/Favicon.jsm
index f5f3ba3..7795a81 100644
--- a/extension/modules/Favicon.jsm
+++ b/extension/modules/Favicon.jsm
@@ -24,8 +24,17 @@ var EXPORTED_SYMBOLS = ["Favicon"];
 var Favicon = {
 
   setIcon: function(document, iconURL) {
-    this._removeIconIfExists(document);
-    this._addIcon(document, iconURL);
+    var link = this._docHead(document).querySelector("link[rel=icon]");
+    // If favicon not changed, do nothing
+    if (link && link.href === iconURL)
+      return;
+    
+    // Remove previous favicon if exists
+    if (link)
+      link.parentElement.removeChild(link);
+    // Add new favicon
+    if (iconURL)
+      this._addIcon(document, iconURL);
   },
 
   _addIcon: function(document, iconURL) {
@@ -36,20 +45,8 @@ var Favicon = {
     this._docHead(document).appendChild(link);
   },
 
-  _removeIconIfExists: function(document) {
-    var links = this._docHead(document).getElementsByTagName("link");
-    for (var i = 0; i < links.length; i++) {
-      var link = links[i];
-      if (link.rel == "icon") {
-        this._docHead(document).removeChild(link);
-        return; // Assuming only one match at most.
-      }
-    }
-  },
-
   _docHead: function(document) {
     return document.getElementsByTagName("head")[0];
   }
 
 };
-
diff --git a/extension/modules/FontObserver.jsm b/extension/modules/FontObserver.jsm
index 8386e51..c4d5d72 100644
--- a/extension/modules/FontObserver.jsm
+++ b/extension/modules/FontObserver.jsm
@@ -32,6 +32,7 @@ Cu.import("resource://gre/modules/XPCOMUtils.jsm");
 Cu.import("resource://gre/modules/Services.jsm");
 
 Cu.import(baseURL.spec + "Utils.jsm");
+Cu.import(baseURL.spec + "Prefs.jsm");
 
 const prefRoot = "font.name.";
 
@@ -83,6 +84,8 @@ var PrefsPrivate = {
 
   notifyDataChange: function()
   {
+    if (!Prefs.fontSyncEnabled) return;
+    
     let fontName = this.getFirefoxDefaultFontName();
     if (fontName && fontName.length) setIEDefaultFont(fontName);
   },
@@ -160,4 +163,4 @@ function setIEDefaultFont(fontName)
   {
     Utils.LOG("Failed to set IE default font: " + e);
   }
-}
\ No newline at end of file
+}
diff --git a/extension/modules/HookManager.jsm b/extension/modules/HookManager.jsm
index 7786ec9..a735f87 100644
--- a/extension/modules/HookManager.jsm
+++ b/extension/modules/HookManager.jsm
@@ -139,8 +139,8 @@ HookManager.prototype = {
       + "  } catch (ex) {\n"
       + "    Utils.ERROR('Failed executing hooked function: \"' + funcName + '\"@head: ' + ex);\n"
       + "  }\n"
-      + "  let newArguments = (ret && ret.arguments) || arguments;\n"
-      + "  return orgFunc.apply(this, newArguments);\n"
+      + "  let newArgs = (ret && ret.args) || arguments;\n"
+      + "  return orgFunc.apply(this, newArgs);\n"
       + "})",
 
   _wrapFunctionHead: function(orgFunc, myFunc, funcName)
@@ -182,14 +182,14 @@ HookManager.prototype = {
       + "  } catch (ex) {\n"
       + "    Utils.ERROR('Failed executing hooked function: \"' + funcName + '\"@head: ' + ex);\n"
       + "  }\n"
-      + "  let newArguments = (ret && ret.arguments) || arguments;\n"
+      + "  let newArgs = (ret && ret.args) || arguments;\n"
       + "  let orgRet = null, myRet = null;\n"
       + "  try {\n"
-      + "    orgRet = orgFunc.apply(this, newArguments);\n"
+      + "    orgRet = orgFunc.apply(this, newArgs);\n"
       + "  } finally {\n"
-      + "    Array.prototype.splice.call(newArguments, 0, 0, orgRet);\n"
+      + "    Array.prototype.splice.call(newArgs, 0, 0, orgRet);\n"
       + "    try {\n"
-      + "      myRet = myFuncTail.apply(this, newArguments);\n"
+      + "      myRet = myFuncTail.apply(this, newArgs);\n"
       + "    } catch (ex) {\n"
       + "      Utils.ERROR('Failed executing hooked function: \"' + funcName + '\"@tail: ' + ex);\n"
       + "    }\n"
@@ -239,9 +239,9 @@ HookManager.prototype = {
       return { shouldReturn: true, value: value };
     },
     // hook @ head should modify arguments passed to orgFunc
-    modifyArguments: function(arguments)
+    modifyArguments: function(args)
     {
-      return { shouldReturn: false, arguments: arguments };
+      return { shouldReturn: false, args: args };
     },
     // hook @ tail should modify the return value
     modifyValue: function(value)
diff --git a/extension/modules/IECookieManager.jsm b/extension/modules/IECookieManager.jsm
index 3fe438b..321ae2c 100644
--- a/extension/modules/IECookieManager.jsm
+++ b/extension/modules/IECookieManager.jsm
@@ -229,12 +229,16 @@ let IECookieManager = {
      * http://.baidu.com must be transformed into
      * http://baidu.com before it can be recognized
      */
-    let url = 'http://' + hostname + cookie2.path;
+    let url = (cookie2.isSecure ? 'https://' : 'http://') + hostname + cookie2.path;
     let cookieData = cookie2.name + "=" + cookie2.value + "; domain=" + cookie2.host + "; path=" + cookie2.path;
     if (cookie2.expires > 0)
     {
       cookieData += "; expires=" + this._getExpiresString(cookie2.expires);
     }
+    if (cookie2.isSecure)
+    {
+      cookieData += "; secure";
+    }
     if (cookie2.isHttpOnly)
     {
       cookieData +="; httponly";
@@ -375,11 +379,16 @@ let IECookieManager = {
     let cookiesDir = ieTempDir + "\\cookies";
     let cacheDir = ieTempDir + "\\cache";
 
-    let originalCookies = getIECtrlRegString("Cookies");
-    // Backup the cookie directory setting if needed.
-    if (getIECtrlRegString("Cookies_fireie") || setIECtrlRegString("Cookies_fireie", originalCookies))
+    // Temporary disable cookie folder redirection for IE10
+    // For details, see issue #98 (https://github.com/yxl/Fire-IE/issues/98)
+    if (Utils.ieMajorVersion < 10)
     {
-      setIECtrlRegString("Cookies", cookiesDir);
+      let originalCookies = getIECtrlRegString("Cookies");
+      // Backup the cookie directory setting if needed.
+      if (getIECtrlRegString("Cookies_fireie") || setIECtrlRegString("Cookies_fireie", originalCookies))
+      {
+        setIECtrlRegString("Cookies", cookiesDir);
+      }
     }
 
     let originalCache = getIECtrlRegString("Cache");
@@ -399,7 +408,7 @@ let IECookieManager = {
     let cookies = getIECtrlRegString("Cookies_fireie");
     if (cookies)
     {
-    // Remove backup values to allow user change IE browser's cache directory settings
+      // Remove backup values to allow user change IE browser's cache directory settings
       setIECtrlRegString("Cookies", cookies);
       removeIECtrlRegString("Cookies_fireie");
     }
diff --git a/extension/modules/Utils.jsm b/extension/modules/Utils.jsm
index 99cfaf6..2f09062 100644
--- a/extension/modules/Utils.jsm
+++ b/extension/modules/Utils.jsm
@@ -30,7 +30,8 @@ var Utils = {
   _ieUserAgent: null,
   _userAgent: null,
 
-  _ffMajorVersion: 4,
+  _ffMajorVersion: 6,
+  _ieMajorVersion: 6,
   
   /** nsITimer's */
   _timers: [],
@@ -58,6 +59,11 @@ var Utils = {
   {
     return this._ffMajorVersion;
   },
+  
+  get ieMajorVersion()
+  {
+    return this._ieMajorVersion;
+  },
 
   /**
    * Returns the VCS revision used for this Adblock Plus build
@@ -277,7 +283,13 @@ var Utils = {
   {
     return "resource://gre-resources/hiddenWindow.html";
   },
-
+  
+  /** Whether url is IE engine container url */
+  isIEEngine: function(url)
+  {
+    return Utils.startsWith(url, Utils.containerUrl);
+  },
+  
   /** Converts URL into IE Engine URL */
   toContainerUrl: function(url)
   {
@@ -463,6 +475,43 @@ var Utils = {
 
     return Utils.getTabFromDocument(aWindow.document);
   },
+  
+  generatorFromEnumerator: function(enumerator, nsInterface)
+  {
+    while (enumerator.hasMoreElements())
+    {
+      yield enumerator.getNext().QueryInterface(nsInterface);
+    }
+  },
+  
+  getTabFromBrowser: function(browser)
+  {
+    function getTabFromBrowserWithinWindow(browser, window)
+    {
+      let gBrowser = window.gBrowser;
+      if (gBrowser)
+      {
+        let mTabs = gBrowser.mTabContainer.childNodes;
+        for (let i = 0; i < mTabs.length; i++)
+        {
+          if (mTabs[i].linkedBrowser === browser)
+          {
+            return mTabs[i];
+          }
+        }
+      }
+      return null;
+    }
+    
+    let windows = Utils.generatorFromEnumerator(Services.wm.getEnumerator("navigator:browser"),
+      Ci.nsIDOMWindow);
+    for (let window in windows)
+    {
+      let tab = getTabFromBrowserWithinWindow(browser, window);
+      if (tab) return tab;
+    }
+    return null;
+  },
 
   /** Check whether URL is firefox-only
    *  e.g. about:config chrome://xxx
@@ -731,27 +780,42 @@ var Utils = {
       });
     }
   },
-
+  
   /**
-   * Opens a URL in the browser window. If browser window isn't passed as parameter,
-   * this function attempts to find a browser window. If an event is passed in
-   * it should be passed in to the browser if possible (will e.g. open a tab in
-   * background depending on modifiers keys).
+   * Attempts to find a browser window for opening a URL
    */
-  loadInBrowser: function( /**String*/ url)
+  findAnyBrowserWindow: function()
   {
-    let gBrowser = null;
-
     let enumerator = Services.wm.getZOrderDOMWindowEnumerator(null, true);
     while (enumerator.hasMoreElements())
     {
       let window = enumerator.getNext();
       if (window.gBrowser && window.gBrowser.addTab)
       {
-        gBrowser = window.gBrowser;
-        break;
+        return window;
       }
     }
+    return null;
+  },
+  
+  /**
+   * Attempts to find a browser object for opening a URL
+   */
+  findAnyBrowser: function()
+  {
+    let window = Utils.findAnyBrowserWindow();
+    if (window)
+      return window.gBrowser;
+    return null;
+  },
+
+  /**
+   * Opens a URL in the browser window. If browser window isn't passed as parameter,
+   * this function attempts to find a browser window.
+   */
+  loadInBrowser: function( /**String*/ url, /**Browser*/ browser)
+  {
+    let gBrowser = browser || Utils.findAnyBrowser();
 
     if (gBrowser)
     {
@@ -759,8 +823,12 @@ var Utils = {
     }
     else
     {
-      let protocolService = Cc["@mozilla.org/uriloader/external-protocol-service;1"].getService(Ci.nsIExternalProtocolService);
-      protocolService.loadURI(Utils.makeURI(url), null);
+      // open a new window and try again
+      win = Services.ww.openWindow(null, Utils.browserUrl, null, null, null);
+      win.addEventListener("load", function()
+      {
+        Utils.runAsyncTimeout(Utils.loadInBrowser, Utils, 100, url, win.gBrowser);
+      });
     }
   },
 
@@ -769,7 +837,7 @@ var Utils = {
    * send the UI language to fireie.org so that the correct language
    * version of the page can be selected.
    */
-  loadDocLink: function( /**String*/ linkID)
+  loadDocLink: function( /**String*/ linkID, /**Browser*/ browser)
   {
     let baseURL = Cc["@fireie.org/fireie/private;1"].getService(Ci.nsIURI);
     Cu.import(baseURL.spec + "Prefs.jsm");
@@ -778,7 +846,30 @@ var Utils = {
     let link = Prefs.documentation_link.replace(/%LINK%/g, linkID).replace(/%LANG%/g,
       Utils.appLocale in availableLanguages ? availableLanguages[Utils.appLocale]
                                             : availableLanguages["default"]);
-    Utils.loadInBrowser(link);
+    Utils.loadInBrowser(link, browser);
+  },
+  
+  /**
+   * Opens the Add-ons Manager to the specified addons:// URL. If browser window isn't
+   * passed as parameter, this function attempts to find a browser window.
+   */
+  openAddonsMgr: function( /**String*/ url, /**BrowserWindow*/ window)
+  {
+    let win = window || Utils.findAnyBrowserWindow();
+    
+    if (win)
+    {
+      win.BrowserOpenAddonsMgr(url);
+    }
+    else
+    {
+      // open a new window and try again
+      win = Services.ww.openWindow(null, Utils.browserUrl, null, null, null);
+      win.addEventListener("load", function()
+      {
+        Utils.runAsyncTimeout(Utils.openAddonsMgr, Utils, 100, url, win);
+      });
+    }
   },
 
   /**
@@ -933,6 +1024,14 @@ var Utils = {
       idx = arr.indexOf(item);
     }
   },
+  
+  shouldLoadInBackground: function() {
+    try {
+      return Services.prefs.getBoolPref("browser.tabs.loadInBackground");
+    } catch (ex) {
+      return true;
+    }
+  }
 };
 
 /**
@@ -961,7 +1060,7 @@ AddonManager.getAddonByID(Utils.addonID, function(addon)
   _addonVersionCallbacks = null;
 });
 
-(function() {
+(function FetchFirefoxMajorVersion() {
   let versionInfo = Cc["@mozilla.org/xre/app-info;1"]
     .getService(Components.interfaces.nsIXULAppInfo);
 
@@ -973,6 +1072,33 @@ AddonManager.getAddonByID(Utils.addonID, function(addon)
   Utils._ffMajorVersion = major;
 })();
 
+(function FetchIEMajorVersion() {
+  let wrk = Cc["@mozilla.org/windows-registry-key;1"].createInstance(Ci.nsIWindowsRegKey);
+  let version = 6;
+  try
+  {
+    wrk.create(wrk.ROOT_KEY_LOCAL_MACHINE, "SOFTWARE\\Microsoft\\Internet Explorer", wrk.ACCESS_READ);
+    let versionString = wrk.readStringValue("version");
+    version = parseInt(versionString, 10);
+    // for IE 10, version equals to "9.10.*.*", which should be handled specially
+    if (version == 9)
+    {
+      versionString = wrk.readStringValue("svcVersion");
+      version = parseInt(versionString, 10);
+    }
+    Utils.LOG("IE major version: " + version);
+  }
+  catch (e)
+  {
+    Utils.LOG("Failed to get IE version from registry: " + e);
+  }
+  finally
+  {
+    wrk.close();
+  }
+  Utils._ieMajorVersion = version;
+})();
+
 XPCOMUtils.defineLazyServiceGetter(Utils, "clipboard", "@mozilla.org/widget/clipboard;1", "nsIClipboard");
 XPCOMUtils.defineLazyServiceGetter(Utils, "clipboardHelper", "@mozilla.org/widget/clipboardhelper;1", "nsIClipboardHelper");
 XPCOMUtils.defineLazyServiceGetter(Utils, "categoryManager", "@mozilla.org/categorymanager;1", "nsICategoryManager");
diff --git a/extension/modules/UtilsPluginManager.jsm b/extension/modules/UtilsPluginManager.jsm
index de4c66e..bb13844 100644
--- a/extension/modules/UtilsPluginManager.jsm
+++ b/extension/modules/UtilsPluginManager.jsm
@@ -262,6 +262,22 @@ let UtilsPluginManager = {
       // Not all states map to a handler
       return null;
     }
+  },
+  
+  /**
+   * Check dangling new windows if we skipped attaching them to a plugin object
+   */
+  checkDanglingNewWindow: function(tab)
+  {
+    let attr = Utils.getTabAttributeJSON(tab, "fireieNavigateParams");
+    if (attr && attr.id)
+    {
+      Utils.LOG("Removing dangling IE new window, id = " + attr.id);
+      let plugin = this.getPlugin();
+      if (plugin)
+        plugin.RemoveNewWindow(attr.id);
+      tab.removeAttribute("fireieNavigateParams");
+    }
   }
 };
 
@@ -369,8 +385,11 @@ function loadFailureSubHandler()
   IECookieManager.restoreIETempDirectorySetting();
   // notify user about that
   Utils.ERROR("Plugin failed to load. Possibly due to wrong Fire-IE version.");
-  Services.ww.openWindow(null, "chrome://fireie/content/pluginNotFound.xul",
-    "_blank", "chrome,centerscreen,dialog", null);
+  Utils.runAsync(function()
+  {
+    Services.ww.openWindow(null, "chrome://fireie/content/pluginNotFound.xul",
+      "_blank", "chrome,centerscreen,dialog", null);
+  }, null);
 }
 
 /** handle the plugin load failure events and inform user about that */
@@ -435,7 +454,17 @@ function setDNTPref(plugin)
   }
   catch (ex)
   {
-    Utils.ERROR("Failed to set DNT pref: " + ex);
+    Utils.LOG("Failed to set DNT pref: " + ex);
+  }
+  try
+  {
+    let value = dntBranch.getIntPref("value");
+    plugin.SetDNTValue(value);
+    Utils.LOG("DNT value: " + value);
+  }
+  catch (ex)
+  {
+    Utils.LOG("Failed to set DNT value: " + ex);
   }
 }
 
@@ -448,9 +477,12 @@ let DNTObserverPrivate = {
    */
   observe: function(subject, topic, data)
   {
-    if (topic == "nsPref:changed" && data == "enabled")
+    if (topic == "nsPref:changed")
     {
-      setDNTPref(UtilsPluginManager.getPlugin());
+      if (data == "enabled" || data == "value")
+      {
+        setDNTPref(UtilsPluginManager.getPlugin());
+      }
     }
   },
 
diff --git a/extension/plugins/tldstring.txt b/extension/plugins/tldstring.txt
index 1cb61a1..e887ead 100644
--- a/extension/plugins/tldstring.txt
+++ b/extension/plugins/tldstring.txt
@@ -1 +1 @@
-root(308:ac(6:com,edu,gov,net,mil,org),ad(1:nom),ae(7:co,net,org,sch,ac,gov,mil),aero(89:accident-investigation,accident-prevention,aerobatic,aeroclub,aerodrome,agents,aircraft,airline,airport,air-surveillance,airtraffic,air-traffic-control,ambulance,amusement,association,author,ballooning,broker,caa,cargo,catering,certification,championship,charter,civilaviation,club,conference,consultant,consulting,control,council,crew,design,dgca,educator,emergency,engine,engineer,entertainment,equipment,exchange,express,federation,flight,freight,fuel,gliding,government,groundhandling,group,hanggliding,homebuilt,insurance,journal,journalist,leasing,logistics,magazine,maintenance,marketplace,media,microlight,modelling,navigation,parachuting,paragliding,passenger-association,pilot,press,production,recreation,repbody,res,research,rotorcraft,safety,scientist,services,show,skydiving,software,student,taxi,trader,trading,trainer,union,workinggroup,works),af(5:gov,com,org,net,edu),ag(5:com,org,net,co,nom),ai(4:off,com,net,org),al(6:com,edu,gov,mil,net,org),am,an(4:com,net,org,edu),ao(6:ed,gv,og,co,pb,it),aq,ar(11:*,congresodelalengua3(1:!),educ(1:!),gobiernoelectronico(1:!),mecon(1:!),nacion(1:!),nic(1:!),promocion(1:!),retina(1:!),uba(1:!),com(1:blogspot)),arpa(6:e164,in-addr,ip6,iris,uri,urn),as(1:gov),asia,at(7:ac,co(1:blogspot),gv,or,biz,info,priv),au(18:com(1:blogspot),net,org,edu(8:act,nsw,nt,qld,sa,tas,vic,wa),gov(7:act,nt,qld,sa,tas,vic,wa),asn,id,info,conf,oz,act,nsw,nt,qld,sa,tas,vic,wa),aw(1:com),ax,az(12:com,net,int,gov,org,edu,info,pp,mil,name,pro,biz),ba(10:org,net,edu,gov,mil,unsa,unbi,co,com,rs),bb(8:biz,com,edu,gov,info,net,org,store),bd(1:*),be(2:ac,blogspot),bf(1:gov),bg(36:a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,0,1,2,3,4,5,6,7,8,9),bh(5:com,edu,net,org,gov),bi(5:co,com,edu,or,org),biz(7:dyndns,for-better,for-more,for-some,for-the,selfip,webhop),bj(4:asso,barreau,gouv,blogspot),bm(5:com,edu,gov,net,org),bn(1:*),bo(9:com,edu,gov,gob,int,org,net,mil,tv),br(69:adm,adv,agr,am,arq,art,ato,b,bio,blog,bmd,cim,cng,cnt,com(1:blogspot),coop,ecn,eco,edu,emp,eng,esp,etc,eti,far,flog,fm,fnd,fot,fst,g12,ggf,gov,imb,ind,inf,jor,jus,leg,lel,mat,med,mil,mus,net,nom,not,ntr,odo,org,ppg,pro,psc,psi,qsl,radio,rec,slg,srv,taxi,teo,tmp,trd,tur,tv,vet,vlog,wiki,zlg),bs(5:com,net,org,edu,gov),bt(5:com,edu,gov,net,org),bw(2:co,org),by(4:gov,mil,com,of),bz(5:com,net,org,edu,gov),ca(17:ab,bc,mb,nb,nf,nl,ns,nt,nu,on,pe,qc,sk,yk,gc,co,blogspot),cat,cc(4:ftpaccess,game-server,myphotos,scrapping),cd(1:gov),cf(1:blogspot),cg,ch(1:blogspot),ci(15:org,or,com,co,edu,ed,ac,net,go,asso,aéroport,int,presse,md,gouv),ck(2:*,www(1:!)),cl(4:gov,gob,co,mil),cm(1:gov),cn(44:ac,com,edu,gov,net,org,mil,公司,网络,網絡,ah,bj,cq,fj,gd,gs,gz,gx,ha,hb,he,hi,hl,hn,jl,js,jx,ln,nm,nx,qh,sc,sd,sh,sn,sx,tj,xj,xz,yn,zj,hk,mo,tw),co(13:arts,com,edu,firm,gov,info,int,mil,net,nom,org,rec,web),com(178:ar,br,cn,de,eu,gb,gr,hu,jpn,kr,no,qc,ru,sa,se,uk,us,uy,za,operaunite,appspot,blogspot,codespot,googleapis,googlecode,dreamhosters,dyndns-at-home,dyndns-at-work,dyndns-blog,dyndns-free,dyndns-home,dyndns-ip,dyndns-mail,dyndns-office,dyndns-pics,dyndns-remote,dyndns-server,dyndns-web,dyndns-wiki,dyndns-work,blogdns,cechire,dnsalias,dnsdojo,doesntexist,dontexist,doomdns,dyn-o-saur,dynalias,est-a-la-maison,est-a-la-masion,est-le-patron,est-mon-blogueur,from-ak,from-al,from-ar,from-ca,from-ct,from-dc,from-de,from-fl,from-ga,from-hi,from-ia,from-id,from-il,from-in,from-ks,from-ky,from-ma,from-md,from-mi,from-mn,from-mo,from-ms,from-mt,from-nc,from-nd,from-ne,from-nh,from-nj,from-nm,from-nv,from-oh,from-ok,from-or,from-pa,from-pr,from-ri,from-sc,from-sd,from-tn,from-tx,from-ut,from-va,from-vt,from-wa,from-wi,from-wv,from-wy,getmyip,gotdns,hobby-site,homelinux,homeunix,iamallama,is-a-anarchist,is-a-blogger,is-a-bookkeeper,is-a-bulls-fan,is-a-caterer,is-a-chef,is-a-conservative,is-a-cpa,is-a-cubicle-slave,is-a-democrat,is-a-designer,is-a-doctor,is-a-financialadvisor,is-a-geek,is-a-green,is-a-guru,is-a-hard-worker,is-a-hunter,is-a-landscaper,is-a-lawyer,is-a-liberal,is-a-libertarian,is-a-llama,is-a-musician,is-a-nascarfan,is-a-nurse,is-a-painter,is-a-personaltrainer,is-a-photographer,is-a-player,is-a-republican,is-a-rockstar,is-a-socialist,is-a-student,is-a-teacher,is-a-techie,is-a-therapist,is-an-accountant,is-an-actor,is-an-actress,is-an-anarchist,is-an-artist,is-an-engineer,is-an-entertainer,is-certified,is-gone,is-into-anime,is-into-cars,is-into-cartoons,is-into-games,is-leet,is-not-certified,is-slick,is-uberleet,is-with-theband,isa-geek,isa-hockeynut,issmarterthanyou,likes-pie,likescandy,neat-url,saves-the-whales,selfip,sells-for-less,sells-for-u,servebbs,simple-url,space-to-rent,teaches-yoga,writesthisblog,betainabox,rhcloud),coop,cr(7:ac,co,ed,fi,go,or,sa),cu(6:com,edu,org,net,gov,inf),cv(1:blogspot),cx(2:gov,ath),cy(1:*),cz(1:blogspot),de(8:com,blogspot,fuettertdasnetz,isteingeek,istmein,lebtimnetz,leitungsen,traeumtgerade),dj,dk(1:blogspot),dm(5:com,net,org,edu,gov),do(10:art,com,edu,gob,gov,mil,net,org,sld,web),dz(8:com,org,net,gov,edu,asso,pol,art),ec(12:com,info,net,fin,k12,med,pro,org,edu,gov,gob,mil),edu,ee(10:edu,gov,riik,lib,med,com,pri,aip,org,fie),eg(9:com,edu,eun,gov,mil,name,net,org,sci),er(1:*),es(5:com(1:blogspot),nom,org,gob,edu),et(1:*),eu,fi(3:aland,blogspot,iki),fj(1:*),fk(1:*),fm,fo,fr(24:com,asso,nom,prd,presse,tm,aeroport,assedic,avocat,avoues,cci,chambagri,chirurgiens-dentistes,experts-comptables,geometre-expert,gouv,greta,huissier-justice,medecin,notaires,pharmacien,port,veterinaire,blogspot),ga,gd,ge(7:com,edu,gov,org,mil,net,pvt),gf,gg(5:co,org,net,sch,gov),gh(5:com,edu,gov,org,mil),gi(6:com,ltd,gov,mod,edu,org),gl,gm,gn(6:ac,com,edu,gov,org,net),gov,gp(6:com,net,mobi,edu,org,asso),gq,gr(6:com,edu,net,org,gov,blogspot),gs,gt(7:com,edu,gob,ind,mil,net,org),gu(1:*),gw,gy(3:co,com,net),hk(22:com,edu,gov,idv,net,org,公司,教育,敎育,政府,個人,个人,箇人,網络,网络,组織,網絡,网絡,组织,組織,組织,blogspot),hm,hn(6:com,edu,org,net,mil,gob),hr(4:iz,from,name,com),ht(17:com,shop,firm,info,adult,net,pro,org,med,art,coop,pol,asso,edu,rel,gouv,perso),hu(32:co,info,org,priv,sport,tm,2000,agrar,bolt,casino,city,erotica,erotika,film,forum,games,hotel,ingatlan,jogasz,konyvelo,lakas,media,news,reklam,sex,shop,suli,szex,tozsde,utazas,video,blogspot),id(8:ac,co,go,mil,net,or,sch,web),ie(2:gov,blogspot),il(2:*,co(1:blogspot)),im(6:co(2:ltd,plc),net,gov,org,nic,ac),in(13:co,firm,net,org,gen,ind,nic,ac,edu,res,gov,mil,blogspot),info(10:dyndns,barrel-of-knowledge,barrell-of-knowledge,for-our,groks-the,groks-this,here-for-more,knowsitall,selfip,webhop),int(1:eu),io(1:com),iq(6:gov,edu,mil,com,org,net),ir(9:ac,co,gov,id,net,org,sch,ایران,ايران),is(6:net,com,edu,gov,org,int),it(278:gov,edu,agrigento,ag,alessandria,al,ancona,an,aosta,aoste,ao,arezzo,ar,ascoli-piceno,ascolipiceno,ap,asti,at,avellino,av,bari,ba,andria-barletta-trani,andriabarlettatrani,trani-barletta-andria,tranibarlettaandria,barletta-trani-andria,barlettatraniandria,andria-trani-barletta,andriatranibarletta,trani-andria-barletta,traniandriabarletta,bt,belluno,bl,benevento,bn,bergamo,bg,biella,bi,bologna,bo,bolzano,bozen,balsan,alto-adige,altoadige,suedtirol,bz,brescia,bs,brindisi,br,cagliari,ca,caltanissetta,cl,campobasso,cb,carboniaiglesias,carbonia-iglesias,iglesias-carbonia,iglesiascarbonia,ci,caserta,ce,catania,ct,catanzaro,cz,chieti,ch,como,co,cosenza,cs,cremona,cr,crotone,kr,cuneo,cn,dell-ogliastra,dellogliastra,ogliastra,og,enna,en,ferrara,fe,fermo,fm,firenze,florence,fi,foggia,fg,forli-cesena,forlicesena,cesena-forli,cesenaforli,fc,frosinone,fr,genova,genoa,ge,gorizia,go,grosseto,gr,imperia,im,isernia,is,laquila,aquila,aq,la-spezia,laspezia,sp,latina,lt,lecce,le,lecco,lc,livorno,li,lodi,lo,lucca,lu,macerata,mc,mantova,mn,massa-carrara,massacarrara,carrara-massa,carraramassa,ms,matera,mt,medio-campidano,mediocampidano,campidano-medio,campidanomedio,vs,messina,me,milano,milan,mi,modena,mo,monza,monza-brianza,monzabrianza,monzaebrianza,monzaedellabrianza,monza-e-della-brianza,mb,napoli,naples,na,novara,no,nuoro,nu,oristano,or,padova,padua,pd,palermo,pa,parma,pr,pavia,pv,perugia,pg,pescara,pe,pesaro-urbino,pesarourbino,urbino-pesaro,urbinopesaro,pu,piacenza,pc,pisa,pi,pistoia,pt,pordenone,pn,potenza,pz,prato,po,ragusa,rg,ravenna,ra,reggio-calabria,reggiocalabria,rc,reggio-emilia,reggioemilia,re,rieti,ri,rimini,rn,roma,rome,rm,rovigo,ro,salerno,sa,sassari,ss,savona,sv,siena,si,siracusa,sr,sondrio,so,taranto,ta,tempio-olbia,tempioolbia,olbia-tempio,olbiatempio,ot,teramo,te,terni,tr,torino,turin,to,trapani,tp,trento,trentino,tn,treviso,tv,trieste,ts,udine,ud,varese,va,venezia,venice,ve,verbania,vb,vercelli,vc,verona,vr,vibo-valentia,vibovalentia,vv,vicenza,vi,viterbo,vt,blogspot),je(5:co,org,net,sch,gov),jm(1:*),jo(8:com,org,net,edu,sch,gov,mil,name),jobs,jp(64:ac,ad,co,ed,go,gr,lg,ne,or,aichi(53:aisai,ama,anjo,asuke,chiryu,chita,fuso,gamagori,handa,hazu,hekinan,higashiura,ichinomiya,inazawa,inuyama,isshiki,iwakura,kanie,kariya,kasugai,kira,kiyosu,komaki,konan,kota,mihama,miyoshi,nagakute,nishio,nisshin,obu,oguchi,oharu,okazaki,owariasahi,seto,shikatsu,shinshiro,shitara,tahara,takahama,tobishima,toei,togo,tokai,tokoname,toyoake,toyohashi,toyokawa,toyone,toyota,tsushima,yatomi),akita(28:akita,daisen,fujisato,gojome,hachirogata,happou,higashinaruse,honjo,honjyo,ikawa,kamikoani,kamioka,katagami,kazuno,kitaakita,kosaka,kyowa,misato,mitane,moriyoshi,nikaho,noshiro,odate,oga,ogata,semboku,yokote,yurihonjo),aomori(22:aomori,gonohe,hachinohe,hashikami,hiranai,hirosaki,itayanagi,kuroishi,misawa,mutsu,nakadomari,noheji,oirase,owani,rokunohe,sannohe,shichinohe,shingo,takko,towada,tsugaru,tsuruta),chiba(58:abiko,asahi,chonan,chosei,choshi,chuo,funabashi,futtsu,hanamigawa,ichihara,ichikawa,ichinomiya,inzai,isumi,kamagaya,kamogawa,kashiwa,katori,katsuura,kimitsu,kisarazu,kozaki,kujukuri,kyonan,matsudo,midori,mihama,minamiboso,mobara,mutsuzawa,nagara,nagareyama,narashino,narita,noda,oamishirasato,omigawa,onjuku,otaki,sakae,sakura,shimofusa,shirako,shiroi,shisui,sodegaura,sosa,tako,tateyama,togane,tohnosho,tomisato,urayasu,yachimata,yachiyo,yokaichiba,yokoshibahikari,yotsukaido),ehime(22:ainan,honai,ikata,imabari,iyo,kamijima,kihoku,kumakogen,masaki,matsuno,matsuyama,namikata,niihama,ozu,saijo,seiyo,shikokuchuo,tobe,toon,uchiko,uwajima,yawatahama),fukui(15:echizen,eiheiji,fukui,ikeda,katsuyama,mihama,minamiechizen,obama,ohi,ono,sabae,sakai,takahama,tsuruga,wakasa),fukuoka(63:ashiya,buzen,chikugo,chikuho,chikujo,chikushino,chikuzen,chuo,dazaifu,fukuchi,hakata,higashi,hirokawa,hisayama,iizuka,inatsuki,kaho,kasuga,kasuya,kawara,keisen,koga,kurate,kurogi,kurume,minami,miyako,miyama,miyawaka,mizumaki,munakata,nakagawa,nakama,nishi,nogata,ogori,okagaki,okawa,oki,omuta,onga,onojo,oto,saigawa,sasaguri,shingu,shinyoshitomi,shonai,soeda,sue,tachiarai,tagawa,takata,toho,toyotsu,tsuiki,ukiha,umi,usui,yamada,yame,yanagawa,yukuhashi),fukushima(51:aizubange,aizumisato,aizuwakamatsu,asakawa,bandai,date,fukushima,furudono,futaba,hanawa,higashi,hirata,hirono,iitate,inawashiro,ishikawa,iwaki,izumizaki,kagamiishi,kaneyama,kawamata,kitakata,kitashiobara,koori,koriyama,kunimi,miharu,mishima,namie,nango,nishiaizu,nishigo,okuma,omotego,ono,otama,samegawa,shimogo,shirakawa,showa,soma,sukagawa,taishin,tamakawa,tanagura,tenei,yabuki,yamato,yamatsuri,yanaizu,yugawa),gifu(38:anpachi,ena,gifu,ginan,godo,gujo,hashima,hichiso,hida,higashishirakawa,ibigawa,ikeda,kakamigahara,kani,kasahara,kasamatsu,kawaue,kitagata,mino,minokamo,mitake,mizunami,motosu,nakatsugawa,ogaki,sakahogi,seki,sekigahara,shirakawa,tajimi,takayama,tarui,toki,tomika,wanouchi,yamagata,yaotsu,yoro),gunma(36:annaka,chiyoda,fujioka,higashiagatsuma,isesaki,itakura,kanna,kanra,katashina,kawaba,kiryu,kusatsu,maebashi,meiwa,midori,minakami,naganohara,nakanojo,nanmoku,numata,oizumi,ora,ota,shibukawa,shimonita,shinto,showa,takasaki,takayama,tamamura,tatebayashi,tomioka,tsukiyono,tsumagoi,ueno,yoshioka),hiroshima(25:asaminami,daiwa,etajima,fuchu,fukuyama,hatsukaichi,higashihiroshima,hongo,jinsekikogen,kaita,kui,kumano,kure,mihara,miyoshi,naka,onomichi,osakikamijima,otake,saka,sera,seranishi,shinichi,shobara,takehara),hokkaido(142:abashiri,abira,aibetsu,akabira,akkeshi,asahikawa,ashibetsu,ashoro,assabu,atsuma,bibai,biei,bifuka,bihoro,biratori,chippubetsu,chitose,date,ebetsu,embetsu,eniwa,erimo,esan,esashi,fukagawa,fukushima,furano,furubira,haboro,hakodate,hamatonbetsu,hidaka,higashikagura,higashikawa,hiroo,hokuryu,hokuto,honbetsu,horokanai,horonobe,ikeda,imakane,ishikari,iwamizawa,iwanai,kamifurano,kamikawa,kamishihoro,kamisunagawa,kamoenai,kayabe,kembuchi,kikonai,kimobetsu,kitahiroshima,kitami,kiyosato,koshimizu,kunneppu,kuriyama,kuromatsunai,kushiro,kutchan,kyowa,mashike,matsumae,mikasa,minamifurano,mombetsu,moseushi,mukawa,muroran,naie,nakagawa,nakasatsunai,nakatombetsu,nanae,nanporo,nayoro,nemuro,niikappu,niki,nishiokoppe,noboribetsu,numata,obihiro,obira,oketo,okoppe,otaru,otobe,otofuke,otoineppu,oumu,ozora,pippu,rankoshi,rebun,rikubetsu,rishiri,rishirifuji,saroma,sarufutsu,shakotan,shari,shibecha,shibetsu,shikabe,shikaoi,shimamaki,shimizu,shimokawa,shinshinotsu,shintoku,shiranuka,shiraoi,shiriuchi,sobetsu,sunagawa,taiki,takasu,takikawa,takinoue,teshikaga,tobetsu,tohma,tomakomai,tomari,toya,toyako,toyotomi,toyoura,tsubetsu,tsukigata,urakawa,urausu,uryu,utashinai,wakkanai,wassamu,yakumo,yoichi),hyogo(46:aioi,akashi,ako,amagasaki,aogaki,asago,ashiya,awaji,fukusaki,goshiki,harima,himeji,ichikawa,inagawa,itami,kakogawa,kamigori,kamikawa,kasai,kasuga,kawanishi,miki,minamiawaji,nishinomiya,nishiwaki,ono,sanda,sannan,sasayama,sayo,shingu,shinonsen,shiso,sumoto,taishi,taka,takarazuka,takasago,takino,tamba,tatsuno,toyooka,yabu,yashiro,yoka,yokawa),ibaraki(51:ami,asahi,bando,chikusei,daigo,fujishiro,hitachi,hitachinaka,hitachiomiya,hitachiota,ibaraki,ina,inashiki,itako,iwama,joso,kamisu,kasama,kashima,kasumigaura,koga,miho,mito,moriya,naka,namegata,oarai,ogawa,omitama,ryugasaki,sakai,sakuragawa,shimodate,shimotsuma,shirosato,sowa,suifu,takahagi,tamatsukuri,tokai,tomobe,tone,toride,tsuchiura,tsukuba,uchihara,ushiku,yachiyo,yamagata,yawara,yuki),ishikawa(19:anamizu,hakui,hakusan,kaga,kahoku,kanazawa,kawakita,komatsu,nakanoto,nanao,nomi,nonoichi,noto,shika,suzu,tsubata,tsurugi,uchinada,wajima),iwate(35:fudai,fujisawa,hanamaki,hiraizumi,hirono,ichinohe,ichinoseki,iwaizumi,iwate,joboji,kamaishi,kanegasaki,karumai,kawai,kitakami,kuji,kunohe,kuzumaki,miyako,mizusawa,morioka,ninohe,noda,ofunato,oshu,otsuchi,rikuzentakata,shiwa,shizukuishi,sumita,takizawa,tanohata,tono,yahaba,yamada),kagawa(15:ayagawa,higashikagawa,kanonji,kotohira,manno,marugame,mitoyo,naoshima,sanuki,tadotsu,takamatsu,tonosho,uchinomi,utazu,zentsuji),kagoshima(20:akune,amami,hioki,isa,isen,izumi,kagoshima,kanoya,kawanabe,kinko,kouyama,makurazaki,matsumoto,minamitane,nakatane,nishinoomote,satsumasendai,soo,tarumizu,yusui),kanagawa(30:aikawa,atsugi,ayase,chigasaki,ebina,fujisawa,hadano,hakone,hiratsuka,isehara,kaisei,kamakura,kiyokawa,matsuda,minamiashigara,miura,nakai,ninomiya,odawara,oi,oiso,sagamihara,samukawa,tsukui,yamakita,yamato,yokosuka,yugawara,zama,zushi),kochi(31:aki,geisei,hidaka,higashitsuno,ino,kagami,kami,kitagawa,kochi,mihara,motoyama,muroto,nahari,nakamura,nankoku,nishitosa,niyodogawa,ochi,okawa,otoyo,otsuki,sakawa,sukumo,susaki,tosa,tosashimizu,toyo,tsuno,umaji,yasuda,yusuhara),kumamoto(26:amakusa,arao,aso,choyo,gyokuto,hitoyoshi,kamiamakusa,kashima,kikuchi,kosa,kumamoto,mashiki,mifune,minamata,minamioguni,nagasu,nishihara,oguni,ozu,sumoto,takamori,uki,uto,yamaga,yamato,yatsushiro),kyoto(31:ayabe,fukuchiyama,higashiyama,ide,ine,joyo,kameoka,kamo,kita,kizu,kumiyama,kyotamba,kyotanabe,kyotango,maizuru,minami,minamiyamashiro,miyazu,muko,nagaokakyo,nakagyo,nantan,oyamazaki,sakyo,seika,tanabe,uji,ujitawara,wazuka,yamashina,yawata),mie(30:asahi,inabe,ise,kameyama,kawagoe,kiho,kisosaki,kiwa,komono,kumano,kuwana,matsusaka,meiwa,mihama,minamiise,misugi,miyama,nabari,shima,suzuka,tado,taiki,taki,tamaki,toba,tsu,udono,ureshino,watarai,yokkaichi),miyagi(33:furukawa,higashimatsushima,ishinomaki,iwanuma,kakuda,kami,kawasaki,kesennuma,marumori,matsushima,minamisanriku,misato,murata,natori,ogawara,ohira,onagawa,osaki,rifu,semine,shibata,shichikashuku,shikama,shiogama,shiroishi,tagajo,taiwa,tome,tomiya,wakuya,watari,yamamoto,zao),miyazaki(27:aya,ebino,gokase,hyuga,kadogawa,kawaminami,kijo,kitagawa,kitakata,kitaura,kobayashi,kunitomi,kushima,mimata,miyakonojo,miyazaki,morotsuka,nichinan,nishimera,nobeoka,saito,shiiba,shintomi,takaharu,takanabe,takazaki,tsuno),nagano(75:achi,agematsu,anan,aoki,asahi,azumino,chikuhoku,chikuma,chino,fujimi,hakuba,hara,hiraya,iida,iijima,iiyama,iizuna,ikeda,ikusaka,ina,karuizawa,kawakami,kiso,kisofukushima,kitaaiki,komagane,komoro,matsukawa,matsumoto,miasa,minamiaiki,minamimaki,minamiminowa,minowa,miyada,miyota,mochizuki,nagano,nagawa,nagiso,nakagawa,nakano,nozawaonsen,obuse,ogawa,okaya,omachi,omi,ookuwa,ooshika,otaki,otari,sakae,sakaki,saku,sakuho,shimosuwa,shinanomachi,shiojiri,suwa,suzaka,takagi,takamori,takayama,tateshina,tatsuno,togakushi,togura,tomi,ueda,wada,yamagata,yamanouchi,yasaka,yasuoka),nagasaki(22:chijiwa,futsu,goto,hasami,hirado,iki,isahaya,kawatana,kuchinotsu,matsuura,nagasaki,obama,omura,oseto,saikai,sasebo,seihi,shimabara,shinkamigoto,togitsu,tsushima,unzen),nara(38:ando,gose,heguri,higashiyoshino,ikaruga,ikoma,kamikitayama,kanmaki,kashiba,kashihara,katsuragi,kawai,kawakami,kawanishi,koryo,kurotaki,mitsue,miyake,nara,nosegawa,oji,ouda,oyodo,sakurai,sango,shimoichi,shimokitayama,shinjo,soni,takatori,tawaramoto,tenkawa,tenri,uda,yamatokoriyama,yamatotakada,yamazoe,yoshino),niigata(34:aga,agano,gosen,itoigawa,izumozaki,joetsu,kamo,kariwa,kashiwazaki,minamiuonuma,mitsuke,muika,murakami,myoko,nagaoka,niigata,ojiya,omi,sado,sanjo,seiro,seirou,sekikawa,shibata,tagami,tainai,tochio,tokamachi,tsubame,tsunan,uonuma,yahiko,yoita,yuzawa),oita(19:beppu,bungoono,bungotakada,hasama,hiji,himeshima,hita,kamitsue,kokonoe,kuju,kunisaki,kusu,oita,saiki,taketa,tsukumi,usa,usuki,yufu),okayama(26:akaiwa,asakuchi,bizen,hayashima,ibara,kagamino,kasaoka,kibichuo,kumenan,kurashiki,maniwa,misaki,nagi,niimi,nishiawakura,okayama,satosho,setouchi,shinjo,shoo,soja,takahashi,tamano,tsuyama,wake,yakage),okinawa(42:aguni,ginowan,ginoza,gushikami,haebaru,higashi,hirara,iheya,ishigaki,ishikawa,itoman,izena,kadena,kin,kitadaito,kitanakagusuku,kumejima,kunigami,minamidaito,motobu,nago,naha,nakagusuku,nakijin,nanjo,nishihara,ogimi,okinawa,onna,shimoji,taketomi,tarama,tokashiki,tomigusuku,tonaki,urasoe,uruma,yaese,yomitan,yonabaru,yonaguni,zamami),osaka(50:abeno,chihayaakasaka,chuo,daito,fujiidera,habikino,hannan,higashiosaka,higashisumiyoshi,higashiyodogawa,hirakata,ibaraki,ikeda,izumi,izumiotsu,izumisano,kadoma,kaizuka,kanan,kashiwara,katano,kawachinagano,kishiwada,kita,kumatori,matsubara,minato,minoh,misaki,moriguchi,neyagawa,nishi,nose,osakasayama,sakai,sayama,sennan,settsu,shijonawate,shimamoto,suita,tadaoka,taishi,tajiri,takaishi,takatsuki,tondabayashi,toyonaka,toyono,yao),saga(26:ariake,arita,fukudomi,genkai,hamatama,hizen,imari,kamimine,kanzaki,karatsu,kashima,kitagata,kitahata,kiyama,kouhoku,kyuragi,nishiarita,ogi,omachi,ouchi,saga,shiroishi,taku,tara,tosu,yoshinogari),saitama(69:arakawa,asaka,chichibu,fujimi,fujimino,fukaya,hanno,hanyu,hasuda,hatogaya,hatoyama,hidaka,higashichichibu,higashimatsuyama,honjo,ina,iruma,iwatsuki,kamiizumi,kamikawa,kamisato,kasukabe,kawagoe,kawaguchi,kawajima,kazo,kitamoto,koshigaya,kounosu,kuki,kumagaya,matsubushi,minano,misato,miyashiro,miyoshi,moroyama,nagatoro,namegawa,niiza,ogano,ogawa,ogose,okegawa,omiya,otaki,ranzan,ryokami,saitama,sakado,satte,sayama,shiki,shiraoka,soka,sugito,toda,tokigawa,tokorozawa,tsurugashima,urawa,warabi,yashio,yokoze,yono,yorii,yoshida,yoshikawa,yoshimi),shiga(23:aisho,gamo,higashiomi,hikone,koka,konan,kosei,koto,kusatsu,maibara,moriyama,nagahama,nishiazai,notogawa,omihachiman,otsu,ritto,ryuoh,takashima,takatsuki,torahime,toyosato,yasu),shimane(23:akagi,ama,gotsu,hamada,higashiizumo,hikawa,hikimi,izumo,kakinoki,masuda,matsue,misato,nishinoshima,ohda,okinoshima,okuizumo,shimane,tamayu,tsuwano,unnan,yakumo,yasugi,yatsuka),shizuoka(36:arai,atami,fuji,fujieda,fujikawa,fujinomiya,fukuroi,gotemba,haibara,hamamatsu,higashiizu,ito,iwata,izu,izunokuni,kakegawa,kannami,kawanehon,kawazu,kikugawa,kosai,makinohara,matsuzaki,minamiizu,mishima,morimachi,nishiizu,numazu,omaezaki,shimada,shimizu,shimoda,shizuoka,susono,yaizu,yoshida),tochigi(31:ashikaga,bato,haga,ichikai,iwafune,kaminokawa,kanuma,karasuyama,kuroiso,mashiko,mibu,moka,motegi,nasu,nasushiobara,nikko,nishikata,nogi,ohira,ohtawara,oyama,sakura,sano,shimotsuke,shioya,takanezawa,tochigi,tsuga,ujiie,utsunomiya,yaita),tokushima(17:aizumi,anan,ichiba,itano,kainan,komatsushima,matsushige,mima,minami,miyoshi,mugi,nakagawa,naruto,sanagochi,shishikui,tokushima,wajiki),tokyo(57:adachi,akiruno,akishima,aogashima,arakawa,bunkyo,chiyoda,chofu,chuo,edogawa,fuchu,fussa,hachijo,hachioji,hamura,higashikurume,higashimurayama,higashiyamato,hino,hinode,hinohara,inagi,itabashi,katsushika,kita,kiyose,kodaira,koganei,kokubunji,komae,koto,kouzushima,kunitachi,machida,meguro,minato,mitaka,mizuho,musashimurayama,musashino,nakano,nerima,ogasawara,okutama,ome,oshima,ota,setagaya,shibuya,shinagawa,shinjuku,suginami,sumida,tachikawa,taito,tama,toshima),tottori(13:chizu,hino,kawahara,koge,kotoura,misasa,nanbu,nichinan,sakaiminato,tottori,wakasa,yazu,yonago),toyama(24:asahi,fuchu,fukumitsu,funahashi,himi,imizu,inami,johana,kamiichi,kurobe,nakaniikawa,namerikawa,nanto,nyuzen,oyabe,taira,takaoka,tateyama,toga,tonami,toyama,unazuki,uozu,yamada),wakayama(29:arida,aridagawa,gobo,hashimoto,hidaka,hirogawa,inami,iwade,kainan,kamitonda,katsuragi,kimino,kinokawa,kitayama,koya,koza,kozagawa,kudoyama,kushimoto,mihama,misato,nachikatsuura,shingu,shirahama,taiji,tanabe,wakayama,yuasa,yura),yamagata(34:asahi,funagata,higashine,iide,kahoku,kaminoyama,kaneyama,kawanishi,mamurogawa,mikawa,murayama,nagai,nakayama,nanyo,nishikawa,obanazawa,oe,oguni,ohkura,oishida,sagae,sakata,sakegawa,shinjo,shirataka,shonai,takahata,tendo,tozawa,tsuruoka,yamagata,yamanobe,yonezawa,yuza),yamaguchi(16:abu,hagi,hikari,hofu,iwakuni,kudamatsu,mitou,nagato,oshima,shimonoseki,shunan,tabuse,tokuyama,toyota,ube,yuu),yamanashi(28:chuo,doshi,fuefuki,fujikawa,fujikawaguchiko,fujiyoshida,hayakawa,hokuto,ichikawamisato,kai,kofu,koshu,kosuge,minami-alps,minobu,nakamichi,nanbu,narusawa,nirasaki,nishikatsura,oshino,otsuki,showa,tabayama,tsuru,uenohara,yamanakako,yamanashi),kawasaki(2:*,city(1:!)),kitakyushu(2:*,city(1:!)),kobe(2:*,city(1:!)),nagoya(2:*,city(1:!)),sapporo(2:*,city(1:!)),sendai(2:*,city(1:!)),yokohama(2:*,city(1:!)),blogspot),ke(1:*),kg(6:org,net,com,edu,gov,mil),kh(1:*),ki(7:edu,biz,net,org,gov,info,com),km(17:org,nom,gov,prd,tm,edu,mil,ass,com,coop,asso,presse,medecin,notaires,pharmaciens,veterinaire,gouv),kn(4:net,org,edu,gov),kp(6:com,edu,gov,org,rep,tra),kr(30:ac,co,es,go,hs,kg,mil,ms,ne,or,pe,re,sc,busan,chungbuk,chungnam,daegu,daejeon,gangwon,gwangju,gyeongbuk,gyeonggi,gyeongnam,incheon,jeju,jeonbuk,jeonnam,seoul,ulsan,blogspot),kw(1:*),ky(5:edu,gov,com,org,net),kz(6:org,edu,net,gov,mil,com),la(9:int,net,info,edu,gov,per,com,org,c),lb(5:com,edu,gov,net,org),lc(6:com,net,co,org,edu,gov),li,lk(14:gov,sch,net,int,com,org,edu,ngo,soc,web,ltd,assn,grp,hotel),lr(5:com,edu,gov,org,net),ls(2:co,org),lt(1:gov),lu,lv(9:com,edu,gov,org,mil,id,net,asn,conf),ly(9:com,net,gov,plc,edu,sch,med,org,id),ma(6:co,net,gov,org,ac,press),mc(2:tm,asso),md,me(8:co,net,org,edu,ac,gov,its,priv),mg(8:org,nom,gov,prd,tm,edu,mil,com),mh,mil,mk(7:com,org,net,edu,gov,inf,name),ml(7:com,edu,gouv,gov,net,org,presse),mm(1:*),mn(3:gov,edu,org),mo(5:com,net,org,edu,gov),mobi,mp,mq,mr(2:gov,blogspot),ms,mt(1:*),mu(7:com,net,org,gov,ac,co,or),museum(548:academy,agriculture,air,airguard,alabama,alaska,amber,ambulance,american,americana,americanantiques,americanart,amsterdam,and,annefrank,anthro,anthropology,antiques,aquarium,arboretum,archaeological,archaeology,architecture,art,artanddesign,artcenter,artdeco,arteducation,artgallery,arts,artsandcrafts,asmatart,assassination,assisi,association,astronomy,atlanta,austin,australia,automotive,aviation,axis,badajoz,baghdad,bahn,bale,baltimore,barcelona,baseball,basel,baths,bauern,beauxarts,beeldengeluid,bellevue,bergbau,berkeley,berlin,bern,bible,bilbao,bill,birdart,birthplace,bonn,boston,botanical,botanicalgarden,botanicgarden,botany,brandywinevalley,brasil,bristol,british,britishcolumbia,broadcast,brunel,brussel,brussels,bruxelles,building,burghof,bus,bushey,cadaques,california,cambridge,can,canada,capebreton,carrier,cartoonart,casadelamoneda,castle,castres,celtic,center,chattanooga,cheltenham,chesapeakebay,chicago,children,childrens,childrensgarden,chiropractic,chocolate,christiansburg,cincinnati,cinema,circus,civilisation,civilization,civilwar,clinton,clock,coal,coastaldefence,cody,coldwar,collection,colonialwilliamsburg,coloradoplateau,columbia,columbus,communication,communications,community,computer,computerhistory,comunicações,contemporary,contemporaryart,convent,copenhagen,corporation,correios-e-telecomunicações,corvette,costume,countryestate,county,crafts,cranbrook,creation,cultural,culturalcenter,culture,cyber,cymru,dali,dallas,database,ddr,decorativearts,delaware,delmenhorst,denmark,depot,design,detroit,dinosaur,discovery,dolls,donostia,durham,eastafrica,eastcoast,education,educational,egyptian,eisenbahn,elburg,elvendrell,embroidery,encyclopedic,england,entomology,environment,environmentalconservation,epilepsy,essex,estate,ethnology,exeter,exhibition,family,farm,farmequipment,farmers,farmstead,field,figueres,filatelia,film,fineart,finearts,finland,flanders,florida,force,fortmissoula,fortworth,foundation,francaise,frankfurt,franziskaner,freemasonry,freiburg,fribourg,frog,fundacio,furniture,gallery,garden,gateway,geelvinck,gemological,geology,georgia,giessen,glas,glass,gorge,grandrapids,graz,guernsey,halloffame,hamburg,handson,harvestcelebration,hawaii,health,heimatunduhren,hellas,helsinki,hembygdsforbund,heritage,histoire,historical,historicalsociety,historichouses,historisch,historisches,history,historyofscience,horology,house,humanities,illustration,imageandsound,indian,indiana,indianapolis,indianmarket,intelligence,interactive,iraq,iron,isleofman,jamison,jefferson,jerusalem,jewelry,jewish,jewishart,jfk,journalism,judaica,judygarland,juedisches,juif,karate,karikatur,kids,koebenhavn,koeln,kunst,kunstsammlung,kunstunddesign,labor,labour,lajolla,lancashire,landes,lans,läns,larsson,lewismiller,lincoln,linz,living,livinghistory,localhistory,london,losangeles,louvre,loyalist,lucerne,luxembourg,luzern,mad,madrid,mallorca,manchester,mansion,mansions,manx,marburg,maritime,maritimo,maryland,marylhurst,media,medical,medizinhistorisches,meeres,memorial,mesaverde,michigan,midatlantic,military,mill,miners,mining,minnesota,missile,missoula,modern,moma,money,monmouth,monticello,montreal,moscow,motorcycle,muenchen,muenster,mulhouse,muncie,museet,museumcenter,museumvereniging,music,national,nationalfirearms,nationalheritage,nativeamerican,naturalhistory,naturalhistorymuseum,naturalsciences,nature,naturhistorisches,natuurwetenschappen,naumburg,naval,nebraska,neues,newhampshire,newjersey,newmexico,newport,newspaper,newyork,niepce,norfolk,north,nrw,nuernberg,nuremberg,nyc,nyny,oceanographic,oceanographique,omaha,online,ontario,openair,oregon,oregontrail,otago,oxford,pacific,paderborn,palace,paleo,palmsprings,panama,paris,pasadena,pharmacy,philadelphia,philadelphiaarea,philately,phoenix,photography,pilots,pittsburgh,planetarium,plantation,plants,plaza,portal,portland,portlligat,posts-and-telecommunications,preservation,presidio,press,project,public,pubol,quebec,railroad,railway,research,resistance,riodejaneiro,rochester,rockart,roma,russia,saintlouis,salem,salvadordali,salzburg,sandiego,sanfrancisco,santabarbara,santacruz,santafe,saskatchewan,satx,savannahga,schlesisches,schoenbrunn,schokoladen,school,schweiz,science,scienceandhistory,scienceandindustry,sciencecenter,sciencecenters,science-fiction,sciencehistory,sciences,sciencesnaturelles,scotland,seaport,settlement,settlers,shell,sherbrooke,sibenik,silk,ski,skole,society,sologne,soundandvision,southcarolina,southwest,space,spy,square,stadt,stalbans,starnberg,state,stateofdelaware,station,steam,steiermark,stjohn,stockholm,stpetersburg,stuttgart,suisse,surgeonshall,surrey,svizzera,sweden,sydney,tank,tcm,technology,telekommunikation,television,texas,textile,theater,time,timekeeping,topology,torino,touch,town,transport,tree,trolley,trust,trustee,uhren,ulm,undersea,university,usa,usantiques,usarts,uscountryestate,usculture,usdecorativearts,usgarden,ushistory,ushuaia,uslivinghistory,utah,uvic,valley,vantaa,versailles,viking,village,virginia,virtual,virtuel,vlaanderen,volkenkunde,wales,wallonie,war,washingtondc,watchandclock,watch-and-clock,western,westfalen,whaling,wildlife,williamsburg,windmill,workshop,york,yorkshire,yosemite,youth,zoological,zoology,ירושלים,иком),mv(14:aero,biz,com,coop,edu,gov,info,int,mil,museum,name,net,org,pro),mw(11:ac,biz,co,com,coop,edu,gov,int,museum,net,org),mx(6:com,org,gob,edu,net,blogspot),my(7:com,net,org,gov,edu,mil,name),mz(2:*,teledata(1:!)),na(17:info,pro,name,school,or,dr,us,mx,ca,in,cc,tv,ws,mobi,co,com,org),name(2:her(1:forgot),his(1:forgot)),nc(1:asso),ne,net(41:gb,hu,jp,se,uk,za,at-band-camp,blogdns,broke-it,buyshouses,dnsalias,dnsdojo,does-it,dontexist,dynalias,dynathome,endofinternet,from-az,from-co,from-la,from-ny,gets-it,ham-radio-op,homeftp,homeip,homelinux,homeunix,in-the-band,is-a-chef,is-a-geek,isa-geek,kicks-ass,office-on-the,podzone,scrapper-site,selfip,sells-it,servebbs,serveftp,thruhere,webhop),nf(10:com,net,per,rec,web,arts,firm,info,other,store),ng(6:ac,com,edu,gov,net,org),ni(1:*),nl(3:bv,blogspot,co),no(726:fhs,vgs,fylkesbibl,folkebibl,museum,idrett,priv,mil,stat,dep,kommune,herad,aa(1:gs),ah(1:gs),bu(1:gs),fm(1:gs),hl(1:gs),hm(1:gs),jan-mayen(1:gs),mr(1:gs),nl(1:gs),nt(1:gs),of(1:gs),ol(1:gs),oslo(1:gs),rl(1:gs),sf(1:gs),st(1:gs),svalbard(1:gs),tm(1:gs),tr(1:gs),va(1:gs),vf(1:gs),akrehamn,åkrehamn,algard,ålgård,arna,brumunddal,bryne,bronnoysund,brønnøysund,drobak,drøbak,egersund,fetsund,floro,florø,fredrikstad,hokksund,honefoss,hønefoss,jessheim,jorpeland,jørpeland,kirkenes,kopervik,krokstadelva,langevag,langevåg,leirvik,mjondalen,mjøndalen,mo-i-rana,mosjoen,mosjøen,nesoddtangen,orkanger,osoyro,osøyro,raholt,råholt,sandnessjoen,sandnessjøen,skedsmokorset,slattum,spjelkavik,stathelle,stavern,stjordalshalsen,stjørdalshalsen,tananger,tranby,vossevangen,afjord,åfjord,agdenes,al,ål,alesund,ålesund,alstahaug,alta,áltá,alaheadju,álaheadju,alvdal,amli,åmli,amot,åmot,andebu,andoy,andøy,andasuolo,ardal,årdal,aremark,arendal,ås,aseral,åseral,asker,askim,askvoll,askoy,askøy,asnes,åsnes,audnedaln,aukra,aure,aurland,aurskog-holand,aurskog-høland,austevoll,austrheim,averoy,averøy,balestrand,ballangen,balat,bálát,balsfjord,bahccavuotna,báhccavuotna,bamble,bardu,beardu,beiarn,bajddar,bájddar,baidar,báidár,berg,bergen,berlevag,berlevåg,bearalvahki,bearalváhki,bindal,birkenes,bjarkoy,bjarkøy,bjerkreim,bjugn,bodo,bodø,badaddja,bådåddjå,budejju,bokn,bremanger,bronnoy,brønnøy,bygland,bykle,barum,bærum,telemark(2:bo,bø),nordland(4:bo,bø,heroy,herøy),bievat,bievát,bomlo,bømlo,batsfjord,båtsfjord,bahcavuotna,báhcavuotna,dovre,drammen,drangedal,dyroy,dyrøy,donna,dønna,eid,eidfjord,eidsberg,eidskog,eidsvoll,eigersund,elverum,enebakk,engerdal,etne,etnedal,evenes,evenassi,evenášši,evje-og-hornnes,farsund,fauske,fuossko,fuoisku,fedje,fet,finnoy,finnøy,fitjar,fjaler,fjell,flakstad,flatanger,flekkefjord,flesberg,flora,fla,flå,folldal,forsand,fosnes,frei,frogn,froland,frosta,frana,fræna,froya,frøya,fusa,fyresdal,forde,førde,gamvik,gangaviika,gáŋgaviika,gaular,gausdal,gildeskal,gildeskål,giske,gjemnes,gjerdrum,gjerstad,gjesdal,gjovik,gjøvik,gloppen,gol,gran,grane,granvin,gratangen,grimstad,grong,kraanghke,kråanghke,grue,gulen,hadsel,halden,halsa,hamar,hamaroy,habmer,hábmer,hapmir,hápmir,hammerfest,hammarfeasta,hámmárfeasta,haram,hareid,harstad,hasvik,aknoluokta,ákŋoluokta,hattfjelldal,aarborte,haugesund,hemne,hemnes,hemsedal,more-og-romsdal(2:heroy,sande),møre-og-romsdal(2:herøy,sande),hitra,hjartdal,hjelmeland,hobol,hobøl,hof,hol,hole,holmestrand,holtalen,holtålen,hornindal,horten,hurdal,hurum,hvaler,hyllestad,hagebostad,hægebostad,hoyanger,høyanger,hoylandet,høylandet,ha,hå,ibestad,inderoy,inderøy,iveland,jevnaker,jondal,jolster,jølster,karasjok,karasjohka,kárášjohka,karlsoy,galsa,gálsá,karmoy,karmøy,kautokeino,guovdageaidnu,klepp,klabu,klæbu,kongsberg,kongsvinger,kragero,kragerø,kristiansand,kristiansund,krodsherad,krødsherad,kvalsund,rahkkeravju,ráhkkerávju,kvam,kvinesdal,kvinnherad,kviteseid,kvitsoy,kvitsøy,kvafjord,kvæfjord,giehtavuoatna,kvanangen,kvænangen,navuotna,návuotna,kafjord,kåfjord,gaivuotna,gáivuotna,larvik,lavangen,lavagis,loabat,loabát,lebesby,davvesiida,leikanger,leirfjord,leka,leksvik,lenvik,leangaviika,leaŋgaviika,lesja,levanger,lier,lierne,lillehammer,lillesand,lindesnes,lindas,lindås,lom,loppa,lahppi,láhppi,lund,lunner,luroy,lurøy,luster,lyngdal,lyngen,ivgu,lardal,lerdal,lærdal,lodingen,lødingen,lorenskog,lørenskog,loten,løten,malvik,masoy,måsøy,muosat,muosát,mandal,marker,marnardal,masfjorden,meland,meldal,melhus,meloy,meløy,meraker,meråker,moareke,moåreke,midsund,midtre-gauldal,modalen,modum,molde,moskenes,moss,mosvik,malselv,målselv,malatvuopmi,málatvuopmi,namdalseid,aejrie,namsos,namsskogan,naamesjevuemie,nååmesjevuemie,laakesvuemie,nannestad,narvik,narviika,naustdal,nedre-eiker,akershus(1:nes),buskerud(1:nes),nesna,nesodden,nesseby,unjarga,unjárga,nesset,nissedal,nittedal,nord-aurdal,nord-fron,nord-odal,norddal,nordkapp,davvenjarga,davvenjárga,nordre-land,nordreisa,raisa,ráisa,nore-og-uvdal,notodden,naroy,nærøy,notteroy,nøtterøy,odda,oksnes,øksnes,oppdal,oppegard,oppegård,orkdal,orland,ørland,orskog,ørskog,orsta,ørsta,hedmark(3:os,valer,våler),hordaland(1:os),osen,osteroy,osterøy,ostre-toten,østre-toten,overhalla,ovre-eiker,øvre-eiker,oyer,øyer,oygarden,øygarden,oystre-slidre,øystre-slidre,porsanger,porsangu,porsáŋgu,porsgrunn,radoy,radøy,rakkestad,rana,ruovat,randaberg,rauma,rendalen,rennebu,rennesoy,rennesøy,rindal,ringebu,ringerike,ringsaker,rissa,risor,risør,roan,rollag,rygge,ralingen,rælingen,rodoy,rødøy,romskog,rømskog,roros,røros,rost,røst,royken,røyken,royrvik,røyrvik,rade,råde,salangen,siellak,saltdal,salat,sálát,sálat,samnanger,vestfold(1:sande),sandefjord,sandnes,sandoy,sandøy,sarpsborg,sauda,sauherad,sel,selbu,selje,seljord,sigdal,siljan,sirdal,skaun,skedsmo,ski,skien,skiptvet,skjervoy,skjervøy,skierva,skiervá,skjak,skjåk,skodje,skanland,skånland,skanit,skánit,smola,smøla,snillfjord,snasa,snåsa,snoasa,snaase,snåase,sogndal,sokndal,sola,solund,songdalen,sortland,spydeberg,stange,stavanger,steigen,steinkjer,stjordal,stjørdal,stokke,stor-elvdal,stord,stordal,storfjord,omasvuotna,strand,stranda,stryn,sula,suldal,sund,sunndal,surnadal,sveio,svelvik,sykkylven,sogne,søgne,somna,sømna,sondre-land,søndre-land,sor-aurdal,sør-aurdal,sor-fron,sør-fron,sor-odal,sør-odal,sor-varanger,sør-varanger,matta-varjjat,mátta-várjjat,sorfold,sørfold,sorreisa,sørreisa,sorum,sørum,tana,deatnu,time,tingvoll,tinn,tjeldsund,dielddanuorri,tjome,tjøme,tokke,tolga,torsken,tranoy,tranøy,tromso,tromsø,tromsa,romsa,trondheim,troandin,trysil,trana,træna,trogstad,trøgstad,tvedestrand,tydal,tynset,tysfjord,divtasvuodna,divttasvuotna,tysnes,tysvar,tysvær,tonsberg,tønsberg,ullensaker,ullensvang,ulvik,utsira,vadso,vadsø,cahcesuolo,čáhcesuolo,vaksdal,valle,vang,vanylven,vardo,vardø,varggat,várggát,vefsn,vaapste,vega,vegarshei,vegårshei,vennesla,verdal,verran,vestby,vestnes,vestre-slidre,vestre-toten,vestvagoy,vestvågøy,vevelstad,vik,vikna,vindafjord,volda,voss,varoy,værøy,vagan,vågan,voagat,vagsoy,vågsøy,vaga,vågå,ostfold(1:valer),østfold(1:våler),blogspot,co),np(1:*),nr(7:biz,info,gov,edu,org,net,com),nu(3:merseine,mine,shacknet),nz(2:*,co(1:blogspot)),om(11:*,mediaphone(1:!),nawrastelecom(1:!),nawras(1:!),omanmobile(1:!),omanpost(1:!),omantel(1:!),rakpetroleum(1:!),siemens(1:!),songfest(1:!),statecouncil(1:!)),org(53:ae,us,za,dyndns(2:go,home),blogdns,blogsite,boldlygoingnowhere,dnsalias,dnsdojo,doesntexist,dontexist,doomdns,dvrdns,dynalias,endofinternet,endoftheinternet,from-me,game-host,gotdns,hobby-site,homedns,homeftp,homelinux,homeunix,is-a-bruinsfan,is-a-candidate,is-a-celticsfan,is-a-chef,is-a-geek,is-a-knight,is-a-linux-user,is-a-patsfan,is-a-soxfan,is-found,is-lost,is-saved,is-very-bad,is-very-evil,is-very-good,is-very-nice,is-very-sweet,isa-geek,kicks-ass,misconfused,podzone,readmyblog,selfip,sellsyourhome,servebbs,serveftp,servegame,stuff-4-sale,webhop),pa(11:ac,gob,com,org,sld,edu,net,ing,abo,med,nom),pe(7:edu,gob,nom,mil,org,com,net),pf(3:com,org,edu),pg(1:*),ph(8:com,net,org,gov,edu,ngo,mil,i),pk(14:com,net,edu,org,fam,biz,web,gov,gob,gok,gon,gop,gos,info),pl(171:aid,agro,atm,auto,biz,com,edu,gmina,gsm,info,mail,miasta,media,mil,net,nieruchomosci,nom,org,pc,powiat,priv,realestate,rel,sex,shop,sklep,sos,szkola,targi,tm,tourism,travel,turystyka,6bone,art,mbone,gov(9:uw,um,ug,upow,starostwo,so,sr,po,pa),ngo,irc,usenet,augustow,babia-gora,bedzin,beskidy,bialowieza,bialystok,bielawa,bieszczady,boleslawiec,bydgoszcz,bytom,cieszyn,czeladz,czest,dlugoleka,elblag,elk,glogow,gniezno,gorlice,grajewo,ilawa,jaworzno,jelenia-gora,jgora,kalisz,kazimierz-dolny,karpacz,kartuzy,kaszuby,katowice,kepno,ketrzyn,klodzko,kobierzyce,kolobrzeg,konin,konskowola,kutno,lapy,lebork,legnica,lezajsk,limanowa,lomza,lowicz,lubin,lukow,malbork,malopolska,mazowsze,mazury,mielec,mielno,mragowo,naklo,nowaruda,nysa,olawa,olecko,olkusz,olsztyn,opoczno,opole,ostroda,ostroleka,ostrowiec,ostrowwlkp,pila,pisz,podhale,podlasie,polkowice,pomorze,pomorskie,prochowice,pruszkow,przeworsk,pulawy,radom,rawa-maz,rybnik,rzeszow,sanok,sejny,siedlce,slask,slupsk,sosnowiec,stalowa-wola,skoczow,starachowice,stargard,suwalki,swidnica,swiebodzin,swinoujscie,szczecin,szczytno,tarnobrzeg,tgory,turek,tychy,ustka,walbrzych,warmia,warszawa,waw,wegrow,wielun,wlocl,wloclawek,wodzislaw,wolomin,wroclaw,zachpomor,zagan,zarow,zgora,zgorzelec,gda,gdansk,gdynia,med,sopot,gliwice,krakow,poznan,wroc,zakopane,co),pm,pn(5:gov,co,org,edu,net),pr(13:com,net,org,gov,edu,isla,pro,biz,info,name,est,prof,ac),pro(7:aca,bar,cpa,jur,law,med,eng),ps(7:edu,gov,sec,plo,com,org,net),pt(9:net,gov,org,edu,int,publ,com,nome,blogspot),pw(6:co,ne,or,ed,go,belau),py(9:com,coop,edu,gov,mil,net,org,nic(1:!),una(1:!)),qa(8:com,edu,gov,mil,name,net,org,sch),re(4:com,asso,nom,blogspot),ro(12:com,org,tm,nt,nom,info,rec,arts,firm,store,www,blogspot),rs(6:co,org,edu,ac,gov,in),ru(133:ac,com,edu,int,net,org,pp,adygeya,altai,amur,arkhangelsk,astrakhan,bashkiria,belgorod,bir,bryansk,buryatia,cbg,chel,chelyabinsk,chita,chukotka,chuvashia,dagestan,dudinka,e-burg,grozny,irkutsk,ivanovo,izhevsk,jar,joshkar-ola,kalmykia,kaluga,kamchatka,karelia,kazan,kchr,kemerovo,khabarovsk,khakassia,khv,kirov,koenig,komi,kostroma,krasnoyarsk,kuban,kurgan,kursk,lipetsk,magadan,mari,mari-el,marine,mordovia,mosreg,msk,murmansk,nalchik,nnov,nov,novosibirsk,nsk,omsk,orenburg,oryol,palana,penza,perm,pskov,ptz,rnd,ryazan,sakhalin,samara,saratov,simbirsk,smolensk,spb,stavropol,stv,surgut,tambov,tatarstan,tom,tomsk,tsaritsyn,tsk,tula,tuva,tver,tyumen,udm,udmurtia,ulan-ude,vladikavkaz,vladimir,vladivostok,volgograd,vologda,voronezh,vrn,vyatka,yakutia,yamal,yaroslavl,yekaterinburg,yuzhno-sakhalinsk,amursk,baikal,cmw,fareast,jamal,kms,k-uralsk,kustanai,kuzbass,magnitka,mytis,nakhodka,nkz,norilsk,oskol,pyatigorsk,rubtsovsk,snz,syzran,vdonsk,zgrad,gov,mil,test),rw(9:gov,net,edu,ac,com,co,int,mil,gouv),sa(8:com,net,org,gov,med,pub,edu,sch),sb(5:com,edu,gov,net,org),sc(5:com,gov,net,org,edu),sd(8:com,net,org,edu,med,tv,gov,info),se(41:a,ac,b,bd,brand,c,d,e,f,fh,fhsk,fhv,g,h,i,k,komforb,kommunalforbund,komvux,l,lanbib,m,n,naturbruksgymn,o,org,p,parti,pp,press,r,s,sshn,t,tm,u,w,x,y,z,blogspot),sg(7:com,net,org,gov,edu,per,blogspot),sh(5:com,net,gov,org,mil),si,sk(1:blogspot),sl(5:com,net,edu,gov,org),sm,sn(7:art,com,edu,gouv,org,perso,univ),so(3:com,net,org),sr,st(12:co,com,consulado,edu,embaixada,gov,mil,net,org,principe,saotome,store),su,sv(1:*),sx(1:gov),sy(6:edu,gov,net,mil,com,org),sz(3:co,ac,org),tc,td(1:blogspot),tel,tf,tg,th(7:ac,co,go,in,mi,net,or),tj(15:ac,biz,co,com,edu,go,gov,int,mil,name,net,nic,org,test,web),tk,tl(1:gov),tm(8:com,co,org,net,nom,gov,mil,edu),tn(20:com,ens,fin,gov,ind,intl,nat,net,org,info,perso,tourism,edunet,rnrt,rns,rnu,mincom,agrinet,defense,turen),to(6:com,gov,net,org,edu,mil),tr(3:*,nic(1:!),nc(1:gov)),travel,tt(17:co,com,org,net,biz,info,pro,int,coop,jobs,mobi,travel,museum,aero,name,gov,edu),tv(4:dyndns,better-than,on-the-web,worse-than),tw(14:edu,gov,mil,com,net,org,idv,game,ebiz,club,網路,組織,商業,blogspot),tz(7:ac,co,go,mil,ne,or,sc),ua(78:com,edu,gov,in,net,org,cherkassy,cherkasy,chernigov,chernihiv,chernivtsi,chernovtsy,ck,cn,cr,crimea,cv,dn,dnepropetrovsk,dnipropetrovsk,dominic,donetsk,dp,if,ivano-frankivsk,kh,kharkiv,kharkov,kherson,khmelnitskiy,khmelnytskyi,kiev,kirovograd,km,kr,krym,ks,kv,kyiv,lg,lt,lugansk,lutsk,lv,lviv,mk,mykolaiv,nikolaev,od,odesa,odessa,pl,poltava,rivne,rovno,rv,sb,sebastopol,sevastopol,sm,sumy,te,ternopil,uz,uzhgorod,vinnica,vinnytsia,vn,volyn,yalta,zaporizhzhe,zaporizhzhia,zhitomir,zhytomyr,zp,zt,co,pp),ug(8:co,or,ac,sc,go,ne,com,org),uk(12:*,sch(1:*),bl(1:!),british-library(1:!),jet(1:!),mod(1:!),national-library-scotland(1:!),nel(1:!),nic(1:!),nls(1:!),parliament(1:!),co(1:blogspot)),us(63:dni,fed,isa,kids,nsn,ak(3:k12,cc,lib),al(3:k12,cc,lib),ar(3:k12,cc,lib),as(3:k12,cc,lib),az(3:k12,cc,lib),ca(3:k12,cc,lib),co(3:k12,cc,lib),ct(3:k12,cc,lib),dc(3:k12,cc,lib),de(3:k12,cc,lib),fl(3:k12,cc,lib),ga(3:k12,cc,lib),gu(3:k12,cc,lib),hi(2:cc,lib),ia(3:k12,cc,lib),id(3:k12,cc,lib),il(3:k12,cc,lib),in(3:k12,cc,lib),ks(3:k12,cc,lib),ky(3:k12,cc,lib),la(3:k12,cc,lib),ma(3:k12(3:pvt,chtr,paroch),cc,lib),md(3:k12,cc,lib),me(3:k12,cc,lib),mi(3:k12,cc,lib),mn(3:k12,cc,lib),mo(3:k12,cc,lib),ms(3:k12,cc,lib),mt(3:k12,cc,lib),nc(3:k12,cc,lib),nd(3:k12,cc,lib),ne(3:k12,cc,lib),nh(3:k12,cc,lib),nj(3:k12,cc,lib),nm(3:k12,cc,lib),nv(3:k12,cc,lib),ny(3:k12,cc,lib),oh(3:k12,cc,lib),ok(3:k12,cc,lib),or(3:k12,cc,lib),pa(3:k12,cc,lib),pr(3:k12,cc,lib),ri(3:k12,cc,lib),sc(3:k12,cc,lib),sd(3:k12,cc,lib),tn(3:k12,cc,lib),tx(3:k12,cc,lib),ut(3:k12,cc,lib),vi(3:k12,cc,lib),vt(3:k12,cc,lib),va(3:k12,cc,lib),wa(3:k12,cc,lib),wi(3:k12,cc,lib),wv(3:k12,cc,lib),wy(3:k12,cc,lib),is-by,land-4-sale,stuff-4-sale),uy(6:com,edu,gub,mil,net,org),uz(4:co,com,net,org),va,vc(6:com,net,org,gov,mil,edu),ve(10:co,com,e12,edu,gov,info,mil,net,org,web),vg,vi(5:co,com,k12,net,org),vn(12:com,net,org,edu,gov,int,ac,biz,info,name,pro,health),vu,wf,ws(7:com,net,org,gov,edu,dyndns,mypets),yt,امارات,বাংলা,中国,中國,الجزائر,مصر,გე,香港,भारत,بھارت,భారత్,ભારત,ਭਾਰਤ,ভারত,இந்தியா,ایران,ايران,الاردن,한국,ලංකා,இலங்கை,المغرب,عمان,فلسطين,срб,рф,قطر,السعودية,السعودیة,السعودیۃ,السعوديه,سورية,سوريا,新加坡,சிங்கப்பூர்,ไทย,تونس,台灣,台湾,臺灣,укр,اليمن,xxx,ye(1:*),za(1:*),zm(1:*),zw(1:*))
\ No newline at end of file
+root(310:ac(6:com,edu,gov,net,mil,org),ad(1:nom),ae(7:co,net,org,sch,ac,gov,mil),aero(89:accident-investigation,accident-prevention,aerobatic,aeroclub,aerodrome,agents,aircraft,airline,airport,air-surveillance,airtraffic,air-traffic-control,ambulance,amusement,association,author,ballooning,broker,caa,cargo,catering,certification,championship,charter,civilaviation,club,conference,consultant,consulting,control,council,crew,design,dgca,educator,emergency,engine,engineer,entertainment,equipment,exchange,express,federation,flight,freight,fuel,gliding,government,groundhandling,group,hanggliding,homebuilt,insurance,journal,journalist,leasing,logistics,magazine,maintenance,marketplace,media,microlight,modelling,navigation,parachuting,paragliding,passenger-association,pilot,press,production,recreation,repbody,res,research,rotorcraft,safety,scientist,services,show,skydiving,software,student,taxi,trader,trading,trainer,union,workinggroup,works),af(5:gov,com,org,net,edu),ag(5:com,org,net,co,nom),ai(4:off,com,net,org),al(6:com,edu,gov,mil,net,org),am,an(4:com,net,org,edu),ao(6:ed,gv,og,co,pb,it),aq,ar(11:*,congresodelalengua3(1:!),educ(1:!),gobiernoelectronico(1:!),mecon(1:!),nacion(1:!),nic(1:!),promocion(1:!),retina(1:!),uba(1:!),com(1:blogspot)),arpa(6:e164,in-addr,ip6,iris,uri,urn),as(1:gov),asia,at(7:ac,co(1:blogspot),gv,or,biz,info,priv),au(18:com(1:blogspot),net,org,edu(8:act,nsw,nt,qld,sa,tas,vic,wa),gov(7:act,nt,qld,sa,tas,vic,wa),asn,id,info,conf,oz,act,nsw,nt,qld,sa,tas,vic,wa),aw(1:com),ax,az(12:com,net,int,gov,org,edu,info,pp,mil,name,pro,biz),ba(10:org,net,edu,gov,mil,unsa,unbi,co,com,rs),bb(8:biz,com,edu,gov,info,net,org,store),bd(1:*),be(2:ac,blogspot),bf(1:gov),bg(36:a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,0,1,2,3,4,5,6,7,8,9),bh(5:com,edu,net,org,gov),bi(5:co,com,edu,or,org),biz(7:dyndns,for-better,for-more,for-some,for-the,selfip,webhop),bj(4:asso,barreau,gouv,blogspot),bm(5:com,edu,gov,net,org),bn(1:*),bo(9:com,edu,gov,gob,int,org,net,mil,tv),br(69:adm,adv,agr,am,arq,art,ato,b,bio,blog,bmd,cim,cng,cnt,com(1:blogspot),coop,ecn,eco,edu,emp,eng,esp,etc,eti,far,flog,fm,fnd,fot,fst,g12,ggf,gov,imb,ind,inf,jor,jus,leg,lel,mat,med,mil,mus,net,nom,not,ntr,odo,org,ppg,pro,psc,psi,qsl,radio,rec,slg,srv,taxi,teo,tmp,trd,tur,tv,vet,vlog,wiki,zlg),bs(5:com,net,org,edu,gov),bt(5:com,edu,gov,net,org),bw(2:co,org),by(4:gov,mil,com,of),bz(5:com,net,org,edu,gov),ca(17:ab,bc,mb,nb,nf,nl,ns,nt,nu,on,pe,qc,sk,yk,gc,co,blogspot),cat,cc(4:ftpaccess,game-server,myphotos,scrapping),cd(1:gov),cf(1:blogspot),cg,ch(1:blogspot),ci(15:org,or,com,co,edu,ed,ac,net,go,asso,aéroport,int,presse,md,gouv),ck(2:*,www(1:!)),cl(4:gov,gob,co,mil),cm(1:gov),cn(44:ac,com,edu,gov,net,org,mil,公司,网络,網絡,ah,bj,cq,fj,gd,gs,gz,gx,ha,hb,he,hi,hl,hn,jl,js,jx,ln,nm,nx,qh,sc,sd,sh,sn,sx,tj,xj,xz,yn,zj,hk,mo,tw),co(13:arts,com,edu,firm,gov,info,int,mil,net,nom,org,rec,web),com(182:elasticbeanstalk,amazonaws(20:elb,s3,s3-us-west-2,s3-us-west-1,s3-eu-west-1,s3-ap-southeast-1,s3-ap-southeast-2,s3-ap-northeast-1,s3-sa-east-1,s3-us-gov-west-1,s3-fips-us-gov-west-1,s3-website-us-east-1,s3-website-us-west-2,s3-website-us-west-1,s3-website-eu-west-1,s3-website-ap-southeast-1,s3-website-ap-southeast-2,s3-website-ap-northeast-1,s3-website-sa-east-1,s3-website-us-gov-west-1),betainabox,ar,br,cn,de,eu,gb,gr,hu,jpn,kr,no,qc,ru,sa,se,uk,us,uy,za,dreamhosters,dyndns-at-home,dyndns-at-work,dyndns-blog,dyndns-free,dyndns-home,dyndns-ip,dyndns-mail,dyndns-office,dyndns-pics,dyndns-remote,dyndns-server,dyndns-web,dyndns-wiki,dyndns-work,blogdns,cechire,dnsalias,dnsdojo,doesntexist,dontexist,doomdns,dyn-o-saur,dynalias,est-a-la-maison,est-a-la-masion,est-le-patron,est-mon-blogueur,from-ak,from-al,from-ar,from-ca,from-ct,from-dc,from-de,from-fl,from-ga,from-hi,from-ia,from-id,from-il,from-in,from-ks,from-ky,from-ma,from-md,from-mi,from-mn,from-mo,from-ms,from-mt,from-nc,from-nd,from-ne,from-nh,from-nj,from-nm,from-nv,from-oh,from-ok,from-or,from-pa,from-pr,from-ri,from-sc,from-sd,from-tn,from-tx,from-ut,from-va,from-vt,from-wa,from-wi,from-wv,from-wy,getmyip,gotdns,hobby-site,homelinux,homeunix,iamallama,is-a-anarchist,is-a-blogger,is-a-bookkeeper,is-a-bulls-fan,is-a-caterer,is-a-chef,is-a-conservative,is-a-cpa,is-a-cubicle-slave,is-a-democrat,is-a-designer,is-a-doctor,is-a-financialadvisor,is-a-geek,is-a-green,is-a-guru,is-a-hard-worker,is-a-hunter,is-a-landscaper,is-a-lawyer,is-a-liberal,is-a-libertarian,is-a-llama,is-a-musician,is-a-nascarfan,is-a-nurse,is-a-painter,is-a-personaltrainer,is-a-photographer,is-a-player,is-a-republican,is-a-rockstar,is-a-socialist,is-a-student,is-a-teacher,is-a-techie,is-a-therapist,is-an-accountant,is-an-actor,is-an-actress,is-an-anarchist,is-an-artist,is-an-engineer,is-an-entertainer,is-certified,is-gone,is-into-anime,is-into-cars,is-into-cartoons,is-into-games,is-leet,is-not-certified,is-slick,is-uberleet,is-with-theband,isa-geek,isa-hockeynut,issmarterthanyou,likes-pie,likescandy,neat-url,saves-the-whales,selfip,sells-for-less,sells-for-u,servebbs,simple-url,space-to-rent,teaches-yoga,writesthisblog,appspot,blogspot,codespot,googleapis,googlecode,herokuapp,herokussl,operaunite,rhcloud),coop,cr(7:ac,co,ed,fi,go,or,sa),cu(6:com,edu,org,net,gov,inf),cv(1:blogspot),cw(4:com,edu,net,org),cx(2:gov,ath),cy(1:*),cz(1:blogspot),de(8:com,fuettertdasnetz,isteingeek,istmein,lebtimnetz,leitungsen,traeumtgerade,blogspot),dj,dk(1:blogspot),dm(5:com,net,org,edu,gov),do(10:art,com,edu,gob,gov,mil,net,org,sld,web),dz(8:com,org,net,gov,edu,asso,pol,art),ec(12:com,info,net,fin,k12,med,pro,org,edu,gov,gob,mil),edu,ee(10:edu,gov,riik,lib,med,com,pri,aip,org,fie),eg(9:com,edu,eun,gov,mil,name,net,org,sci),er(1:*),es(5:com(1:blogspot),nom,org,gob,edu),et(1:*),eu,fi(3:aland,blogspot,iki),fj(1:*),fk(1:*),fm,fo,fr(24:com,asso,nom,prd,presse,tm,aeroport,assedic,avocat,avoues,cci,chambagri,chirurgiens-dentistes,experts-comptables,geometre-expert,gouv,greta,huissier-justice,medecin,notaires,pharmacien,port,veterinaire,blogspot),ga,gd,ge(7:com,edu,gov,org,mil,net,pvt),gf,gg(5:co,org,net,sch,gov),gh(5:com,edu,gov,org,mil),gi(6:com,ltd,gov,mod,edu,org),gl,gm,gn(6:ac,com,edu,gov,org,net),gov,gp(6:com,net,mobi,edu,org,asso),gq,gr(6:com,edu,net,org,gov,blogspot),gs,gt(7:com,edu,gob,ind,mil,net,org),gu(1:*),gw,gy(3:co,com,net),hk(22:com,edu,gov,idv,net,org,公司,教育,敎育,政府,個人,个人,箇人,網络,网络,组織,網絡,网絡,组织,組織,組织,blogspot),hm,hn(6:com,edu,org,net,mil,gob),hr(4:iz,from,name,com),ht(17:com,shop,firm,info,adult,net,pro,org,med,art,coop,pol,asso,edu,rel,gouv,perso),hu(32:co,info,org,priv,sport,tm,2000,agrar,bolt,casino,city,erotica,erotika,film,forum,games,hotel,ingatlan,jogasz,konyvelo,lakas,media,news,reklam,sex,shop,suli,szex,tozsde,utazas,video,blogspot),id(10:ac,biz,co,go,mil,my,net,or,sch,web),ie(2:gov,blogspot),il(2:*,co(1:blogspot)),im(6:co(2:ltd,plc),net,gov,org,nic,ac),in(13:co,firm,net,org,gen,ind,nic,ac,edu,res,gov,mil,blogspot),info(10:dyndns,barrel-of-knowledge,barrell-of-knowledge,for-our,groks-the,groks-this,here-for-more,knowsitall,selfip,webhop),int(1:eu),io(2:com,github),iq(6:gov,edu,mil,com,org,net),ir(9:ac,co,gov,id,net,org,sch,ایران,ايران),is(6:net,com,edu,gov,org,int),it(278:gov,edu,agrigento,ag,alessandria,al,ancona,an,aosta,aoste,ao,arezzo,ar,ascoli-piceno,ascolipiceno,ap,asti,at,avellino,av,bari,ba,andria-barletta-trani,andriabarlettatrani,trani-barletta-andria,tranibarlettaandria,barletta-trani-andria,barlettatraniandria,andria-trani-barletta,andriatranibarletta,trani-andria-barletta,traniandriabarletta,bt,belluno,bl,benevento,bn,bergamo,bg,biella,bi,bologna,bo,bolzano,bozen,balsan,alto-adige,altoadige,suedtirol,bz,brescia,bs,brindisi,br,cagliari,ca,caltanissetta,cl,campobasso,cb,carboniaiglesias,carbonia-iglesias,iglesias-carbonia,iglesiascarbonia,ci,caserta,ce,catania,ct,catanzaro,cz,chieti,ch,como,co,cosenza,cs,cremona,cr,crotone,kr,cuneo,cn,dell-ogliastra,dellogliastra,ogliastra,og,enna,en,ferrara,fe,fermo,fm,firenze,florence,fi,foggia,fg,forli-cesena,forlicesena,cesena-forli,cesenaforli,fc,frosinone,fr,genova,genoa,ge,gorizia,go,grosseto,gr,imperia,im,isernia,is,laquila,aquila,aq,la-spezia,laspezia,sp,latina,lt,lecce,le,lecco,lc,livorno,li,lodi,lo,lucca,lu,macerata,mc,mantova,mn,massa-carrara,massacarrara,carrara-massa,carraramassa,ms,matera,mt,medio-campidano,mediocampidano,campidano-medio,campidanomedio,vs,messina,me,milano,milan,mi,modena,mo,monza,monza-brianza,monzabrianza,monzaebrianza,monzaedellabrianza,monza-e-della-brianza,mb,napoli,naples,na,novara,no,nuoro,nu,oristano,or,padova,padua,pd,palermo,pa,parma,pr,pavia,pv,perugia,pg,pescara,pe,pesaro-urbino,pesarourbino,urbino-pesaro,urbinopesaro,pu,piacenza,pc,pisa,pi,pistoia,pt,pordenone,pn,potenza,pz,prato,po,ragusa,rg,ravenna,ra,reggio-calabria,reggiocalabria,rc,reggio-emilia,reggioemilia,re,rieti,ri,rimini,rn,roma,rome,rm,rovigo,ro,salerno,sa,sassari,ss,savona,sv,siena,si,siracusa,sr,sondrio,so,taranto,ta,tempio-olbia,tempioolbia,olbia-tempio,olbiatempio,ot,teramo,te,terni,tr,torino,turin,to,trapani,tp,trento,trentino,tn,treviso,tv,trieste,ts,udine,ud,varese,va,venezia,venice,ve,verbania,vb,vercelli,vc,verona,vr,vibo-valentia,vibovalentia,vv,vicenza,vi,viterbo,vt,blogspot),je(5:co,org,net,sch,gov),jm(1:*),jo(8:com,org,net,edu,sch,gov,mil,name),jobs,jp(64:ac,ad,co,ed,go,gr,lg,ne,or,aichi(53:aisai,ama,anjo,asuke,chiryu,chita,fuso,gamagori,handa,hazu,hekinan,higashiura,ichinomiya,inazawa,inuyama,isshiki,iwakura,kanie,kariya,kasugai,kira,kiyosu,komaki,konan,kota,mihama,miyoshi,nagakute,nishio,nisshin,obu,oguchi,oharu,okazaki,owariasahi,seto,shikatsu,shinshiro,shitara,tahara,takahama,tobishima,toei,togo,tokai,tokoname,toyoake,toyohashi,toyokawa,toyone,toyota,tsushima,yatomi),akita(28:akita,daisen,fujisato,gojome,hachirogata,happou,higashinaruse,honjo,honjyo,ikawa,kamikoani,kamioka,katagami,kazuno,kitaakita,kosaka,kyowa,misato,mitane,moriyoshi,nikaho,noshiro,odate,oga,ogata,semboku,yokote,yurihonjo),aomori(22:aomori,gonohe,hachinohe,hashikami,hiranai,hirosaki,itayanagi,kuroishi,misawa,mutsu,nakadomari,noheji,oirase,owani,rokunohe,sannohe,shichinohe,shingo,takko,towada,tsugaru,tsuruta),chiba(58:abiko,asahi,chonan,chosei,choshi,chuo,funabashi,futtsu,hanamigawa,ichihara,ichikawa,ichinomiya,inzai,isumi,kamagaya,kamogawa,kashiwa,katori,katsuura,kimitsu,kisarazu,kozaki,kujukuri,kyonan,matsudo,midori,mihama,minamiboso,mobara,mutsuzawa,nagara,nagareyama,narashino,narita,noda,oamishirasato,omigawa,onjuku,otaki,sakae,sakura,shimofusa,shirako,shiroi,shisui,sodegaura,sosa,tako,tateyama,togane,tohnosho,tomisato,urayasu,yachimata,yachiyo,yokaichiba,yokoshibahikari,yotsukaido),ehime(22:ainan,honai,ikata,imabari,iyo,kamijima,kihoku,kumakogen,masaki,matsuno,matsuyama,namikata,niihama,ozu,saijo,seiyo,shikokuchuo,tobe,toon,uchiko,uwajima,yawatahama),fukui(15:echizen,eiheiji,fukui,ikeda,katsuyama,mihama,minamiechizen,obama,ohi,ono,sabae,sakai,takahama,tsuruga,wakasa),fukuoka(63:ashiya,buzen,chikugo,chikuho,chikujo,chikushino,chikuzen,chuo,dazaifu,fukuchi,hakata,higashi,hirokawa,hisayama,iizuka,inatsuki,kaho,kasuga,kasuya,kawara,keisen,koga,kurate,kurogi,kurume,minami,miyako,miyama,miyawaka,mizumaki,munakata,nakagawa,nakama,nishi,nogata,ogori,okagaki,okawa,oki,omuta,onga,onojo,oto,saigawa,sasaguri,shingu,shinyoshitomi,shonai,soeda,sue,tachiarai,tagawa,takata,toho,toyotsu,tsuiki,ukiha,umi,usui,yamada,yame,yanagawa,yukuhashi),fukushima(51:aizubange,aizumisato,aizuwakamatsu,asakawa,bandai,date,fukushima,furudono,futaba,hanawa,higashi,hirata,hirono,iitate,inawashiro,ishikawa,iwaki,izumizaki,kagamiishi,kaneyama,kawamata,kitakata,kitashiobara,koori,koriyama,kunimi,miharu,mishima,namie,nango,nishiaizu,nishigo,okuma,omotego,ono,otama,samegawa,shimogo,shirakawa,showa,soma,sukagawa,taishin,tamakawa,tanagura,tenei,yabuki,yamato,yamatsuri,yanaizu,yugawa),gifu(38:anpachi,ena,gifu,ginan,godo,gujo,hashima,hichiso,hida,higashishirakawa,ibigawa,ikeda,kakamigahara,kani,kasahara,kasamatsu,kawaue,kitagata,mino,minokamo,mitake,mizunami,motosu,nakatsugawa,ogaki,sakahogi,seki,sekigahara,shirakawa,tajimi,takayama,tarui,toki,tomika,wanouchi,yamagata,yaotsu,yoro),gunma(36:annaka,chiyoda,fujioka,higashiagatsuma,isesaki,itakura,kanna,kanra,katashina,kawaba,kiryu,kusatsu,maebashi,meiwa,midori,minakami,naganohara,nakanojo,nanmoku,numata,oizumi,ora,ota,shibukawa,shimonita,shinto,showa,takasaki,takayama,tamamura,tatebayashi,tomioka,tsukiyono,tsumagoi,ueno,yoshioka),hiroshima(25:asaminami,daiwa,etajima,fuchu,fukuyama,hatsukaichi,higashihiroshima,hongo,jinsekikogen,kaita,kui,kumano,kure,mihara,miyoshi,naka,onomichi,osakikamijima,otake,saka,sera,seranishi,shinichi,shobara,takehara),hokkaido(142:abashiri,abira,aibetsu,akabira,akkeshi,asahikawa,ashibetsu,ashoro,assabu,atsuma,bibai,biei,bifuka,bihoro,biratori,chippubetsu,chitose,date,ebetsu,embetsu,eniwa,erimo,esan,esashi,fukagawa,fukushima,furano,furubira,haboro,hakodate,hamatonbetsu,hidaka,higashikagura,higashikawa,hiroo,hokuryu,hokuto,honbetsu,horokanai,horonobe,ikeda,imakane,ishikari,iwamizawa,iwanai,kamifurano,kamikawa,kamishihoro,kamisunagawa,kamoenai,kayabe,kembuchi,kikonai,kimobetsu,kitahiroshima,kitami,kiyosato,koshimizu,kunneppu,kuriyama,kuromatsunai,kushiro,kutchan,kyowa,mashike,matsumae,mikasa,minamifurano,mombetsu,moseushi,mukawa,muroran,naie,nakagawa,nakasatsunai,nakatombetsu,nanae,nanporo,nayoro,nemuro,niikappu,niki,nishiokoppe,noboribetsu,numata,obihiro,obira,oketo,okoppe,otaru,otobe,otofuke,otoineppu,oumu,ozora,pippu,rankoshi,rebun,rikubetsu,rishiri,rishirifuji,saroma,sarufutsu,shakotan,shari,shibecha,shibetsu,shikabe,shikaoi,shimamaki,shimizu,shimokawa,shinshinotsu,shintoku,shiranuka,shiraoi,shiriuchi,sobetsu,sunagawa,taiki,takasu,takikawa,takinoue,teshikaga,tobetsu,tohma,tomakomai,tomari,toya,toyako,toyotomi,toyoura,tsubetsu,tsukigata,urakawa,urausu,uryu,utashinai,wakkanai,wassamu,yakumo,yoichi),hyogo(46:aioi,akashi,ako,amagasaki,aogaki,asago,ashiya,awaji,fukusaki,goshiki,harima,himeji,ichikawa,inagawa,itami,kakogawa,kamigori,kamikawa,kasai,kasuga,kawanishi,miki,minamiawaji,nishinomiya,nishiwaki,ono,sanda,sannan,sasayama,sayo,shingu,shinonsen,shiso,sumoto,taishi,taka,takarazuka,takasago,takino,tamba,tatsuno,toyooka,yabu,yashiro,yoka,yokawa),ibaraki(51:ami,asahi,bando,chikusei,daigo,fujishiro,hitachi,hitachinaka,hitachiomiya,hitachiota,ibaraki,ina,inashiki,itako,iwama,joso,kamisu,kasama,kashima,kasumigaura,koga,miho,mito,moriya,naka,namegata,oarai,ogawa,omitama,ryugasaki,sakai,sakuragawa,shimodate,shimotsuma,shirosato,sowa,suifu,takahagi,tamatsukuri,tokai,tomobe,tone,toride,tsuchiura,tsukuba,uchihara,ushiku,yachiyo,yamagata,yawara,yuki),ishikawa(19:anamizu,hakui,hakusan,kaga,kahoku,kanazawa,kawakita,komatsu,nakanoto,nanao,nomi,nonoichi,noto,shika,suzu,tsubata,tsurugi,uchinada,wajima),iwate(35:fudai,fujisawa,hanamaki,hiraizumi,hirono,ichinohe,ichinoseki,iwaizumi,iwate,joboji,kamaishi,kanegasaki,karumai,kawai,kitakami,kuji,kunohe,kuzumaki,miyako,mizusawa,morioka,ninohe,noda,ofunato,oshu,otsuchi,rikuzentakata,shiwa,shizukuishi,sumita,takizawa,tanohata,tono,yahaba,yamada),kagawa(15:ayagawa,higashikagawa,kanonji,kotohira,manno,marugame,mitoyo,naoshima,sanuki,tadotsu,takamatsu,tonosho,uchinomi,utazu,zentsuji),kagoshima(20:akune,amami,hioki,isa,isen,izumi,kagoshima,kanoya,kawanabe,kinko,kouyama,makurazaki,matsumoto,minamitane,nakatane,nishinoomote,satsumasendai,soo,tarumizu,yusui),kanagawa(30:aikawa,atsugi,ayase,chigasaki,ebina,fujisawa,hadano,hakone,hiratsuka,isehara,kaisei,kamakura,kiyokawa,matsuda,minamiashigara,miura,nakai,ninomiya,odawara,oi,oiso,sagamihara,samukawa,tsukui,yamakita,yamato,yokosuka,yugawara,zama,zushi),kochi(31:aki,geisei,hidaka,higashitsuno,ino,kagami,kami,kitagawa,kochi,mihara,motoyama,muroto,nahari,nakamura,nankoku,nishitosa,niyodogawa,ochi,okawa,otoyo,otsuki,sakawa,sukumo,susaki,tosa,tosashimizu,toyo,tsuno,umaji,yasuda,yusuhara),kumamoto(26:amakusa,arao,aso,choyo,gyokuto,hitoyoshi,kamiamakusa,kashima,kikuchi,kosa,kumamoto,mashiki,mifune,minamata,minamioguni,nagasu,nishihara,oguni,ozu,sumoto,takamori,uki,uto,yamaga,yamato,yatsushiro),kyoto(31:ayabe,fukuchiyama,higashiyama,ide,ine,joyo,kameoka,kamo,kita,kizu,kumiyama,kyotamba,kyotanabe,kyotango,maizuru,minami,minamiyamashiro,miyazu,muko,nagaokakyo,nakagyo,nantan,oyamazaki,sakyo,seika,tanabe,uji,ujitawara,wazuka,yamashina,yawata),mie(30:asahi,inabe,ise,kameyama,kawagoe,kiho,kisosaki,kiwa,komono,kumano,kuwana,matsusaka,meiwa,mihama,minamiise,misugi,miyama,nabari,shima,suzuka,tado,taiki,taki,tamaki,toba,tsu,udono,ureshino,watarai,yokkaichi),miyagi(33:furukawa,higashimatsushima,ishinomaki,iwanuma,kakuda,kami,kawasaki,kesennuma,marumori,matsushima,minamisanriku,misato,murata,natori,ogawara,ohira,onagawa,osaki,rifu,semine,shibata,shichikashuku,shikama,shiogama,shiroishi,tagajo,taiwa,tome,tomiya,wakuya,watari,yamamoto,zao),miyazaki(27:aya,ebino,gokase,hyuga,kadogawa,kawaminami,kijo,kitagawa,kitakata,kitaura,kobayashi,kunitomi,kushima,mimata,miyakonojo,miyazaki,morotsuka,nichinan,nishimera,nobeoka,saito,shiiba,shintomi,takaharu,takanabe,takazaki,tsuno),nagano(75:achi,agematsu,anan,aoki,asahi,azumino,chikuhoku,chikuma,chino,fujimi,hakuba,hara,hiraya,iida,iijima,iiyama,iizuna,ikeda,ikusaka,ina,karuizawa,kawakami,kiso,kisofukushima,kitaaiki,komagane,komoro,matsukawa,matsumoto,miasa,minamiaiki,minamimaki,minamiminowa,minowa,miyada,miyota,mochizuki,nagano,nagawa,nagiso,nakagawa,nakano,nozawaonsen,obuse,ogawa,okaya,omachi,omi,ookuwa,ooshika,otaki,otari,sakae,sakaki,saku,sakuho,shimosuwa,shinanomachi,shiojiri,suwa,suzaka,takagi,takamori,takayama,tateshina,tatsuno,togakushi,togura,tomi,ueda,wada,yamagata,yamanouchi,yasaka,yasuoka),nagasaki(22:chijiwa,futsu,goto,hasami,hirado,iki,isahaya,kawatana,kuchinotsu,matsuura,nagasaki,obama,omura,oseto,saikai,sasebo,seihi,shimabara,shinkamigoto,togitsu,tsushima,unzen),nara(38:ando,gose,heguri,higashiyoshino,ikaruga,ikoma,kamikitayama,kanmaki,kashiba,kashihara,katsuragi,kawai,kawakami,kawanishi,koryo,kurotaki,mitsue,miyake,nara,nosegawa,oji,ouda,oyodo,sakurai,sango,shimoichi,shimokitayama,shinjo,soni,takatori,tawaramoto,tenkawa,tenri,uda,yamatokoriyama,yamatotakada,yamazoe,yoshino),niigata(34:aga,agano,gosen,itoigawa,izumozaki,joetsu,kamo,kariwa,kashiwazaki,minamiuonuma,mitsuke,muika,murakami,myoko,nagaoka,niigata,ojiya,omi,sado,sanjo,seiro,seirou,sekikawa,shibata,tagami,tainai,tochio,tokamachi,tsubame,tsunan,uonuma,yahiko,yoita,yuzawa),oita(19:beppu,bungoono,bungotakada,hasama,hiji,himeshima,hita,kamitsue,kokonoe,kuju,kunisaki,kusu,oita,saiki,taketa,tsukumi,usa,usuki,yufu),okayama(26:akaiwa,asakuchi,bizen,hayashima,ibara,kagamino,kasaoka,kibichuo,kumenan,kurashiki,maniwa,misaki,nagi,niimi,nishiawakura,okayama,satosho,setouchi,shinjo,shoo,soja,takahashi,tamano,tsuyama,wake,yakage),okinawa(42:aguni,ginowan,ginoza,gushikami,haebaru,higashi,hirara,iheya,ishigaki,ishikawa,itoman,izena,kadena,kin,kitadaito,kitanakagusuku,kumejima,kunigami,minamidaito,motobu,nago,naha,nakagusuku,nakijin,nanjo,nishihara,ogimi,okinawa,onna,shimoji,taketomi,tarama,tokashiki,tomigusuku,tonaki,urasoe,uruma,yaese,yomitan,yonabaru,yonaguni,zamami),osaka(50:abeno,chihayaakasaka,chuo,daito,fujiidera,habikino,hannan,higashiosaka,higashisumiyoshi,higashiyodogawa,hirakata,ibaraki,ikeda,izumi,izumiotsu,izumisano,kadoma,kaizuka,kanan,kashiwara,katano,kawachinagano,kishiwada,kita,kumatori,matsubara,minato,minoh,misaki,moriguchi,neyagawa,nishi,nose,osakasayama,sakai,sayama,sennan,settsu,shijonawate,shimamoto,suita,tadaoka,taishi,tajiri,takaishi,takatsuki,tondabayashi,toyonaka,toyono,yao),saga(26:ariake,arita,fukudomi,genkai,hamatama,hizen,imari,kamimine,kanzaki,karatsu,kashima,kitagata,kitahata,kiyama,kouhoku,kyuragi,nishiarita,ogi,omachi,ouchi,saga,shiroishi,taku,tara,tosu,yoshinogari),saitama(69:arakawa,asaka,chichibu,fujimi,fujimino,fukaya,hanno,hanyu,hasuda,hatogaya,hatoyama,hidaka,higashichichibu,higashimatsuyama,honjo,ina,iruma,iwatsuki,kamiizumi,kamikawa,kamisato,kasukabe,kawagoe,kawaguchi,kawajima,kazo,kitamoto,koshigaya,kounosu,kuki,kumagaya,matsubushi,minano,misato,miyashiro,miyoshi,moroyama,nagatoro,namegawa,niiza,ogano,ogawa,ogose,okegawa,omiya,otaki,ranzan,ryokami,saitama,sakado,satte,sayama,shiki,shiraoka,soka,sugito,toda,tokigawa,tokorozawa,tsurugashima,urawa,warabi,yashio,yokoze,yono,yorii,yoshida,yoshikawa,yoshimi),shiga(23:aisho,gamo,higashiomi,hikone,koka,konan,kosei,koto,kusatsu,maibara,moriyama,nagahama,nishiazai,notogawa,omihachiman,otsu,ritto,ryuoh,takashima,takatsuki,torahime,toyosato,yasu),shimane(23:akagi,ama,gotsu,hamada,higashiizumo,hikawa,hikimi,izumo,kakinoki,masuda,matsue,misato,nishinoshima,ohda,okinoshima,okuizumo,shimane,tamayu,tsuwano,unnan,yakumo,yasugi,yatsuka),shizuoka(36:arai,atami,fuji,fujieda,fujikawa,fujinomiya,fukuroi,gotemba,haibara,hamamatsu,higashiizu,ito,iwata,izu,izunokuni,kakegawa,kannami,kawanehon,kawazu,kikugawa,kosai,makinohara,matsuzaki,minamiizu,mishima,morimachi,nishiizu,numazu,omaezaki,shimada,shimizu,shimoda,shizuoka,susono,yaizu,yoshida),tochigi(31:ashikaga,bato,haga,ichikai,iwafune,kaminokawa,kanuma,karasuyama,kuroiso,mashiko,mibu,moka,motegi,nasu,nasushiobara,nikko,nishikata,nogi,ohira,ohtawara,oyama,sakura,sano,shimotsuke,shioya,takanezawa,tochigi,tsuga,ujiie,utsunomiya,yaita),tokushima(17:aizumi,anan,ichiba,itano,kainan,komatsushima,matsushige,mima,minami,miyoshi,mugi,nakagawa,naruto,sanagochi,shishikui,tokushima,wajiki),tokyo(57:adachi,akiruno,akishima,aogashima,arakawa,bunkyo,chiyoda,chofu,chuo,edogawa,fuchu,fussa,hachijo,hachioji,hamura,higashikurume,higashimurayama,higashiyamato,hino,hinode,hinohara,inagi,itabashi,katsushika,kita,kiyose,kodaira,koganei,kokubunji,komae,koto,kouzushima,kunitachi,machida,meguro,minato,mitaka,mizuho,musashimurayama,musashino,nakano,nerima,ogasawara,okutama,ome,oshima,ota,setagaya,shibuya,shinagawa,shinjuku,suginami,sumida,tachikawa,taito,tama,toshima),tottori(13:chizu,hino,kawahara,koge,kotoura,misasa,nanbu,nichinan,sakaiminato,tottori,wakasa,yazu,yonago),toyama(24:asahi,fuchu,fukumitsu,funahashi,himi,imizu,inami,johana,kamiichi,kurobe,nakaniikawa,namerikawa,nanto,nyuzen,oyabe,taira,takaoka,tateyama,toga,tonami,toyama,unazuki,uozu,yamada),wakayama(29:arida,aridagawa,gobo,hashimoto,hidaka,hirogawa,inami,iwade,kainan,kamitonda,katsuragi,kimino,kinokawa,kitayama,koya,koza,kozagawa,kudoyama,kushimoto,mihama,misato,nachikatsuura,shingu,shirahama,taiji,tanabe,wakayama,yuasa,yura),yamagata(34:asahi,funagata,higashine,iide,kahoku,kaminoyama,kaneyama,kawanishi,mamurogawa,mikawa,murayama,nagai,nakayama,nanyo,nishikawa,obanazawa,oe,oguni,ohkura,oishida,sagae,sakata,sakegawa,shinjo,shirataka,shonai,takahata,tendo,tozawa,tsuruoka,yamagata,yamanobe,yonezawa,yuza),yamaguchi(16:abu,hagi,hikari,hofu,iwakuni,kudamatsu,mitou,nagato,oshima,shimonoseki,shunan,tabuse,tokuyama,toyota,ube,yuu),yamanashi(28:chuo,doshi,fuefuki,fujikawa,fujikawaguchiko,fujiyoshida,hayakawa,hokuto,ichikawamisato,kai,kofu,koshu,kosuge,minami-alps,minobu,nakamichi,nanbu,narusawa,nirasaki,nishikatsura,oshino,otsuki,showa,tabayama,tsuru,uenohara,yamanakako,yamanashi),kawasaki(2:*,city(1:!)),kitakyushu(2:*,city(1:!)),kobe(2:*,city(1:!)),nagoya(2:*,city(1:!)),sapporo(2:*,city(1:!)),sendai(2:*,city(1:!)),yokohama(2:*,city(1:!)),blogspot),ke(1:*),kg(6:org,net,com,edu,gov,mil),kh(1:*),ki(7:edu,biz,net,org,gov,info,com),km(17:org,nom,gov,prd,tm,edu,mil,ass,com,coop,asso,presse,medecin,notaires,pharmaciens,veterinaire,gouv),kn(4:net,org,edu,gov),kp(6:com,edu,gov,org,rep,tra),kr(30:ac,co,es,go,hs,kg,mil,ms,ne,or,pe,re,sc,busan,chungbuk,chungnam,daegu,daejeon,gangwon,gwangju,gyeongbuk,gyeonggi,gyeongnam,incheon,jeju,jeonbuk,jeonnam,seoul,ulsan,blogspot),kw(1:*),ky(5:edu,gov,com,org,net),kz(6:org,edu,net,gov,mil,com),la(9:int,net,info,edu,gov,per,com,org,c),lb(5:com,edu,gov,net,org),lc(6:com,net,co,org,edu,gov),li,lk(14:gov,sch,net,int,com,org,edu,ngo,soc,web,ltd,assn,grp,hotel),lr(5:com,edu,gov,org,net),ls(2:co,org),lt(1:gov),lu,lv(9:com,edu,gov,org,mil,id,net,asn,conf),ly(9:com,net,gov,plc,edu,sch,med,org,id),ma(6:co,net,gov,org,ac,press),mc(2:tm,asso),md,me(8:co,net,org,edu,ac,gov,its,priv),mg(8:org,nom,gov,prd,tm,edu,mil,com),mh,mil,mk(7:com,org,net,edu,gov,inf,name),ml(7:com,edu,gouv,gov,net,org,presse),mm(1:*),mn(4:gov,edu,org,nyc),mo(5:com,net,org,edu,gov),mobi,mp,mq,mr(2:gov,blogspot),ms,mt(1:*),mu(7:com,net,org,gov,ac,co,or),museum(548:academy,agriculture,air,airguard,alabama,alaska,amber,ambulance,american,americana,americanantiques,americanart,amsterdam,and,annefrank,anthro,anthropology,antiques,aquarium,arboretum,archaeological,archaeology,architecture,art,artanddesign,artcenter,artdeco,arteducation,artgallery,arts,artsandcrafts,asmatart,assassination,assisi,association,astronomy,atlanta,austin,australia,automotive,aviation,axis,badajoz,baghdad,bahn,bale,baltimore,barcelona,baseball,basel,baths,bauern,beauxarts,beeldengeluid,bellevue,bergbau,berkeley,berlin,bern,bible,bilbao,bill,birdart,birthplace,bonn,boston,botanical,botanicalgarden,botanicgarden,botany,brandywinevalley,brasil,bristol,british,britishcolumbia,broadcast,brunel,brussel,brussels,bruxelles,building,burghof,bus,bushey,cadaques,california,cambridge,can,canada,capebreton,carrier,cartoonart,casadelamoneda,castle,castres,celtic,center,chattanooga,cheltenham,chesapeakebay,chicago,children,childrens,childrensgarden,chiropractic,chocolate,christiansburg,cincinnati,cinema,circus,civilisation,civilization,civilwar,clinton,clock,coal,coastaldefence,cody,coldwar,collection,colonialwilliamsburg,coloradoplateau,columbia,columbus,communication,communications,community,computer,computerhistory,comunicações,contemporary,contemporaryart,convent,copenhagen,corporation,correios-e-telecomunicações,corvette,costume,countryestate,county,crafts,cranbrook,creation,cultural,culturalcenter,culture,cyber,cymru,dali,dallas,database,ddr,decorativearts,delaware,delmenhorst,denmark,depot,design,detroit,dinosaur,discovery,dolls,donostia,durham,eastafrica,eastcoast,education,educational,egyptian,eisenbahn,elburg,elvendrell,embroidery,encyclopedic,england,entomology,environment,environmentalconservation,epilepsy,essex,estate,ethnology,exeter,exhibition,family,farm,farmequipment,farmers,farmstead,field,figueres,filatelia,film,fineart,finearts,finland,flanders,florida,force,fortmissoula,fortworth,foundation,francaise,frankfurt,franziskaner,freemasonry,freiburg,fribourg,frog,fundacio,furniture,gallery,garden,gateway,geelvinck,gemological,geology,georgia,giessen,glas,glass,gorge,grandrapids,graz,guernsey,halloffame,hamburg,handson,harvestcelebration,hawaii,health,heimatunduhren,hellas,helsinki,hembygdsforbund,heritage,histoire,historical,historicalsociety,historichouses,historisch,historisches,history,historyofscience,horology,house,humanities,illustration,imageandsound,indian,indiana,indianapolis,indianmarket,intelligence,interactive,iraq,iron,isleofman,jamison,jefferson,jerusalem,jewelry,jewish,jewishart,jfk,journalism,judaica,judygarland,juedisches,juif,karate,karikatur,kids,koebenhavn,koeln,kunst,kunstsammlung,kunstunddesign,labor,labour,lajolla,lancashire,landes,lans,läns,larsson,lewismiller,lincoln,linz,living,livinghistory,localhistory,london,losangeles,louvre,loyalist,lucerne,luxembourg,luzern,mad,madrid,mallorca,manchester,mansion,mansions,manx,marburg,maritime,maritimo,maryland,marylhurst,media,medical,medizinhistorisches,meeres,memorial,mesaverde,michigan,midatlantic,military,mill,miners,mining,minnesota,missile,missoula,modern,moma,money,monmouth,monticello,montreal,moscow,motorcycle,muenchen,muenster,mulhouse,muncie,museet,museumcenter,museumvereniging,music,national,nationalfirearms,nationalheritage,nativeamerican,naturalhistory,naturalhistorymuseum,naturalsciences,nature,naturhistorisches,natuurwetenschappen,naumburg,naval,nebraska,neues,newhampshire,newjersey,newmexico,newport,newspaper,newyork,niepce,norfolk,north,nrw,nuernberg,nuremberg,nyc,nyny,oceanographic,oceanographique,omaha,online,ontario,openair,oregon,oregontrail,otago,oxford,pacific,paderborn,palace,paleo,palmsprings,panama,paris,pasadena,pharmacy,philadelphia,philadelphiaarea,philately,phoenix,photography,pilots,pittsburgh,planetarium,plantation,plants,plaza,portal,portland,portlligat,posts-and-telecommunications,preservation,presidio,press,project,public,pubol,quebec,railroad,railway,research,resistance,riodejaneiro,rochester,rockart,roma,russia,saintlouis,salem,salvadordali,salzburg,sandiego,sanfrancisco,santabarbara,santacruz,santafe,saskatchewan,satx,savannahga,schlesisches,schoenbrunn,schokoladen,school,schweiz,science,scienceandhistory,scienceandindustry,sciencecenter,sciencecenters,science-fiction,sciencehistory,sciences,sciencesnaturelles,scotland,seaport,settlement,settlers,shell,sherbrooke,sibenik,silk,ski,skole,society,sologne,soundandvision,southcarolina,southwest,space,spy,square,stadt,stalbans,starnberg,state,stateofdelaware,station,steam,steiermark,stjohn,stockholm,stpetersburg,stuttgart,suisse,surgeonshall,surrey,svizzera,sweden,sydney,tank,tcm,technology,telekommunikation,television,texas,textile,theater,time,timekeeping,topology,torino,touch,town,transport,tree,trolley,trust,trustee,uhren,ulm,undersea,university,usa,usantiques,usarts,uscountryestate,usculture,usdecorativearts,usgarden,ushistory,ushuaia,uslivinghistory,utah,uvic,valley,vantaa,versailles,viking,village,virginia,virtual,virtuel,vlaanderen,volkenkunde,wales,wallonie,war,washingtondc,watchandclock,watch-and-clock,western,westfalen,whaling,wildlife,williamsburg,windmill,workshop,york,yorkshire,yosemite,youth,zoological,zoology,ירושלים,иком),mv(14:aero,biz,com,coop,edu,gov,info,int,mil,museum,name,net,org,pro),mw(11:ac,biz,co,com,coop,edu,gov,int,museum,net,org),mx(6:com,org,gob,edu,net,blogspot),my(7:com,net,org,gov,edu,mil,name),mz(2:*,teledata(1:!)),na(17:info,pro,name,school,or,dr,us,mx,ca,in,cc,tv,ws,mobi,co,com,org),name(2:her(1:forgot),his(1:forgot)),nc(1:asso),ne,net(42:cloudfront,gb,hu,jp,se,uk,at-band-camp,blogdns,broke-it,buyshouses,dnsalias,dnsdojo,does-it,dontexist,dynalias,dynathome,endofinternet,from-az,from-co,from-la,from-ny,gets-it,ham-radio-op,homeftp,homeip,homelinux,homeunix,in-the-band,is-a-chef,is-a-geek,isa-geek,kicks-ass,office-on-the,podzone,scrapper-site,selfip,sells-it,servebbs,serveftp,thruhere,webhop,za),nf(10:com,net,per,rec,web,arts,firm,info,other,store),ng(6:ac,com,edu,gov,net,org),ni(1:*),nl(3:bv,co,blogspot),no(726:fhs,vgs,fylkesbibl,folkebibl,museum,idrett,priv,mil,stat,dep,kommune,herad,aa(1:gs),ah(1:gs),bu(1:gs),fm(1:gs),hl(1:gs),hm(1:gs),jan-mayen(1:gs),mr(1:gs),nl(1:gs),nt(1:gs),of(1:gs),ol(1:gs),oslo(1:gs),rl(1:gs),sf(1:gs),st(1:gs),svalbard(1:gs),tm(1:gs),tr(1:gs),va(1:gs),vf(1:gs),akrehamn,åkrehamn,algard,ålgård,arna,brumunddal,bryne,bronnoysund,brønnøysund,drobak,drøbak,egersund,fetsund,floro,florø,fredrikstad,hokksund,honefoss,hønefoss,jessheim,jorpeland,jørpeland,kirkenes,kopervik,krokstadelva,langevag,langevåg,leirvik,mjondalen,mjøndalen,mo-i-rana,mosjoen,mosjøen,nesoddtangen,orkanger,osoyro,osøyro,raholt,råholt,sandnessjoen,sandnessjøen,skedsmokorset,slattum,spjelkavik,stathelle,stavern,stjordalshalsen,stjørdalshalsen,tananger,tranby,vossevangen,afjord,åfjord,agdenes,al,ål,alesund,ålesund,alstahaug,alta,áltá,alaheadju,álaheadju,alvdal,amli,åmli,amot,åmot,andebu,andoy,andøy,andasuolo,ardal,årdal,aremark,arendal,ås,aseral,åseral,asker,askim,askvoll,askoy,askøy,asnes,åsnes,audnedaln,aukra,aure,aurland,aurskog-holand,aurskog-høland,austevoll,austrheim,averoy,averøy,balestrand,ballangen,balat,bálát,balsfjord,bahccavuotna,báhccavuotna,bamble,bardu,beardu,beiarn,bajddar,bájddar,baidar,báidár,berg,bergen,berlevag,berlevåg,bearalvahki,bearalváhki,bindal,birkenes,bjarkoy,bjarkøy,bjerkreim,bjugn,bodo,bodø,badaddja,bådåddjå,budejju,bokn,bremanger,bronnoy,brønnøy,bygland,bykle,barum,bærum,telemark(2:bo,bø),nordland(4:bo,bø,heroy,herøy),bievat,bievát,bomlo,bømlo,batsfjord,båtsfjord,bahcavuotna,báhcavuotna,dovre,drammen,drangedal,dyroy,dyrøy,donna,dønna,eid,eidfjord,eidsberg,eidskog,eidsvoll,eigersund,elverum,enebakk,engerdal,etne,etnedal,evenes,evenassi,evenášši,evje-og-hornnes,farsund,fauske,fuossko,fuoisku,fedje,fet,finnoy,finnøy,fitjar,fjaler,fjell,flakstad,flatanger,flekkefjord,flesberg,flora,fla,flå,folldal,forsand,fosnes,frei,frogn,froland,frosta,frana,fræna,froya,frøya,fusa,fyresdal,forde,førde,gamvik,gangaviika,gáŋgaviika,gaular,gausdal,gildeskal,gildeskål,giske,gjemnes,gjerdrum,gjerstad,gjesdal,gjovik,gjøvik,gloppen,gol,gran,grane,granvin,gratangen,grimstad,grong,kraanghke,kråanghke,grue,gulen,hadsel,halden,halsa,hamar,hamaroy,habmer,hábmer,hapmir,hápmir,hammerfest,hammarfeasta,hámmárfeasta,haram,hareid,harstad,hasvik,aknoluokta,ákŋoluokta,hattfjelldal,aarborte,haugesund,hemne,hemnes,hemsedal,more-og-romsdal(2:heroy,sande),møre-og-romsdal(2:herøy,sande),hitra,hjartdal,hjelmeland,hobol,hobøl,hof,hol,hole,holmestrand,holtalen,holtålen,hornindal,horten,hurdal,hurum,hvaler,hyllestad,hagebostad,hægebostad,hoyanger,høyanger,hoylandet,høylandet,ha,hå,ibestad,inderoy,inderøy,iveland,jevnaker,jondal,jolster,jølster,karasjok,karasjohka,kárášjohka,karlsoy,galsa,gálsá,karmoy,karmøy,kautokeino,guovdageaidnu,klepp,klabu,klæbu,kongsberg,kongsvinger,kragero,kragerø,kristiansand,kristiansund,krodsherad,krødsherad,kvalsund,rahkkeravju,ráhkkerávju,kvam,kvinesdal,kvinnherad,kviteseid,kvitsoy,kvitsøy,kvafjord,kvæfjord,giehtavuoatna,kvanangen,kvænangen,navuotna,návuotna,kafjord,kåfjord,gaivuotna,gáivuotna,larvik,lavangen,lavagis,loabat,loabát,lebesby,davvesiida,leikanger,leirfjord,leka,leksvik,lenvik,leangaviika,leaŋgaviika,lesja,levanger,lier,lierne,lillehammer,lillesand,lindesnes,lindas,lindås,lom,loppa,lahppi,láhppi,lund,lunner,luroy,lurøy,luster,lyngdal,lyngen,ivgu,lardal,lerdal,lærdal,lodingen,lødingen,lorenskog,lørenskog,loten,løten,malvik,masoy,måsøy,muosat,muosát,mandal,marker,marnardal,masfjorden,meland,meldal,melhus,meloy,meløy,meraker,meråker,moareke,moåreke,midsund,midtre-gauldal,modalen,modum,molde,moskenes,moss,mosvik,malselv,målselv,malatvuopmi,málatvuopmi,namdalseid,aejrie,namsos,namsskogan,naamesjevuemie,nååmesjevuemie,laakesvuemie,nannestad,narvik,narviika,naustdal,nedre-eiker,akershus(1:nes),buskerud(1:nes),nesna,nesodden,nesseby,unjarga,unjárga,nesset,nissedal,nittedal,nord-aurdal,nord-fron,nord-odal,norddal,nordkapp,davvenjarga,davvenjárga,nordre-land,nordreisa,raisa,ráisa,nore-og-uvdal,notodden,naroy,nærøy,notteroy,nøtterøy,odda,oksnes,øksnes,oppdal,oppegard,oppegård,orkdal,orland,ørland,orskog,ørskog,orsta,ørsta,hedmark(3:os,valer,våler),hordaland(1:os),osen,osteroy,osterøy,ostre-toten,østre-toten,overhalla,ovre-eiker,øvre-eiker,oyer,øyer,oygarden,øygarden,oystre-slidre,øystre-slidre,porsanger,porsangu,porsáŋgu,porsgrunn,radoy,radøy,rakkestad,rana,ruovat,randaberg,rauma,rendalen,rennebu,rennesoy,rennesøy,rindal,ringebu,ringerike,ringsaker,rissa,risor,risør,roan,rollag,rygge,ralingen,rælingen,rodoy,rødøy,romskog,rømskog,roros,røros,rost,røst,royken,røyken,royrvik,røyrvik,rade,råde,salangen,siellak,saltdal,salat,sálát,sálat,samnanger,vestfold(1:sande),sandefjord,sandnes,sandoy,sandøy,sarpsborg,sauda,sauherad,sel,selbu,selje,seljord,sigdal,siljan,sirdal,skaun,skedsmo,ski,skien,skiptvet,skjervoy,skjervøy,skierva,skiervá,skjak,skjåk,skodje,skanland,skånland,skanit,skánit,smola,smøla,snillfjord,snasa,snåsa,snoasa,snaase,snåase,sogndal,sokndal,sola,solund,songdalen,sortland,spydeberg,stange,stavanger,steigen,steinkjer,stjordal,stjørdal,stokke,stor-elvdal,stord,stordal,storfjord,omasvuotna,strand,stranda,stryn,sula,suldal,sund,sunndal,surnadal,sveio,svelvik,sykkylven,sogne,søgne,somna,sømna,sondre-land,søndre-land,sor-aurdal,sør-aurdal,sor-fron,sør-fron,sor-odal,sør-odal,sor-varanger,sør-varanger,matta-varjjat,mátta-várjjat,sorfold,sørfold,sorreisa,sørreisa,sorum,sørum,tana,deatnu,time,tingvoll,tinn,tjeldsund,dielddanuorri,tjome,tjøme,tokke,tolga,torsken,tranoy,tranøy,tromso,tromsø,tromsa,romsa,trondheim,troandin,trysil,trana,træna,trogstad,trøgstad,tvedestrand,tydal,tynset,tysfjord,divtasvuodna,divttasvuotna,tysnes,tysvar,tysvær,tonsberg,tønsberg,ullensaker,ullensvang,ulvik,utsira,vadso,vadsø,cahcesuolo,čáhcesuolo,vaksdal,valle,vang,vanylven,vardo,vardø,varggat,várggát,vefsn,vaapste,vega,vegarshei,vegårshei,vennesla,verdal,verran,vestby,vestnes,vestre-slidre,vestre-toten,vestvagoy,vestvågøy,vevelstad,vik,vikna,vindafjord,volda,voss,varoy,værøy,vagan,vågan,voagat,vagsoy,vågsøy,vaga,vågå,ostfold(1:valer),østfold(1:våler),co,blogspot),np(1:*),nr(7:biz,info,gov,edu,org,net,com),nu(3:merseine,mine,shacknet),nz(2:*,co(1:blogspot)),om(11:*,mediaphone(1:!),nawrastelecom(1:!),nawras(1:!),omanmobile(1:!),omanpost(1:!),omantel(1:!),rakpetroleum(1:!),siemens(1:!),songfest(1:!),statecouncil(1:!)),org(53:ae,us,dyndns(2:go,home),blogdns,blogsite,boldlygoingnowhere,dnsalias,dnsdojo,doesntexist,dontexist,doomdns,dvrdns,dynalias,endofinternet,endoftheinternet,from-me,game-host,gotdns,hobby-site,homedns,homeftp,homelinux,homeunix,is-a-bruinsfan,is-a-candidate,is-a-celticsfan,is-a-chef,is-a-geek,is-a-knight,is-a-linux-user,is-a-patsfan,is-a-soxfan,is-found,is-lost,is-saved,is-very-bad,is-very-evil,is-very-good,is-very-nice,is-very-sweet,isa-geek,kicks-ass,misconfused,podzone,readmyblog,selfip,sellsyourhome,servebbs,serveftp,servegame,stuff-4-sale,webhop,za),pa(11:ac,gob,com,org,sld,edu,net,ing,abo,med,nom),pe(7:edu,gob,nom,mil,org,com,net),pf(3:com,org,edu),pg(1:*),ph(8:com,net,org,gov,edu,ngo,mil,i),pk(14:com,net,edu,org,fam,biz,web,gov,gob,gok,gon,gop,gos,info),pl(171:aid,agro,atm,auto,biz,com,edu,gmina,gsm,info,mail,miasta,media,mil,net,nieruchomosci,nom,org,pc,powiat,priv,realestate,rel,sex,shop,sklep,sos,szkola,targi,tm,tourism,travel,turystyka,6bone,art,mbone,gov(9:uw,um,ug,upow,starostwo,so,sr,po,pa),ngo,irc,usenet,augustow,babia-gora,bedzin,beskidy,bialowieza,bialystok,bielawa,bieszczady,boleslawiec,bydgoszcz,bytom,cieszyn,czeladz,czest,dlugoleka,elblag,elk,glogow,gniezno,gorlice,grajewo,ilawa,jaworzno,jelenia-gora,jgora,kalisz,kazimierz-dolny,karpacz,kartuzy,kaszuby,katowice,kepno,ketrzyn,klodzko,kobierzyce,kolobrzeg,konin,konskowola,kutno,lapy,lebork,legnica,lezajsk,limanowa,lomza,lowicz,lubin,lukow,malbork,malopolska,mazowsze,mazury,mielec,mielno,mragowo,naklo,nowaruda,nysa,olawa,olecko,olkusz,olsztyn,opoczno,opole,ostroda,ostroleka,ostrowiec,ostrowwlkp,pila,pisz,podhale,podlasie,polkowice,pomorze,pomorskie,prochowice,pruszkow,przeworsk,pulawy,radom,rawa-maz,rybnik,rzeszow,sanok,sejny,siedlce,slask,slupsk,sosnowiec,stalowa-wola,skoczow,starachowice,stargard,suwalki,swidnica,swiebodzin,swinoujscie,szczecin,szczytno,tarnobrzeg,tgory,turek,tychy,ustka,walbrzych,warmia,warszawa,waw,wegrow,wielun,wlocl,wloclawek,wodzislaw,wolomin,wroclaw,zachpomor,zagan,zarow,zgora,zgorzelec,gda,gdansk,gdynia,med,sopot,gliwice,krakow,poznan,wroc,zakopane,co),pm,pn(5:gov,co,org,edu,net),post,pr(13:com,net,org,gov,edu,isla,pro,biz,info,name,est,prof,ac),pro(7:aca,bar,cpa,jur,law,med,eng),ps(7:edu,gov,sec,plo,com,org,net),pt(9:net,gov,org,edu,int,publ,com,nome,blogspot),pw(6:co,ne,or,ed,go,belau),py(7:com,coop,edu,gov,mil,net,org),qa(8:com,edu,gov,mil,name,net,org,sch),re(4:com,asso,nom,blogspot),ro(12:com,org,tm,nt,nom,info,rec,arts,firm,store,www,blogspot),rs(6:co,org,edu,ac,gov,in),ru(133:ac,com,edu,int,net,org,pp,adygeya,altai,amur,arkhangelsk,astrakhan,bashkiria,belgorod,bir,bryansk,buryatia,cbg,chel,chelyabinsk,chita,chukotka,chuvashia,dagestan,dudinka,e-burg,grozny,irkutsk,ivanovo,izhevsk,jar,joshkar-ola,kalmykia,kaluga,kamchatka,karelia,kazan,kchr,kemerovo,khabarovsk,khakassia,khv,kirov,koenig,komi,kostroma,krasnoyarsk,kuban,kurgan,kursk,lipetsk,magadan,mari,mari-el,marine,mordovia,mosreg,msk,murmansk,nalchik,nnov,nov,novosibirsk,nsk,omsk,orenburg,oryol,palana,penza,perm,pskov,ptz,rnd,ryazan,sakhalin,samara,saratov,simbirsk,smolensk,spb,stavropol,stv,surgut,tambov,tatarstan,tom,tomsk,tsaritsyn,tsk,tula,tuva,tver,tyumen,udm,udmurtia,ulan-ude,vladikavkaz,vladimir,vladivostok,volgograd,vologda,voronezh,vrn,vyatka,yakutia,yamal,yaroslavl,yekaterinburg,yuzhno-sakhalinsk,amursk,baikal,cmw,fareast,jamal,kms,k-uralsk,kustanai,kuzbass,magnitka,mytis,nakhodka,nkz,norilsk,oskol,pyatigorsk,rubtsovsk,snz,syzran,vdonsk,zgrad,gov,mil,test),rw(9:gov,net,edu,ac,com,co,int,mil,gouv),sa(8:com,net,org,gov,med,pub,edu,sch),sb(5:com,edu,gov,net,org),sc(5:com,gov,net,org,edu),sd(8:com,net,org,edu,med,tv,gov,info),se(41:a,ac,b,bd,brand,c,d,e,f,fh,fhsk,fhv,g,h,i,k,komforb,kommunalforbund,komvux,l,lanbib,m,n,naturbruksgymn,o,org,p,parti,pp,press,r,s,sshn,t,tm,u,w,x,y,z,blogspot),sg(7:com,net,org,gov,edu,per,blogspot),sh(5:com,net,gov,org,mil),si,sk(1:blogspot),sl(5:com,net,edu,gov,org),sm,sn(7:art,com,edu,gouv,org,perso,univ),so(3:com,net,org),sr,st(12:co,com,consulado,edu,embaixada,gov,mil,net,org,principe,saotome,store),su,sv(1:*),sx(1:gov),sy(6:edu,gov,net,mil,com,org),sz(3:co,ac,org),tc,td(1:blogspot),tel,tf,tg,th(7:ac,co,go,in,mi,net,or),tj(15:ac,biz,co,com,edu,go,gov,int,mil,name,net,nic,org,test,web),tk,tl(1:gov),tm(8:com,co,org,net,nom,gov,mil,edu),tn(20:com,ens,fin,gov,ind,intl,nat,net,org,info,perso,tourism,edunet,rnrt,rns,rnu,mincom,agrinet,defense,turen),to(6:com,gov,net,org,edu,mil),tr(3:*,nic(1:!),nc(1:gov)),travel,tt(17:co,com,org,net,biz,info,pro,int,coop,jobs,mobi,travel,museum,aero,name,gov,edu),tv(4:dyndns,better-than,on-the-web,worse-than),tw(14:edu,gov,mil,com,net,org,idv,game,ebiz,club,網路,組織,商業,blogspot),tz(12:ac,co,go,hotel,info,me,mil,mobi,ne,or,sc,tv),ua(78:com,edu,gov,in,net,org,cherkassy,cherkasy,chernigov,chernihiv,chernivtsi,chernovtsy,ck,cn,cr,crimea,cv,dn,dnepropetrovsk,dnipropetrovsk,dominic,donetsk,dp,if,ivano-frankivsk,kh,kharkiv,kharkov,kherson,khmelnitskiy,khmelnytskyi,kiev,kirovograd,km,kr,krym,ks,kv,kyiv,lg,lt,lugansk,lutsk,lv,lviv,mk,mykolaiv,nikolaev,od,odesa,odessa,pl,poltava,rivne,rovno,rv,sb,sebastopol,sevastopol,sm,sumy,te,ternopil,uz,uzhgorod,vinnica,vinnytsia,vn,volyn,yalta,zaporizhzhe,zaporizhzhia,zhitomir,zhytomyr,zp,zt,co,pp),ug(8:co,or,ac,sc,go,ne,com,org),uk(12:*,sch(1:*),bl(1:!),british-library(1:!),jet(1:!),mod(1:!),national-library-scotland(1:!),nel(1:!),nic(1:!),nls(1:!),parliament(1:!),co(1:blogspot)),us(63:dni,fed,isa,kids,nsn,ak(3:k12,cc,lib),al(3:k12,cc,lib),ar(3:k12,cc,lib),as(3:k12,cc,lib),az(3:k12,cc,lib),ca(3:k12,cc,lib),co(3:k12,cc,lib),ct(3:k12,cc,lib),dc(3:k12,cc,lib),de(3:k12,cc,lib),fl(3:k12,cc,lib),ga(3:k12,cc,lib),gu(3:k12,cc,lib),hi(2:cc,lib),ia(3:k12,cc,lib),id(3:k12,cc,lib),il(3:k12,cc,lib),in(3:k12,cc,lib),ks(3:k12,cc,lib),ky(3:k12,cc,lib),la(3:k12,cc,lib),ma(3:k12(3:pvt,chtr,paroch),cc,lib),md(3:k12,cc,lib),me(3:k12,cc,lib),mi(3:k12,cc,lib),mn(3:k12,cc,lib),mo(3:k12,cc,lib),ms(3:k12,cc,lib),mt(3:k12,cc,lib),nc(3:k12,cc,lib),nd(3:k12,cc,lib),ne(3:k12,cc,lib),nh(3:k12,cc,lib),nj(3:k12,cc,lib),nm(3:k12,cc,lib),nv(3:k12,cc,lib),ny(3:k12,cc,lib),oh(3:k12,cc,lib),ok(3:k12,cc,lib),or(3:k12,cc,lib),pa(3:k12,cc,lib),pr(3:k12,cc,lib),ri(3:k12,cc,lib),sc(3:k12,cc,lib),sd(3:k12,cc,lib),tn(3:k12,cc,lib),tx(3:k12,cc,lib),ut(3:k12,cc,lib),vi(3:k12,cc,lib),vt(3:k12,cc,lib),va(3:k12,cc,lib),wa(3:k12,cc,lib),wi(3:k12,cc,lib),wv(3:k12,cc,lib),wy(3:k12,cc,lib),is-by,land-4-sale,stuff-4-sale),uy(6:com,edu,gub,mil,net,org),uz(4:co,com,net,org),va,vc(6:com,net,org,gov,mil,edu),ve(10:co,com,e12,edu,gov,info,mil,net,org,web),vg,vi(5:co,com,k12,net,org),vn(12:com,net,org,edu,gov,int,ac,biz,info,name,pro,health),vu,wf,ws(7:com,net,org,gov,edu,dyndns,mypets),yt,امارات,বাংলা,中国,中國,الجزائر,مصر,გე,香港,भारत,بھارت,భారత్,ભારત,ਭਾਰਤ,ভারত,இந்தியா,ایران,ايران,الاردن,한국,ලංකා,இலங்கை,المغرب,عمان,فلسطين,срб,рф,قطر,السعودية,السعودیة,السعودیۃ,السعوديه,سورية,سوريا,新加坡,சிங்கப்பூர்,ไทย,تونس,台灣,台湾,臺灣,укр,اليمن,xxx,ye(1:*),za(1:*),zm(1:*),zw(1:*))
\ No newline at end of file
diff --git a/plugin/BrowserHook/GestureHandler.h b/plugin/BrowserHook/GestureHandler.h
index 8e4a377..f803d3a 100644
--- a/plugin/BrowserHook/GestureHandler.h
+++ b/plugin/BrowserHook/GestureHandler.h
@@ -16,8 +16,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 */
 #pragma once
 
-#include <vector>
-
 namespace BrowserHook
 {
 
diff --git a/plugin/BrowserHook/WindowMessageHook.cpp b/plugin/BrowserHook/WindowMessageHook.cpp
index 8ce81b0..41d5c07 100644
--- a/plugin/BrowserHook/WindowMessageHook.cpp
+++ b/plugin/BrowserHook/WindowMessageHook.cpp
@@ -26,6 +26,7 @@ namespace BrowserHook
 	HHOOK WindowMessageHook::s_hhookGetMessage = NULL;
 	HHOOK WindowMessageHook::s_hhookCallWndProcRet = NULL;
 	WindowMessageHook WindowMessageHook::s_instance;
+	UINT WindowMessageHook::s_nLastMiddleClickTick = 0;
 
 	WindowMessageHook::WindowMessageHook(void)
 	{
@@ -66,6 +67,10 @@ namespace BrowserHook
 		return TRUE;
 	}
 
+	BOOL WindowMessageHook::IsMiddleButtonClicked() {
+		return GetTickCount() - s_nLastMiddleClickTick < 200;
+	}
+
 	// The message loop of Mozilla does not handle accelertor keys.
 	// IOleInplaceActivateObject requires MSG be filtered by its TranslateAccellerator() method.
 	// So we install a hook to do the dirty hack.
@@ -125,6 +130,8 @@ namespace BrowserHook
 				goto Exit;
 			}
 
+			RecordMiddleClick(pMsg);
+
 			bool bShouldSwallow = false;
 
 			if (WM_KEYFIRST <= pMsg->message && pMsg->message <= WM_KEYLAST)
@@ -163,13 +170,48 @@ Exit:
 		BOOL bCtrlPressed = HIBYTE(GetKeyState(VK_CONTROL)) != 0;
 		BOOL bShiftPressed = HIBYTE(GetKeyState(VK_SHIFT))  != 0;
 
-		// Send Alt key up message to Firefox, so that use could select the main window menu by press alt key.
+		static MSG s_pendingAltDown = { 0 };
+
+		TRACE(_T("WindowMessageHook::ForwardFirefoxKeyMessage MSG: %x wParam: %x, lPara: %x\n"), pMsg->message, pMsg->wParam, pMsg->lParam);
+		if (bAltPressed && !bCtrlPressed && pMsg->wParam == VK_MENU)
+		{
+			// Alt without Ctrl is pressed. We'll delay sending the Alt down message, in case Ctrl is pressed
+			// before Alt up.  AltGr is represented in Windows massages as the combination of Alt+Ctrl, and 
+			// that is used for text input, not for menu naviagation.
+			s_pendingAltDown = *pMsg;
+			TRACE(_T("WindowMessageHook::ForwardFirefoxKeyMessage : Alt pending...\n"));
+			return FALSE;
+		} 
+		else if (bCtrlPressed)
+		{
+			if (s_pendingAltDown.message != WM_NULL)
+			{
+				// Clear the pending Alt down message as Ctrl is pressed.
+				s_pendingAltDown.message = WM_NULL;
+				TRACE(_T("WindowMessageHook::ForwardFirefoxKeyMessage : Cleared pending Alt.\n"));
+			}
+		}
+
+		// Send Alt key up message to Firefox, so that user could select the main window menu by press alt key.
 		if (pMsg->message == WM_SYSKEYUP && pMsg->wParam == VK_MENU) 
 		{
-			bAltPressed = TRUE;
+			if (s_pendingAltDown.message != WM_NULL)
+			{
+				// Send the pending Alt down message first.
+				::SetFocus(hwndFirefox);
+				::PostMessage(hwndFirefox, s_pendingAltDown.message, s_pendingAltDown.wParam, s_pendingAltDown.lParam);
+				s_pendingAltDown.message = WM_NULL;
+				bAltPressed = TRUE;
+				TRACE(_T("WindowMessageHook::ForwardFirefoxKeyMessage : Sent pending Alt.\n"));
+			}
+		}
+		// Might be in AltGr up sequence, skip
+		else if (pMsg->message == WM_SYSKEYUP && pMsg->wParam == VK_CONTROL)
+		{
+			TRACE(_T("WindowMessageHook::ForwardFirefoxKeyMessage : Return from AltGr up sequence.\n"));
+			return FALSE;
 		}
 
-		TRACE(_T("WindowMessageHook::ForwardFirefoxKeyMessage MSG: %x wParam: %x, lPara: %x\n"), pMsg->message, pMsg->wParam, pMsg->lParam);
 		if (bCtrlPressed || bAltPressed || (pMsg->wParam >= VK_F1 && pMsg->wParam <= VK_F24))
 		{
 			int nKeyCode = static_cast<int>(pMsg->wParam);
@@ -287,6 +329,7 @@ Exit:
 			switch (keyCode)
 			{
 			case VK_CONTROL: // Only Ctrl is pressed
+			case VK_MENU: // Might be in AltGr up sequence
 				return FALSE;
 			case VK_SHIFT: // Issue #90: Ctrl-Shift switching IME, should not lose focus
 			case VK_SPACE:
@@ -372,4 +415,10 @@ Exit:
 
 		return CallNextHookEx(s_hhookCallWndProcRet, nCode, wParam, lParam);
 	}
+
+	void WindowMessageHook::RecordMiddleClick(MSG* pMsg) {
+		if (pMsg->message == WM_MBUTTONUP) {
+			s_nLastMiddleClickTick = GetTickCount();
+		}
+	}
 }
diff --git a/plugin/BrowserHook/WindowMessageHook.h b/plugin/BrowserHook/WindowMessageHook.h
index 37572b9..b5d9940 100644
--- a/plugin/BrowserHook/WindowMessageHook.h
+++ b/plugin/BrowserHook/WindowMessageHook.h
@@ -32,7 +32,7 @@ namespace BrowserHook
 		static WindowMessageHook s_instance;
 		BOOL Install(void);
 		BOOL Uninstall(void);
-
+		static BOOL IsMiddleButtonClicked();
 	private:
 		WindowMessageHook(void);
 		~WindowMessageHook(void);
@@ -42,11 +42,13 @@ namespace BrowserHook
 		static BOOL ForwardFirefoxKeyMessage(HWND hwndFirefox, MSG* pMsg);
 		static BOOL ForwardFirefoxMouseMessage(HWND hwndFirefox, MSG* pMsg);
 		static BOOL ForwardZoomMessage(HWND hwndFirefox, MSG* pMsg);
+		static void RecordMiddleClick(MSG* pMsg);
 	private:
 		// WH_GETMESSAGE hook.
 		static HHOOK s_hhookGetMessage;
 		// WH_CALLWNDPROCRET
 		static HHOOK s_hhookCallWndProcRet;
+		// Record the last time middle button was clicked
+		static UINT s_nLastMiddleClickTick;
 	};
 }
-
diff --git a/plugin/HttpMonitor/MonitorSink.cpp b/plugin/HttpMonitor/MonitorSink.cpp
index c27f6af..f273740 100644
--- a/plugin/HttpMonitor/MonitorSink.cpp
+++ b/plugin/HttpMonitor/MonitorSink.cpp
@@ -1,7 +1,4 @@
 #include "StdAfx.h"
-#include <Wininet.h>
-#include <string>
-#pragma comment(lib, "Wininet.lib")
 
 #include "plugin.h"
 #include "IEHostWindow.h"
@@ -426,14 +423,18 @@ namespace HttpMonitor
 			CStringW strHeaders(*pszAdditionalHeaders);
 			size_t nOrigLen = strHeaders.GetLength();
 
-			if (abp::AdBlockPlus::shouldSendDNTHeader(m_strURL.GetString()))
+			bool bSendDNT1 = abp::AdBlockPlus::shouldSendDNTHeader(m_strURL.GetString());
+			bool bSendDNT0 = PrefManager::instance().isDNTEnabled() && PrefManager::instance().getDNTValue() == 0;
+			bool bSendDNT = bSendDNT1 || bSendDNT0;
+			int nDNTValue = bSendDNT1 ? 1 : 0;
+			if (bSendDNT)
 			{
 				LPWSTR lpDNT = NULL;
 				size_t nDNTLen = 0;
 				bool hasDNT = false;
 				if (ExtractFieldValue(*pszAdditionalHeaders, L"DNT:", &lpDNT, &nDNTLen))
 				{
-					if (nDNTLen && lpDNT[0] == L'1')
+					if (nDNTLen)
 					{
 						// ѾDNTͷˣټ
 						hasDNT = true;
@@ -442,7 +443,7 @@ namespace HttpMonitor
 				}
 				//  DoNotTrack (DNT) ͷ
 				if (!hasDNT)
-					strHeaders.Append(L"DNT: 1\r\n");
+					strHeaders.AppendFormat(L"DNT: %d\r\n", nDNTValue);
 			}
 
 			if (strHeaders.GetLength() == nOrigLen)
@@ -472,7 +473,9 @@ namespace HttpMonitor
 				if (!m_bIsSubRequest)
 				{
 					if (m_pIEHostWindow)
+					{
 						m_pIEHostWindow->SetLoadingURL(szStatusText);
+					}
 					m_strURL = szStatusText;
 				}
 
diff --git a/plugin/HttpMonitor/MonitorSink.h b/plugin/HttpMonitor/MonitorSink.h
index bfaf0be..d3a3c6a 100644
--- a/plugin/HttpMonitor/MonitorSink.h
+++ b/plugin/HttpMonitor/MonitorSink.h
@@ -1,6 +1,5 @@
 #pragma once
 
-#include <urlmon.h>
 #include "ContentType.h"
 
 class CIEHostWindow;
diff --git a/plugin/IEControlSite.h b/plugin/IEControlSite.h
index 95b5484..847c895 100644
--- a/plugin/IEControlSite.h
+++ b/plugin/IEControlSite.h
@@ -16,11 +16,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 */
 #pragma once
 
-#include <mshtmcid.h>
-#include <mshtmhst.h>
-#include <mshtmdid.h>
-#include <mshtml.h>
-
 class CIEHostWindow;
 
 class CIEControlSite : public COleControlSite
diff --git a/plugin/IEHostWindow.cpp b/plugin/IEHostWindow.cpp
index e6d86a0..025c686 100644
--- a/plugin/IEHostWindow.cpp
+++ b/plugin/IEHostWindow.cpp
@@ -19,9 +19,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 //
 
 #include "stdafx.h"
-#include <mshtml.h>
-#include <exdispid.h>
-#include <comutil.h>
 #include "IEControlSite.h"
 #include "PluginApp.h"
 #include "HttpMonitorApp.h"
@@ -32,11 +29,11 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 #include "re/strutils.h"
 #include "OS.h"
 #include "App.h"
+#include "WindowMessageHook.h"
 
 using namespace UserMessage;
 using namespace Utils;
 using namespace abp;
-using namespace std;
 using namespace re::strutils;
 
 // Initilizes the static member variables of CIEHostWindow
@@ -81,11 +78,9 @@ CIEHostWindow::~CIEHostWindow()
 {
 	SAFE_DELETE(m_pNavigateParams);
 
-	m_csCallables.Lock();
-	for (auto iter = m_qCallables.begin(); iter != m_qCallables.end(); ++iter)
-		delete *iter;
-	m_qCallables.clear();
-	m_csCallables.Unlock();
+	m_csFuncs.Lock();
+	m_qFuncs.clear();
+	m_csFuncs.Unlock();
 }
 
 CIEHostWindow* CIEHostWindow::GetInstance(HWND hwnd)
@@ -150,9 +145,8 @@ CIEHostWindow* CIEHostWindow::CreateNewIEHostWindow(CWnd* pParentWnd, ULONG_PTR
 		}
 		s_csNewIEWindowMap.Unlock();
 	}
-	else 
+	if (!pIEHostWindow)
 	{
-		s_csNewIEWindowMap.Lock();
 		pIEHostWindow = new CIEHostWindow();
 		if (pIEHostWindow == NULL || !pIEHostWindow->Create(CIEHostWindow::IDD, pParentWnd))
 		{
@@ -166,7 +160,6 @@ CIEHostWindow* CIEHostWindow::CreateNewIEHostWindow(CWnd* pParentWnd, ULONG_PTR
 		{
 			pIEHostWindow->m_bUtils = isUtils;
 		}
-		s_csNewIEWindowMap.Unlock();
 	}
 	return pIEHostWindow;
 }
@@ -214,15 +207,13 @@ void CIEHostWindow::SetFirefoxCookie(vector<UserMessage::SetFirefoxCookieParams>
 	CIEHostWindow* pWindow = GetAnyUtilsWindow();
 	if (pWindow)
 	{
-		vector<UserMessage::SetFirefoxCookieParams>* pvParams = 
-			new vector<UserMessage::SetFirefoxCookieParams>(std::move(vCookieParams));
-		pWindow->RunAsync([=]
+		vector<UserMessage::SetFirefoxCookieParams> vParams(std::move(vCookieParams));
+		pWindow->RunAsync([pWindow, vParams]
 		{
 			if (pWindow->m_pPlugin)
 			{
-				pWindow->m_pPlugin->SetFirefoxCookie(*pvParams);
+				pWindow->m_pPlugin->SetFirefoxCookie(vParams);
 			}
-			delete pvParams;
 		});
 	}
 }
@@ -305,6 +296,8 @@ void CIEHostWindow::UninitIE()
 #ifdef MATCHER_PERF
 		AdBlockPlus::showPerfInfo();
 #endif
+		TRACE(L"Remaining windows: IEWindowMap: %d, UtilsIEWindowMap: %d, NewIEWindowMap: %d\n",
+			s_IEWindowMap.GetSize(), s_UtilsIEWindowMap.GetSize(), s_NewIEWindowMap.GetSize());
 	}
 }
 
@@ -323,23 +316,8 @@ LRESULT CIEHostWindow::OnUserMessage(WPARAM wParam, LPARAM lParam)
 	switch(wParam)
 	{
 	case WPARAM_RUN_ASYNC_CALL:
-		{
-			ICallable* callable = NULL;
-			m_csCallables.Lock();
-			if (!m_qCallables.empty())
-			{
-				callable = m_qCallables.front();
-				m_qCallables.pop_front();
-			}
-			m_csCallables.Unlock();
-
-			if (callable)
-			{
-				callable->call();
-				delete callable;
-			}
-			break;
-		}
+		OnRunAsyncCall();
+		break;
 	case WPARAM_ABP_FILTER_LOADED:
 		OnABPFilterLoaded();
 		break;
@@ -419,7 +397,6 @@ void CIEHostWindow::Navigate(const CString& strURL, const CString& strPost, cons
 	m_pNavigateParams->strHeaders = strHeaders;
 	m_csNavigateParams.Unlock();
 
-	//RunAsync([=] { OnNavigate(); });
 	OnNavigate();
 }
 
@@ -700,6 +677,20 @@ void CIEHostWindow::ScrollWheelLine(bool up)
 	}
 }
 
+void CIEHostWindow::RemoveNewWindow(ULONG_PTR ulId)
+{
+	s_csNewIEWindowMap.Lock();
+	CIEHostWindow* pIEHostWindow = s_NewIEWindowMap.Lookup(ulId);
+	s_NewIEWindowMap.Remove(ulId);
+	s_csNewIEWindowMap.Unlock();
+
+	if (pIEHostWindow)
+	{
+		pIEHostWindow->DestroyWindow();
+		delete pIEHostWindow;
+	}
+}
+
 CString CIEHostWindow::GetURL()
 {
 	CString url;
@@ -1077,8 +1068,12 @@ static inline BOOL UrlCanHandle(LPCTSTR szUrl)
 void CIEHostWindow::SetLoadingURL(const CString& url)
 {
 	m_csLoadingUrl.Lock();
+	bool bUrlChanged = (url != m_strLoadingUrl);
 	m_strLoadingUrl = url;
 	m_csLoadingUrl.Unlock();
+
+	if (bUrlChanged)
+		RunAsync([=] { OnURLChanged(url); });
 }
 
 CString CIEHostWindow::GetLoadingURL()
@@ -1089,8 +1084,22 @@ CString CIEHostWindow::GetLoadingURL()
 	return result;
 }
 
+void CIEHostWindow::OnURLChanged(const CString& url)
+{
+	// Fire navigate event so that the extension will have a chance to switch back
+	// before the first "progress changed" event arrives
+	if (m_pPlugin)
+	{
+		m_pPlugin->OnURLChanged(url);
+	}
+}
+
 void CIEHostWindow::OnBeforeNavigate2(LPDISPATCH pDisp, VARIANT* URL, VARIANT* Flags, VARIANT* TargetFrameName, VARIANT* PostData, VARIANT* Headers, BOOL* Cancel)
 {
+	if (!URL) return;
+
+	COLE2T szUrl(URL->bstrVal);
+
 	// Firefoxҳ
 	if (m_pPlugin)
 	{
@@ -1101,10 +1110,6 @@ void CIEHostWindow::OnBeforeNavigate2(LPDISPATCH pDisp, VARIANT* URL, VARIANT* F
 		}
 	}
 
-	if (!URL) return;
-
-	COLE2T szUrl(URL->bstrVal);
-
 	// ˵ HTTP Э
 	if (!UrlCanHandle(szUrl)) return;
 
@@ -1119,6 +1124,7 @@ void CIEHostWindow::OnBeforeNavigate2(LPDISPATCH pDisp, VARIANT* URL, VARIANT* F
 		}
 	}
 
+
 	// Url
 	SetLoadingURL(CString(szUrl));
 	// Clear cached title
@@ -1437,7 +1443,20 @@ void CIEHostWindow::OnNewWindow3Ie(LPDISPATCH* ppDisp, BOOL* Cancel, unsigned lo
 			ULONG_PTR ulId = reinterpret_cast<ULONG_PTR>(pIEHostWindow);
 			s_NewIEWindowMap.Add(ulId, pIEHostWindow);
 			*ppDisp = pIEHostWindow->m_ie.get_Application();
-			m_pPlugin->IENewTab(ulId, bstrUrl);
+
+			bool bShift = 0 != (GetKeyState(VK_SHIFT) & 0x8000);
+			bool bCtrl = (GetKeyState(VK_CONTROL) & 0x8000) || BrowserHook::WindowMessageHook::IsMiddleButtonClicked();
+			if (dwFlags & NWMF_FORCEWINDOW)
+			{
+				// ignore current key states, always open in new window
+				bShift = true;
+				bCtrl = false;
+			}
+			else if (dwFlags & NWMF_FORCETAB)
+			{
+				bCtrl = true;
+			}
+			m_pPlugin->IENewTab(ulId, bstrUrl, bShift, bCtrl);
 		}
 		else
 		{
@@ -2244,3 +2263,15 @@ bool CIEHostWindow::FBRangesEqual(const CComPtr<IHTMLTxtRange>& pRange1, const C
 	// the comparison magically fails = =||
 	return false;
 }
+
+void CIEHostWindow::OnRunAsyncCall()
+{
+	m_csFuncs.Lock();
+	if (!m_qFuncs.empty())
+	{
+		MainThreadFunc& func = m_qFuncs.front();
+		func();
+		m_qFuncs.pop_front();
+	}
+	m_csFuncs.Unlock();
+}
diff --git a/plugin/IEHostWindow.h b/plugin/IEHostWindow.h
index 9b8c4f8..955b8ba 100644
--- a/plugin/IEHostWindow.h
+++ b/plugin/IEHostWindow.h
@@ -20,9 +20,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 #include "IECtrl.h"
 #include "UserMessage.h"
 #include "PointerHash.h"
-#include <vector>
-#include <string>
-#include <deque>
 
 namespace Plugin
 {
@@ -151,6 +148,7 @@ protected:
 	void OnBeforeNavigate2(LPDISPATCH pDisp, VARIANT* URL, VARIANT* Flags, VARIANT* TargetFrameName, VARIANT* PostData, VARIANT* Headers, BOOL* Cancel);
 	void OnDocumentComplete(LPDISPATCH pDisp, VARIANT* URL);
 	void OnNewWindow3Ie(LPDISPATCH* ppDisp, BOOL* Cancel, unsigned long dwFlags, LPCTSTR bstrUrlContext, LPCTSTR bstrUrl);
+	void OnURLChanged(const CString& url);
 
 	void SendKey(WORD vkey);
 	CString GetSelectionTextFromDoc(const CComPtr<IHTMLDocument2>& pDoc);
@@ -207,6 +205,7 @@ public:
 	void ScrollWhole(bool up);
 	void ScrollHorizontal(bool left);
 	void ScrollWheelLine(bool up);
+	static void RemoveNewWindow(ULONG_PTR ulId);
 
 	// FindBar methods
 	void FBFindText(const CString& text);
@@ -313,43 +312,20 @@ protected:
 	/** Ensure the operations on m_strLoadingUrl are thread safe. */
 	CCriticalSection m_csLoadingUrl;
 
-protected:
-	class ICallable;
-	// Keep track of callable instances, make sure the calling is safe.
-	std::deque<ICallable*> m_qCallables;
-	CCriticalSection m_csCallables;
-
-	// Asynchronous function calling, replaces original PostMessage approach
-	// This makes code more readable by putting caller code and callee code together
-
-	// Callable interface for async function calling
-	class ICallable {
-	public:
-		virtual void call() const = 0;
-		virtual ~ICallable() { }
-	};
-
-	// Wraps callable function (typically a lambda expression) into ICallable
-	template<class Func>
-	class CallableFuncWrapper : public ICallable {
-	public:
-		CallableFuncWrapper(const Func& func) : func(func) { }
-		virtual void call() const { func(); }
-	private:
-		Func func;
-	};
-
 public:
-	// Asynchronously run the specified function at next message loop
-	template <class Func>
-	void RunAsync(const Func& func)
-	{
-		ICallable* wrapper = new CallableFuncWrapper<Func>(func);
-		
-		m_csCallables.Lock();
-		m_qCallables.push_back(wrapper);
-		m_csCallables.Unlock();
+	typedef std::function<void()> MainThreadFunc;
+
+	// Asynchronously run the specified function on at next message loop
+	void RunAsync(const MainThreadFunc& func)
+	{		
+		m_csFuncs.Lock();
+		m_qFuncs.push_back(func);
+		m_csFuncs.Unlock();
 
 		PostMessage(UserMessage::WM_USER_MESSAGE, UserMessage::WPARAM_RUN_ASYNC_CALL, 0);
 	}
+private:
+	void OnRunAsyncCall();
+	std::deque<MainThreadFunc> m_qFuncs;
+	CCriticalSection m_csFuncs;
 };
diff --git a/plugin/PassthroughAPP/ProtocolImpl.h b/plugin/PassthroughAPP/ProtocolImpl.h
index 4ac7e3a..80445a3 100644
--- a/plugin/PassthroughAPP/ProtocolImpl.h
+++ b/plugin/PassthroughAPP/ProtocolImpl.h
@@ -19,9 +19,6 @@
   #pragma once
 #endif // _MSC_VER > 1000
 
-#include <urlmon.h>
-#pragma comment(lib, "urlmon.lib")
-
 #include "PassthroughObject.h"
 
 namespace PassthroughAPP
diff --git a/plugin/Plugin/ScriptablePluginObject.cpp b/plugin/Plugin/ScriptablePluginObject.cpp
index 05f701e..e1ef40b 100644
--- a/plugin/Plugin/ScriptablePluginObject.cpp
+++ b/plugin/Plugin/ScriptablePluginObject.cpp
@@ -470,6 +470,27 @@ namespace Plugin
 			pMainWindow->ScrollWheelLine(false);
 			return true;
 		}
+		// void RemoveNewWindow({String} strId)
+		else if (name == NPI_ID(RemoveNewWindow))
+		{
+			TRACE ("RemoveNewWindow called!\n");
+			if (argCount < 1) return false;
+
+			CString strId = _T("");
+			if (NPVARIANT_IS_STRING(args[0]))
+				strId = NPStringToCString(NPVARIANT_TO_STRING(args[0]));
+			else
+				return false;
+
+			ULONG_PTR ulId = 
+#ifdef _M_X64
+				_tcstoui64(strId, NULL, 10);
+#else
+				_tcstoul(strId, NULL, 10);
+#endif
+			CIEHostWindow::RemoveNewWindow(ulId);
+			return true;
+		}
 		// void FBFindText({String} text)
 		else if (name == NPI_ID(FBFindText))
 		{
@@ -625,6 +646,22 @@ namespace Plugin
 			PrefManager::instance().setDNTEnabled(enabled);
 			return true;
 		}
+		// void SetDNTValue({int} value)
+		else if (name == NPI_ID(SetDNTValue))
+		{
+			TRACE ("SetDNTValue called!\n");
+			if (argCount < 1) return false;
+
+			int value;
+
+			if (NPVARIANT_IS_INT32(args[0]))
+				value = NPVARIANT_TO_INT32(args[0]);
+			else
+				return false;
+
+			PrefManager::instance().setDNTValue(value);
+			return true;
+		}
 		// void ABPEnable()
 		else if (name == NPI_ID(ABPEnable))
 		{
diff --git a/plugin/Plugin/ScriptablePluginObject.h b/plugin/Plugin/ScriptablePluginObject.h
index ff7224e..e24f53d 100644
--- a/plugin/Plugin/ScriptablePluginObject.h
+++ b/plugin/Plugin/ScriptablePluginObject.h
@@ -17,7 +17,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 #pragma once
 
 #include "ScriptablePluginObjectBase.h"
-#include <set>
 
 #define NPI_ID(id) m_##id##ID
 #define NPI_DEF(id) NPIdentifier NPI_ID(id)
@@ -66,6 +65,7 @@ namespace Plugin
 		NPI_DEF(ScrollRight);
 		NPI_DEF(ScrollWheelUp);
 		NPI_DEF(ScrollWheelDown);
+		NPI_DEF(RemoveNewWindow);
 
 		// findbar methods
 		NPI_DEF(FBFindText); // FB stands for firefox FindBar
@@ -80,6 +80,8 @@ namespace Plugin
 		NPI_DEF(SetEnabledGestures);
 		NPI_DEF(SetCookieSyncEnabled);
 		NPI_DEF(SetDNTEnabled);
+		NPI_DEF(SetDNTValue);
+
 		// ABP methods
 		NPI_DEF(ABPEnable);
 		NPI_DEF(ABPDisable);
@@ -149,6 +151,7 @@ namespace Plugin
 			NPN_GSI_M(ScrollRight);
 			NPN_GSI_M(ScrollWheelUp);
 			NPN_GSI_M(ScrollWheelDown);
+			NPN_GSI_M(RemoveNewWindow);
 			NPN_GSI_M(FBFindText);
 			NPN_GSI_M(FBEndFindText);
 			NPN_GSI_M(FBFindAgain);
@@ -159,6 +162,7 @@ namespace Plugin
 			NPN_GSI_M(SetEnabledGestures);
 			NPN_GSI_M(SetCookieSyncEnabled);
 			NPN_GSI_M(SetDNTEnabled);
+			NPN_GSI_M(SetDNTValue);
 			NPN_GSI_M(ABPEnable);
 			NPN_GSI_M(ABPDisable);
 			NPN_GSI_M(ABPLoad);
diff --git a/plugin/Plugin/comfix.cpp b/plugin/Plugin/comfix.cpp
index 8c7e6f1..a4a9676 100644
--- a/plugin/Plugin/comfix.cpp
+++ b/plugin/Plugin/comfix.cpp
@@ -26,7 +26,8 @@ using namespace Plugin;
 
 const TCHAR* COMFix::s_astrCLSID[] = {
 	_T("{ED4CA2E5-0EEA-44C1-AD7E-74A07A7507A4}"), // TimwpDll.TimwpCheck
-	_T("{23752AA7-CAD7-40C2-99EE-7A9CD3C20C6D}")  // QQCPHelper.CPAdder
+	_T("{23752AA7-CAD7-40C2-99EE-7A9CD3C20C6D}"), // QQCPHelper.CPAdder
+	_T("{62B4D041-4667-40B6-BB50-4BC0A5043A73}")  // SharePoint Export Database Launcher
 };
 
 const int COMFix::s_cntCLSID = sizeof(s_astrCLSID) / sizeof(s_astrCLSID[0]);
diff --git a/plugin/Plugin/plugin.cpp b/plugin/Plugin/plugin.cpp
index 7aaf0e7..e2be2fb 100644
--- a/plugin/Plugin/plugin.cpp
+++ b/plugin/Plugin/plugin.cpp
@@ -40,8 +40,6 @@
 // CPlugin class implementation
 //
 #include "stdafx.h"
-#include <windows.h>
-#include <windowsx.h>
 #include "IEHostWindow.h"
 #include "plugin.h"
 #include "npfunctions.h"
@@ -54,7 +52,6 @@
 #include "test/test.h"
 #endif
 
-using namespace std;
 using namespace UserMessage;
 
 namespace Plugin
@@ -171,7 +168,7 @@ namespace Plugin
 		{
 			// cannot directly fire the event since the plugin is not fully constructed 
 			// - we are still in the initializer
-			m_pIEHostWindow->RunAsync([=] { OnUtilsPluginInit(); });
+			m_pIEHostWindow->RunAsync([this] { OnUtilsPluginInit(); });
 		}
 		else
 		{
@@ -179,7 +176,7 @@ namespace Plugin
 
 			// cannot directly fire the event since the plugin is not fully constructed 
 			// - we are still in the initializer
-			m_pIEHostWindow->RunAsync([=] { OnContentPluginInit(); });
+			m_pIEHostWindow->RunAsync([this] { OnContentPluginInit(); });
 		}
 
 		return TRUE;
@@ -401,11 +398,11 @@ namespace Plugin
 	// Get CIEHostWindow ID
 	ULONG_PTR CPlugin::GetNavigateWindowId() const
 	{
-		CString strID = GetNavigateParam("getNavigateWindowId");
+		CString strId = GetNavigateParam("getNavigateWindowId");
 #ifdef _M_X64
-		return _tcstoui64(strID, NULL, 10);
+		return _tcstoui64(strId, NULL, 10);
 #else
-		return _tcstoul(strID, NULL, 10);
+		return _tcstoul(strId, NULL, 10);
 #endif
 	}
 
@@ -658,11 +655,16 @@ namespace Plugin
 		NPN_MemFree(url);
 	}
 
-	void CPlugin::IENewTab(ULONG_PTR ulId, const CString& strURL)
+	void CPlugin::IENewTab(ULONG_PTR ulId, const CString& strURL, bool bShift, bool bCtrl)
 	{
 		CString strEventType = _T("IENewTab");
 		CString strDetail;
-		strDetail.Format(_T("{\"id\": \"%d\", \"url\": \"%s\"}"), ulId, strURL);
+		
+		// Retrieve additional info for cursor & keyboard state
+		CString strShift = bShift ? _T("true") : _T("false");
+		CString strCtrl = bCtrl ? _T("true") : _T("false");
+		strDetail.Format(_T("{\"id\": \"%d\", \"url\": \"%s\", \"shift\": %s, \"ctrl\": %s}"),
+			ulId, strURL, strShift, strCtrl);
 		FireEvent(strEventType, strDetail);
 	}
 
@@ -736,4 +738,11 @@ namespace Plugin
 		CString strDetail = _T("");
 		FireEvent(strEventType, strDetail);
 	}
+
+	void CPlugin::OnURLChanged(const CString& url)
+	{
+		CString strEventType = _T("IEURLChanged");
+		CString strDetail = url;
+		FireEvent(strEventType, strDetail);
+	}
 }
diff --git a/plugin/Plugin/plugin.h b/plugin/Plugin/plugin.h
index 4326e53..ade9054 100644
--- a/plugin/Plugin/plugin.h
+++ b/plugin/Plugin/plugin.h
@@ -42,7 +42,6 @@
 #include "PluginApp.h"
 #include "pluginbase.h"
 #include "UserMessage.h"
-#include <vector>
 
 class CIEHostWindow;
 
@@ -139,8 +138,10 @@ namespace Plugin
 		 * Create a new IE engine tab in the Firefox to load the given CIEHostWindow.
 		 * @param ulId The ID of the CIEHostWindow object.
 		 * @param strURL The page URL to be loaded in the new tab.
+		 * @param bShift Whether the shift key is pressed when the request is made
+		 * @param bCtrl Whether the ctrl key is pressed when the request is made
 		 */
-		void IENewTab(ULONG_PTR ulId, const CString& strURL);
+		void IENewTab(ULONG_PTR ulId, const CString& strURL, bool bShift, bool bCtrl);
 
 		/** Close current IE engie tab. */
 		void CloseIETab();
@@ -168,6 +169,9 @@ namespace Plugin
 
 		/** AdBlock Plus filters failed load */
 		void OnABPLoadFailure();
+
+		/** IE engine URL changed */
+		void OnURLChanged(const CString& url);
 	protected:
 
 		NPP m_pNPInstance;
diff --git a/plugin/PrefManager.h b/plugin/PrefManager.h
index 3517271..a6ad904 100644
--- a/plugin/PrefManager.h
+++ b/plugin/PrefManager.h
@@ -24,11 +24,13 @@ class PrefManager {
 private:
 	bool m_bCookieSyncEnabled;
 	bool m_bDNTEnabled;
+	int m_nDNTValue;
 
 	PrefManager()
 	{
 		m_bCookieSyncEnabled = true;
 		m_bDNTEnabled = false;
+		m_nDNTValue = 1;
 	}
 	PrefManager(const PrefManager&);
 
@@ -40,5 +42,8 @@ public:
 	bool isDNTEnabled() const { return m_bDNTEnabled; }
 	void setDNTEnabled(bool value) { m_bDNTEnabled = value; }
 
+	int getDNTValue() const { return m_nDNTValue; }
+	void setDNTValue(int value) { m_nDNTValue = value; }
+
 	static PrefManager& instance() { return s_instance; }
 };
diff --git a/plugin/Utils/File.cpp b/plugin/Utils/File.cpp
index 69d3ae9..a27faaf 100644
--- a/plugin/Utils/File.cpp
+++ b/plugin/Utils/File.cpp
@@ -22,7 +22,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 
 #include "File.h"
 
-using namespace std;
 using namespace Utils;
 
 // do not process files larger than 20MB
diff --git a/plugin/Utils/File.h b/plugin/Utils/File.h
index 65b6fe0..614d6f7 100644
--- a/plugin/Utils/File.h
+++ b/plugin/Utils/File.h
@@ -20,8 +20,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 // File.h : file reading utilities
 //
 
-#include <string>
-
 namespace Utils {
 	// file reading utilities
 	class File {
diff --git a/plugin/Utils/PointerHash.h b/plugin/Utils/PointerHash.h
index 36344c8..c088b87 100644
--- a/plugin/Utils/PointerHash.h
+++ b/plugin/Utils/PointerHash.h
@@ -20,8 +20,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 // PointerHash.h : Hasher and Equality comparator definition for pointer types
 //
 
-#include <xhash>
-
 namespace Utils {
 	extern std::hash<size_t> size_t_hasher;
 
diff --git a/plugin/Utils/TLD.cpp b/plugin/Utils/TLD.cpp
index 41f2a90..fc13803 100644
--- a/plugin/Utils/TLD.cpp
+++ b/plugin/Utils/TLD.cpp
@@ -26,10 +26,9 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 #include "File.h"
 
 namespace Utils {
-	const regdom::tldnode* rootTLDNode = NULL;
+	static const regdom::tldnode* rootTLDNode = NULL;
 }
 
-using namespace std;
 using namespace Utils;
 
 TLD::TLDInit TLD::init;
diff --git a/plugin/Utils/URL.cpp b/plugin/Utils/URL.cpp
index 39df1a8..f1f1054 100644
--- a/plugin/Utils/URL.cpp
+++ b/plugin/Utils/URL.cpp
@@ -23,12 +23,10 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 #include "TLD.h"
 #include "re/RegExp.h"
 #include "re/strutils.h"
-#include <algorithm>
 
 using namespace Utils;
 using namespace re;
 using namespace re::strutils;
-using namespace std;
 
 namespace Utils {
 
@@ -86,18 +84,18 @@ const RegExp URLTokenizer::tokenizerRegExp = L"/^(?=[^&])(?:([^:\\/?#]+):)?(?:\\
 
 bool URLTokenizer::tokenize(const wstring& url)
 {
-	RegExpMatch* match = tokenizerRegExp.exec(url);
-	if (match)
+	RegExpMatch match;
+	bool ret = tokenizerRegExp.exec(match, url);
+	if (ret)
 	{
-		protocol = match->substrings[1];
-		username = match->substrings[2];
-		password = match->substrings[3];
-		domain   = match->substrings[4];
-		port     = match->substrings[5];
-		path     = match->substrings[6];
-		query    = match->substrings[7];
-		anchor   = match->substrings[8];
-		delete match;
+		protocol = match.substrings[1];
+		username = match.substrings[2];
+		password = match.substrings[3];
+		domain   = match.substrings[4];
+		port     = match.substrings[5];
+		path     = match.substrings[6];
+		query    = match.substrings[7];
+		anchor   = match.substrings[8];
 		return true;
 	}
 	else
diff --git a/plugin/Utils/URL.h b/plugin/Utils/URL.h
index 6333730..221a432 100644
--- a/plugin/Utils/URL.h
+++ b/plugin/Utils/URL.h
@@ -20,8 +20,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 // URL.h : URL utilities
 //
 
-#include <string>
-
 namespace re {
 	class RegExp;
 }
diff --git a/plugin/abp/AdBlockPlus.cpp b/plugin/abp/AdBlockPlus.cpp
index 7a17fac..8af1e41 100644
--- a/plugin/abp/AdBlockPlus.cpp
+++ b/plugin/abp/AdBlockPlus.cpp
@@ -29,11 +29,8 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 #include "File.h"
 #include "IEHostWindow.h"
 #include "PrefManager.h"
-#include <map>
-#include <unordered_set>
 
 using namespace abp;
-using namespace std;
 using namespace re;
 using namespace strutils;
 
@@ -128,7 +125,7 @@ bool AdBlockPlus::shouldLoad(const wstring& location, ContentType_T contentType,
 
 bool AdBlockPlus::shouldSendDNTHeader(const wstring& location)
 {
-	if (PrefManager::instance().isDNTEnabled()) return true;
+	if (PrefManager::instance().isDNTEnabled() && PrefManager::instance().getDNTValue() == 1) return true;
 	if (!s_bEnabled) return false;
 
 	ReaderLock rl(s_mutex);
@@ -235,19 +232,18 @@ namespace abp {
 		static const wstring strTrue = L"true";
 		static const wstring strLeftBracket = L"[";
 
-		RegExpMatch* match = NULL;
-		if (wantObj && (match = re1.exec(line)))
+		RegExpMatch match;
+		bool ret = false;
+		if (wantObj && re1.exec(match, line))
 		{
-			curObj[match->substrings[1]] = match->substrings[2];
-			delete match;
+			curObj[match.substrings[1]] = match.substrings[2];
 		}
-		else if (eof || (match = re2.exec(line)))
+		else if (eof || (ret = re2.exec(match, line)))
 		{
 			wstring strSection;
-			if (match)
+			if (ret)
 			{
-				strSection = toLowerCase(match->substrings[1]);
-				delete match;
+				strSection = toLowerCase(match.substrings[1]);
 			}
 			if (wantObj ? curObj.size() : curList.size())
 			{
@@ -391,14 +387,22 @@ unsigned int AdBlockPlus::asyncLoader(void* ppathname)
 	// Notify main thread about load completion
 	CIEHostWindow* pWindow = CIEHostWindow::GetAnyUtilsWindow();
 	if (pWindow)
+	{
 		pWindow->RunAsync([=]
 		{
+			// filterLoadedCallback() should be called on the main thread
+			// to ensure atomicity;
+			// Must call the callback before sending the message
 			filterLoadedCallback(loaded);
 			pWindow->SendMessage(UserMessage::WM_USER_MESSAGE,
 				loaded ? UserMessage::WPARAM_ABP_FILTER_LOADED : UserMessage::WPARAM_ABP_LOAD_FAILURE, 0);
 		});
+	}
 	else
+	{
+		// Just a fallback, may never get to here
 		filterLoadedCallback(loaded);
+	}
 
 	return 0;
 }
diff --git a/plugin/abp/AdBlockPlus.h b/plugin/abp/AdBlockPlus.h
index 3116a00..0e8374e 100644
--- a/plugin/abp/AdBlockPlus.h
+++ b/plugin/abp/AdBlockPlus.h
@@ -20,7 +20,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 // AdBlockPlus.h : necessary ABP control routines
 //
 
-#include <string>
 #include "FilterContentType.h"
 #include "Matcher.h"
 #include "ElemHideMatcher.h"
diff --git a/plugin/abp/ElemHideMatcher.cpp b/plugin/abp/ElemHideMatcher.cpp
index ce938af..ef42396 100644
--- a/plugin/abp/ElemHideMatcher.cpp
+++ b/plugin/abp/ElemHideMatcher.cpp
@@ -25,7 +25,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 #include "re/strutils.h"
 
 using namespace abp;
-using namespace std;
 using namespace re::strutils;
 
 const size_t ElemHideMatcher::maxCacheEntries = 1000;
diff --git a/plugin/abp/ElemHideMatcher.h b/plugin/abp/ElemHideMatcher.h
index df3801f..e13f2e0 100644
--- a/plugin/abp/ElemHideMatcher.h
+++ b/plugin/abp/ElemHideMatcher.h
@@ -21,10 +21,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 //
 
 #include "TList.h"
-#include <string>
-#include <vector>
-#include <unordered_map>
-#include <unordered_set>
 
 namespace abp {
 	class ElemHideFilter;
diff --git a/plugin/abp/FilterClasses.cpp b/plugin/abp/FilterClasses.cpp
index 3df7db2..7da5cdd 100644
--- a/plugin/abp/FilterClasses.cpp
+++ b/plugin/abp/FilterClasses.cpp
@@ -22,12 +22,10 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 
 #include "FilterClasses.h"
 #include "re/strutils.h"
-#include <algorithm>
 
 using namespace abp;
 using namespace re;
 using namespace re::strutils;
-using namespace std;
 
 static const wstring strEmpty = L"";
 
@@ -71,13 +69,12 @@ Filter* Filter::fromText(const wstring& text)
 		return iter->second;
 
 	Filter* ret = NULL;
-	RegExpMatch* match = (text.find(L'#') != wstring::npos ? elemhideRegExp.exec(text) : NULL);
-	if (match)
+	RegExpMatch match;
+	if (text.find(L'#') != wstring::npos && elemhideRegExp.exec(match, text))
 	{
-		const vector<wstring>& substrings = match->substrings;
+		const vector<wstring>& substrings = match.substrings;
 		ret = ElemHideBase::fromText(text, substrings[1], 0 != substrings[2].length(), substrings[3],
 			substrings[4], substrings[5]);
-		delete match;
 	}
 	else if (startsWithChar(text, L'!'))
 	{
@@ -149,15 +146,14 @@ wstring Filter::normalize(const wstring& text)
 	else if (elemhideRegExp.test(res))
 	{
 		// Special treatment for element hiding filters, right side is allowed to contain spaces
-		RegExpMatch* match = re5.exec(res);
-		if (match)
+		RegExpMatch match;
+		if (re5.exec(match, res))
 		{
-			const wstring& domain = match->substrings[1];
-			const wstring& separator = match->substrings[2];
-			const wstring& selector = match->substrings[3];
+			const wstring& domain = match.substrings[1];
+			const wstring& separator = match.substrings[2];
+			const wstring& selector = match.substrings[3];
 			res = replace(domain, re6, strEmpty) + separator
 				+ replace(replace(selector, re3, strEmpty), re4, strEmpty);
-			delete match;
 		}
 		return res;
 	}
@@ -446,12 +442,11 @@ Filter* RegExpFilter::fromText(const wstring& text)
 	TriBool thirdParty = TriNull;
 	TriBool collapse = TriNull;
 	vector<wstring> options;
-	RegExpMatch* match = regexpSource.find(L'$') != wstring::npos ? Filter::optionsRegExp.exec(regexpSource) : NULL;
-	if (match)
+	RegExpMatch match;
+	if (regexpSource.find(L'$') != wstring::npos && Filter::optionsRegExp.exec(match, regexpSource))
 	{
-		options = split(toUpperCase(match->substrings[1]), strComma);
-		regexpSource = match->input.substr(0, match->index);
-		delete match;
+		options = split(toUpperCase(match.substrings[1]), strComma);
+		regexpSource = match.input.substr(0, match.index);
 
 		for (size_t i = 0; i < options.size(); i++)
 		{
@@ -587,10 +582,11 @@ Filter* ElemHideBase::fromText(const wstring& text, const wstring& domain, bool
 		wstring additional = strEmpty;
 		if (attrRules.length())
 		{
-			RegExpMatch* match = strutils::match(attrRules, re1);
-			for (size_t i = 0; i < match->substrings.size(); i++)
+			RegExpMatch match;
+			strutils::match(match, attrRules, re1);
+			for (size_t i = 0; i < match.substrings.size(); i++)
 			{
-				wstring rule = match->substrings[i];
+				wstring rule = match.substrings[i];
 				size_t separatorPos = rule.find(L'=');
 				if (separatorPos != wstring::npos && separatorPos > 0)
 				{
@@ -604,14 +600,12 @@ Filter* ElemHideBase::fromText(const wstring& text, const wstring& domain, bool
 				{
 					if (id.length())
 					{
-						delete match;
 						return new InvalidFilter(text, L"Duplicate ID");
 					}
 					else
 						id = rule;
 				}
 			}
-			delete match;
 		}
 
 		if (id.length())
diff --git a/plugin/abp/FilterClasses.h b/plugin/abp/FilterClasses.h
index 60e2b25..5adef84 100644
--- a/plugin/abp/FilterClasses.h
+++ b/plugin/abp/FilterClasses.h
@@ -25,9 +25,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 #include "TriBool.h"
 #include "FilterContentType.h"
 #include "PointerHash.h"
-#include <unordered_map>
-#include <map>
-#include <vector>
 
 namespace abp {
 	// Forward declaration
diff --git a/plugin/abp/Matcher.cpp b/plugin/abp/Matcher.cpp
index 3a0f5b3..b29ec4f 100644
--- a/plugin/abp/Matcher.cpp
+++ b/plugin/abp/Matcher.cpp
@@ -27,7 +27,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 using namespace abp;
 using namespace re;
 using namespace re::strutils;
-using namespace std;
 
 static const wstring strEmpty = L"";
 
@@ -87,22 +86,20 @@ wstring Matcher::findKeyword(RegExpFilter* filter) const
 		return defaultResult;
 
 	// Remove options
-	RegExpMatch* match = Filter::optionsRegExp.exec(text);
-	if (match)
+	RegExpMatch match;
+	if (Filter::optionsRegExp.exec(match, text))
 	{
-		text = match->input.substr(0, match->index);
-		delete match;
+		text = match.input.substr(0, match.index);
 	}
 
 	// Remove whitelist marker
 	if (startsWith(text, strAtAt))
 		text = text.substr(2);
 
-	RegExpMatch* candidateMatch = strutils::match(toLowerCase(text), re1);
-	if (!candidateMatch)
+	if (!strutils::match(match, toLowerCase(text), re1))
 		return defaultResult;
 
-	const std::vector<wstring>& candidates = candidateMatch->substrings;
+	const std::vector<wstring>& candidates = match.substrings;
 	const unordered_map<wstring, FList>& hash = filterByKeyword;
 	wstring result = defaultResult;
 	int resultCount = 0xFFFFFF;
@@ -119,7 +116,6 @@ wstring Matcher::findKeyword(RegExpFilter* filter) const
 			resultLength = (int)candidate.length();
 		}
 	}
-	delete candidateMatch;
 
 	return result;
 }
@@ -178,10 +174,10 @@ RegExpFilter* Matcher::matchesAny(const wstring& location, ContentType_T content
 {
 	using namespace funcStatic::Matcher_matchesAny;
 
-	RegExpMatch* candidateMatch = match(toLowerCase(location), re1);
+	RegExpMatch candidateMatch;
+	bool ret = match(candidateMatch, toLowerCase(location), re1);
 	vector<wstring> candidates;
-	if (candidateMatch) candidates = std::move(candidateMatch->substrings);
-	delete candidateMatch;
+	if (ret) candidates = std::move(candidateMatch.substrings);
 
 	RegExpFilter* res = NULL;
 	if (contentType & DONOTTRACK)
@@ -338,10 +334,10 @@ RegExpFilter* CombinedMatcher::matchesAnyInternal(const wstring& location, Conte
 {
 	using namespace funcStatic::CombinedMatcher_matchesAnyInternal;
 
-	RegExpMatch* candidateMatch = match(toLowerCase(location), re1);
+	RegExpMatch candidateMatch;
+	bool ret = match(candidateMatch, toLowerCase(location), re1);
 	vector<wstring> candidates;
-	if (candidateMatch) candidates = std::move(candidateMatch->substrings);
-	delete candidateMatch;
+	if (ret) candidates = std::move(candidateMatch.substrings);
 
 	RegExpFilter* blacklistHit = NULL;
 	RegExpFilter* result = NULL;
diff --git a/plugin/abp/Matcher.h b/plugin/abp/Matcher.h
index 96bb86c..62c8039 100644
--- a/plugin/abp/Matcher.h
+++ b/plugin/abp/Matcher.h
@@ -20,9 +20,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 // Matcher.h : ABP filter matching engine
 //
 
-#include <string>
-#include <unordered_map>
-#include <vector>
 #include "FilterClasses.h"
 #include "TList.h"
 #include "RAIILock.h"
diff --git a/plugin/abp/RAIILock.cpp b/plugin/abp/RAIILock.cpp
index bf51a2e..ae96dc4 100644
--- a/plugin/abp/RAIILock.cpp
+++ b/plugin/abp/RAIILock.cpp
@@ -21,7 +21,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 #include "StdAfx.h"
 
 #include "RAIILock.h"
-#include <deque>
 
 using namespace abp;
 
diff --git a/plugin/abp/TList.h b/plugin/abp/TList.h
index 21dbbdf..b33a003 100644
--- a/plugin/abp/TList.h
+++ b/plugin/abp/TList.h
@@ -22,9 +22,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 //          It is designed merely for primitive types (including pointers).
 //
 
-#include <vector>
-#include <algorithm>
-
 namespace abp {
 
 	template<class T>
diff --git a/plugin/plugin.rc b/plugin/plugin.rc
index 8e07120..6ee50fe 100644
--- a/plugin/plugin.rc
+++ b/plugin/plugin.rc
@@ -131,8 +131,8 @@ LANGUAGE LANG_ENGLISH, SUBLANG_ENGLISH_US
 //
 
 VS_VERSION_INFO VERSIONINFO
- FILEVERSION 1,3,3,1
- PRODUCTVERSION 1,3,3,1
+ FILEVERSION 1,3,4,3
+ PRODUCTVERSION 1,3,4,3
  FILEFLAGSMASK 0x3fL
 #ifdef _DEBUG
  FILEFLAGS 0x1L
@@ -150,13 +150,13 @@ BEGIN
             VALUE "CompanyName", "fireie@fireie.org"
             VALUE "FileDescription", "Fire IE DLL"
             VALUE "FileExtents", "*"
-            VALUE "FileVersion", "1.3.3.1"
+            VALUE "FileVersion", "1.3.4.3"
             VALUE "InternalName", "npfireie.dll"
             VALUE "LegalCopyright", "Copyright (C) 2012-2013 fireie.org"
             VALUE "MIMEType", "application/fireie"
             VALUE "OriginalFilename", "npfireie.dll"
             VALUE "ProductName", "Fire IE DLL"
-            VALUE "ProductVersion", "1.3.3.1"
+            VALUE "ProductVersion", "1.3.4.3"
         END
     END
     BLOCK "VarFileInfo"
diff --git a/plugin/re/RegExp.cpp b/plugin/re/RegExp.cpp
index 0ab35e4..74517b8 100644
--- a/plugin/re/RegExp.cpp
+++ b/plugin/re/RegExp.cpp
@@ -26,7 +26,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 
 using namespace re;
 using namespace jscre;
-using namespace std;
 using namespace strutils;
 
 static void* (*jscre_malloc)(size_t size) = malloc;
@@ -41,8 +40,8 @@ RegExp::RegExp()
 }
 
 RegExp::RegExp(const wstring& strFullPattern)
+	: m_strFullPattern(strFullPattern)
 {
-	m_strFullPattern = strFullPattern;
 	m_bCompiled = false;
 	m_re = NULL;
 	setAttributes();
@@ -50,8 +49,8 @@ RegExp::RegExp(const wstring& strFullPattern)
 }
 
 RegExp::RegExp(const RegExp& other)
+	: m_strFullPattern(other.m_strFullPattern)
 {
-	m_strFullPattern = other.m_strFullPattern;
 	m_bIgnoreCase = other.m_bIgnoreCase;
 	m_bMultiLine = other.m_bMultiLine;
 	m_bGlobal = other.m_bGlobal;
@@ -63,6 +62,24 @@ RegExp::RegExp(const RegExp& other)
 		compile();
 }
 
+RegExp::RegExp(RegExp&& other)
+	: m_strFullPattern(std::move(other.m_strFullPattern))
+{
+	m_bIgnoreCase = other.m_bIgnoreCase;
+	m_bMultiLine = other.m_bMultiLine;
+	m_bGlobal = other.m_bGlobal;
+	m_nLastPos = other.m_nLastPos;
+
+	// compiled information
+	m_bCompiled = other.m_bCompiled;
+	m_re = other.m_re;
+	m_nSubPatterns = other.m_nSubPatterns;
+
+	// leave destructable state
+	other.m_re = NULL;
+	other.m_bCompiled = false;
+}
+
 RegExp& RegExp::operator=(const RegExp& other)
 {
 	if (this == &other) return *this;
@@ -83,6 +100,30 @@ RegExp& RegExp::operator=(const RegExp& other)
 	return *this;
 }
 
+RegExp& RegExp::operator=(RegExp&& other)
+{
+	if (this == &other) return *this;
+
+	if (m_re) jsRegExpFree(m_re, jscre_free);
+
+	m_strFullPattern = std::move(other.m_strFullPattern);
+	m_bIgnoreCase = other.m_bIgnoreCase;
+	m_bMultiLine = other.m_bMultiLine;
+	m_bGlobal = other.m_bGlobal;
+	m_nLastPos = other.m_nLastPos;
+
+	// compiled information
+	m_bCompiled = other.m_bCompiled;
+	m_re = other.m_re;
+	m_nSubPatterns = other.m_nSubPatterns;
+
+	// leave destructable state
+	other.m_re = NULL;
+	other.m_bCompiled = false;
+
+	return *this;
+}
+
 RegExp& RegExp::operator=(const wstring& strFullPattern)
 {
 	compile(strFullPattern);
@@ -136,84 +177,83 @@ void RegExp::compile(const wstring& strFullPattern, const wstring& strAttributes
 	compile();
 }
 
-RegExpMatch* RegExp::exec(const wstring& str)
+bool RegExp::exec(RegExpMatch& match, const wstring& str)
 {
-	return exec(str, m_nLastPos);
+	return exec(match, str, m_nLastPos);
 }
 
-RegExpMatch* RegExp::exec(const wstring& str, int lastPos)
+bool RegExp::exec(RegExpMatch& match, const wstring& str, int lastPos)
 {
 	if (!m_bCompiled) compile();
-	RegExpMatch* match = execCore(str, lastPos);
+	bool ret = execCore(match, str, lastPos);
 	if (m_bGlobal)
 	{
 		// should record last match position
-		if (match)
+		if (ret)
 		{
-			int advance = (int)match->substrings[0].length();
+			int advance = (int)match.substrings[0].length();
 			if (advance < 1) advance = 1;
-			m_nLastPos = match->index + advance;
+			m_nLastPos = match.index + advance;
 		}
 		else
 			m_nLastPos = 0;
 	}
-	return match;
+	return ret;
 }
 
-RegExpMatch* RegExp::exec(const wstring& str) const
+bool RegExp::exec(RegExpMatch& match, const wstring& str) const
 {
-	return exec(str, m_nLastPos);
+	return exec(match, str, m_nLastPos);
 }
 
-RegExpMatch* RegExp::exec(const wstring& str, int lastPos) const
+bool RegExp::exec(RegExpMatch& match, const wstring& str, int lastPos) const
 {
 	if (!m_bCompiled) throw RegExpCompileError("cannot compile in constant function");
-	return execCore(str, lastPos);
+	return execCore(match, str, lastPos);
 }
 
-RegExpMatch* RegExp::execCore(const wstring& str, int lastPos) const
+//RegExpMatch* RegExp::execCore(const wstring& str, int lastPos) const
+bool RegExp::execCore(RegExpMatch& match, const std::wstring& str, int lastPos) const
 {
+	static const int OFFSET_LENGTH = 10000 * 3;
+	int offsets[OFFSET_LENGTH];
 	int numBackRefs = (int)m_nSubPatterns;
-	int offsetLength = (numBackRefs + 1) * 3;
-	int* offsets = new int[offsetLength];
 
-	int ret;
-	do {
-		ret = jsRegExpExecute(m_re, (const UChar*)str.c_str(), (int)str.length(), lastPos, offsets, offsetLength);
-		if (ret < 0) // Error or no match
-		{
-			delete [] offsets;
-			return NULL;
-		}
-		if (ret == 0) // offsets overflow, re-allocate the array and run again
-		{
-			delete [] offsets;
-			offsetLength *= 2;
-			offsets = new int[offsetLength];
-		}
-	} while (ret == 0);
+	int ret = jsRegExpExecute(m_re, (const UChar*)str.c_str(), (int)str.length(), lastPos, offsets, OFFSET_LENGTH);
+	if (ret < 0) // Error or no match
+	{
+		return false;
+	}
+
+	// Ensure offsets don't overflow
+	if (ret == 0)
+	{
+		ASSERT(false);
+		return false;
+	}
 
 	numBackRefs = ret - 1;
 
 	// Matches
-	RegExpMatch* match = new RegExpMatch();
-	match->index = offsets[0];
-	match->input = str;
-	match->substrings.reserve(m_nSubPatterns + 1);
-	match->substrings.push_back(str.substr(offsets[0], offsets[1] - offsets[0]));
+	match.index = offsets[0];
+	match.input = str;
+	match.substrings.clear();
+	match.substrings.reserve(m_nSubPatterns + 1);
+	size_t pos = static_cast<size_t>(offsets[0]);
+	size_t count = static_cast<size_t>(offsets[1] - offsets[0]);
+	match.substrings.push_back(str.substr(pos, count));
 	for (int i = 1; i <= numBackRefs; i++)
 	{
 		int l = offsets[i * 2], r = offsets[i * 2 + 1];
 		if (l >= 0 && r >= l && r <= (int)str.length())
-			match->substrings.push_back(str.substr(l, r - l));
-		else match->substrings.push_back(L"");
+			match.substrings.push_back(str.substr(l, r - l));
+		else match.substrings.push_back(L"");
 	}
 	for (int i = numBackRefs + 1; i <= (int)m_nSubPatterns; i++)
 	{
-		match->substrings.push_back(L"");
+		match.substrings.push_back(L"");
 	}
-	delete [] offsets;
-	return match;
+	return true;
 }
 
 bool RegExp::test(const wstring& str)
diff --git a/plugin/re/RegExp.h b/plugin/re/RegExp.h
index ebf1b36..71fb575 100644
--- a/plugin/re/RegExp.h
+++ b/plugin/re/RegExp.h
@@ -20,10 +20,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 // RegExp.h : regular expression matching engine
 //
 
-#include <string>
-#include <vector>
-#include <stdexcept>
-
 namespace jscre {
 	struct JSRegExp;
 }
@@ -34,6 +30,30 @@ struct RegExpMatch {
 	int index;
 	std::wstring input;
 	std::vector<std::wstring> substrings;
+
+	RegExpMatch() {}
+	RegExpMatch(const RegExpMatch& match)
+		: index(match.index), input(match.input),
+		  substrings(match.substrings) { }
+	RegExpMatch(RegExpMatch&& match)
+		: index(match.index), input(std::move(match.input)),
+		  substrings(std::move(match.substrings)) { }
+	RegExpMatch& operator=(const RegExpMatch& match)
+	{
+		index = match.index;
+		input = match.input;
+		substrings = match.substrings;
+
+		return *this;
+	}
+	RegExpMatch& operator=(RegExpMatch&& match)
+	{
+		index = match.index;
+		input = std::move(match.input);
+		substrings = std::move(match.substrings);
+
+		return *this;
+	}
 };
 
 class RegExp {
@@ -41,9 +61,11 @@ public:
 	RegExp();
 	RegExp(const std::wstring& strFullPattern);
 	RegExp(const RegExp&);
+	RegExp(RegExp&&);
 	~RegExp();
 
 	RegExp& operator=(const RegExp&);
+	RegExp& operator=(RegExp&&);
 	RegExp& operator=(const std::wstring& strFullPattern);
 
 	// Compiles the regular expression
@@ -58,11 +80,11 @@ public:
 	std::wstring getSource() const { return m_strFullPattern; }
 
 	// do regexp matching, caller is responsible to free RegExpMatch*
-	RegExpMatch* exec(const std::wstring& str);
-	RegExpMatch* exec(const std::wstring& str, int lastPos);
+	bool exec(RegExpMatch& match, const std::wstring& str);
+	bool exec(RegExpMatch& match, const std::wstring& str, int lastPos);
 	// should use const version in multi-threading environment
-	RegExpMatch* exec(const std::wstring& str) const; 
-	RegExpMatch* exec(const std::wstring& str, int lastPos) const;
+	bool exec(RegExpMatch& match, const std::wstring& str) const; 
+	bool exec(RegExpMatch& match, const std::wstring& str, int lastPos) const;
 	// do regexp testing
 	bool test(const std::wstring& str);
 	bool test(const std::wstring& str) const; // should use const version in multi-threading environment
@@ -88,7 +110,7 @@ private:
 	void setAttributes();
 	void setAttributes(const std::wstring& strAttributes);
 
-	RegExpMatch* execCore(const std::wstring& str, int lastPos) const;
+	bool execCore(RegExpMatch& match, const std::wstring& str, int lastPos) const;
 	bool testCore(const std::wstring& str) const;
 };
 
diff --git a/plugin/re/strutils.cpp b/plugin/re/strutils.cpp
index 727e7a4..cae62df 100644
--- a/plugin/re/strutils.cpp
+++ b/plugin/re/strutils.cpp
@@ -20,11 +20,8 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 
 #include "StdAfx.h"
 
-#include <ctype.h>
 #include "RegExp.h"
 
-using namespace std;
-
 namespace re { namespace strutils {
 
 // See https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace#Specifying_a_string_as_a_parameter
@@ -34,9 +31,9 @@ namespace re { namespace strutils {
 // "abcdefghijklmn".replace(/(a)(b)(c)(d)(e)(f)(g)(h)(i)(j)(k)(l)(m)(n)/, "$10"): "j"
 // "abcdefghijklmn".replace(/(a)(b)(c)(d)(e)(f)(g)(h)(i)(j)(k)(l)(m)(n)/, "$15"): "a5"
 // "abcdefghijklmn".replace(/(a)(b)(c)(d)(e)(f)(g)(h)(i)(j)(k)(l)(m)(n)/, "$20"): "b0"
-void insertReplacedString(wstring& builder, const wstring& base, const wstring& str, const RegExpMatch* match)
+void insertReplacedString(wstring& builder, const wstring& base, const wstring& str, const RegExpMatch& match)
 {
-	const vector<wstring>& substrings = match->substrings;
+	const vector<wstring>& substrings = match.substrings;
 	const wstring& mstr = substrings[0];
 	for (size_t i = 0; i < str.length(); i++)
 	{
@@ -52,10 +49,10 @@ void insertReplacedString(wstring& builder, const wstring& base, const wstring&
 				builder.append(mstr);
 				break;
 			case L'`': // insert the portion preceding the matched string
-				builder.append(base.begin(), base.begin() + match->index);
+				builder.append(base.begin(), base.begin() + match.index);
 				break;
 			case L'\'': // insert the portion following the matched string
-				builder.append(base.begin() + match->index + mstr.length(), base.end());
+				builder.append(base.begin() + match.index + mstr.length(), base.end());
 				break;
 			default:
 				if (ch >= L'0' && ch <= L'9')
@@ -97,22 +94,25 @@ void insertReplacedString(wstring& builder, const wstring& base, const wstring&
 
 wstring replace(const wstring& base, const RegExp& re, const wstring& str)
 {
-	std::vector<RegExpMatch*> matches;
+	std::vector<RegExpMatch> matches;
+	RegExpMatch match;
+	bool ret;
 	if (re.isGlobal())
 	{
-		RegExpMatch* match = re.exec(base, 0);
-		while (match)
+		ret = re.exec(match, base, 0);
+		while (ret)
 		{
-			matches.push_back(match);
-			int advance = (int)match->substrings[0].length();
+			int advance = (int)match.substrings[0].length();
 			if (advance < 1) advance = 1;
-			match = re.exec(base, match->index + advance);
+			int lastPos = match.index + advance;
+			matches.push_back(std::move(match));
+			ret = re.exec(match, base, lastPos);
 		}
 	}
 	else
 	{
-		RegExpMatch* match = re.exec(base);
-		if (match) matches.push_back(match);
+		ret = re.exec(match, base);
+		if (ret) matches.push_back(std::move(match));
 	}
 
 	// do the replace
@@ -120,17 +120,13 @@ wstring replace(const wstring& base, const RegExp& re, const wstring& str)
 	size_t lastPos = 0;
 	for (size_t i = 0; i < matches.size(); i++)
 	{
-		RegExpMatch* match = matches[i];
-		builder.append(base.begin() + lastPos, base.begin() + match->index);
+		const RegExpMatch& match = matches[i];
+		builder.append(base.begin() + lastPos, base.begin() + match.index);
 		insertReplacedString(builder, base, str, match);
-		lastPos = match->index + match->substrings[0].length();
+		lastPos = match.index + match.substrings[0].length();
 	}
 	builder.append(base.begin() + lastPos, base.end());
 
-	for (size_t i = 0; i < matches.size(); i++)
-	{
-		delete matches[i];
-	}
 	return builder;
 }
 
@@ -165,25 +161,27 @@ wstring toLowerCase(wstring str)
 	return str;
 }
 
-RegExpMatch* match(const wstring& base, const RegExp& re)
+//RegExpMatch* match(const wstring& base, const RegExp& re)
+bool match(RegExpMatch& match, const std::wstring& base, const RegExp& re)
 {
-	if (!re.isGlobal()) return re.exec(base);
+	if (!re.isGlobal()) return re.exec(match, base);
 
-	RegExpMatch* res = new RegExpMatch();
-	res->index = 0;
+	match.index = 0;
+	match.input.clear();
+	match.substrings.clear();
 
-	RegExpMatch* match = re.exec(base, 0);
-	while (match)
+	RegExpMatch tmp;
+	bool ret = re.exec(tmp, base, 0);
+	while (ret)
 	{
-		res->substrings.push_back(match->substrings[0]);
-		int advance = (int)match->substrings[0].length();
+		int advance = (int)tmp.substrings[0].length();
 		if (advance < 1) advance = 1;
-		int lastPos = match->index + advance;
-		delete match;
-		match = re.exec(base, lastPos);
+		int lastPos = tmp.index + advance;
+		match.substrings.push_back(std::move(tmp.substrings[0]));
+		ret = re.exec(tmp, base, lastPos);
 	}
 
-	return res;
+	return true;
 }
 
 } } // namespace re::strutils
diff --git a/plugin/re/strutils.h b/plugin/re/strutils.h
index 2a3a316..a1e5d70 100644
--- a/plugin/re/strutils.h
+++ b/plugin/re/strutils.h
@@ -20,9 +20,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 // strutils.h : wstring utilities
 //
 
-#include <string>
-#include <vector>
-
 namespace re {
 	class RegExp;
 	struct RegExpMatch;
@@ -47,7 +44,7 @@ namespace re {
 
 		std::wstring replace(const std::wstring& base, const RegExp& re, const std::wstring& str);
 		std::vector<std::wstring> split(const std::wstring& base, const std::wstring& separator);
-		RegExpMatch* match(const std::wstring& base, const RegExp& re);
+		bool match(RegExpMatch& match, const std::wstring& base, const RegExp& re);
 		std::wstring toUpperCase(std::wstring str);
 		std::wstring toLowerCase(std::wstring str);
 	}
diff --git a/plugin/stdafx.h b/plugin/stdafx.h
index c797d88..e78c50a 100644
--- a/plugin/stdafx.h
+++ b/plugin/stdafx.h
@@ -30,6 +30,20 @@
 #include <atlctl.h>
 #include <atlutil.h>
 
+#include <mshtmcid.h>
+#include <mshtmhst.h>
+#include <mshtmdid.h>
+#include <mshtml.h>
+#include <exdispid.h>
+#include <comutil.h>
+
+#include <windows.h>
+#include <windowsx.h>
+#include <WinInet.h>
+#pragma comment(lib, "Wininet.lib")
+#include <urlmon.h>
+#pragma comment(lib, "urlmon.lib")
+
 #include "npapi.h"
 #include "npfunctions.h"
 #include "nptypes.h"
@@ -37,4 +51,17 @@
 #include "ProtocolCF.h"
 
 #include <math.h>
-#include <WinInet.h>
+#include <stdexcept>
+#include <string>
+#include <vector>
+#include <map>
+#include <unordered_map>
+#include <set>
+#include <unordered_set>
+#include <deque>
+#include <xhash>
+#include <algorithm>
+// std::function
+#include <functional>
+
+using namespace std;
diff --git a/plugin/test/test.cpp b/plugin/test/test.cpp
index 120eb23..f8c5fbe 100644
--- a/plugin/test/test.cpp
+++ b/plugin/test/test.cpp
@@ -24,7 +24,6 @@ along with Fire-IE.  If not, see <http://www.gnu.org/licenses/>.
 #include "re/RegExp.h"
 #include "Utils/TLD.h"
 
-using namespace std;
 using namespace re;
 using namespace re::strutils;
 using namespace Utils;
diff --git a/tools/np++.dtd.xml b/tools/np++.dtd.xml
new file mode 100644
index 0000000..0960dd9
--- /dev/null
+++ b/tools/np++.dtd.xml
@@ -0,0 +1,64 @@
+<NotepadPlus>
+    <UserLang name="DTD" ext="dtd" udlVersion="2.1">
+        <Settings>
+            <Global caseIgnored="no" allowFoldOfComments="yes" foldCompact="no" forcePureLC="0" decimalSeparator="0" />
+            <Prefix Keywords1="no" Keywords2="no" Keywords3="no" Keywords4="no" Keywords5="no" Keywords6="no" Keywords7="no" Keywords8="no" />
+        </Settings>
+        <KeywordLists>
+            <Keywords name="Comments">00 01 02 03&lt;!-- 04--&gt;</Keywords>
+            <Keywords name="Numbers, prefix1"></Keywords>
+            <Keywords name="Numbers, prefix2"></Keywords>
+            <Keywords name="Numbers, extras1"></Keywords>
+            <Keywords name="Numbers, extras2"></Keywords>
+            <Keywords name="Numbers, suffix1"></Keywords>
+            <Keywords name="Numbers, suffix2"></Keywords>
+            <Keywords name="Numbers, range"></Keywords>
+            <Keywords name="Operators1"></Keywords>
+            <Keywords name="Operators2"></Keywords>
+            <Keywords name="Folders in code1, open">&lt;!ENTITY</Keywords>
+            <Keywords name="Folders in code1, middle"></Keywords>
+            <Keywords name="Folders in code1, close">&gt;</Keywords>
+            <Keywords name="Folders in code2, open"></Keywords>
+            <Keywords name="Folders in code2, middle"></Keywords>
+            <Keywords name="Folders in code2, close"></Keywords>
+            <Keywords name="Folders in comment, open"></Keywords>
+            <Keywords name="Folders in comment, middle"></Keywords>
+            <Keywords name="Folders in comment, close"></Keywords>
+            <Keywords name="Keywords1"></Keywords>
+            <Keywords name="Keywords2"></Keywords>
+            <Keywords name="Keywords3"></Keywords>
+            <Keywords name="Keywords4"></Keywords>
+            <Keywords name="Keywords5"></Keywords>
+            <Keywords name="Keywords6"></Keywords>
+            <Keywords name="Keywords7"></Keywords>
+            <Keywords name="Keywords8"></Keywords>
+            <Keywords name="Delimiters">00&quot; 01 02&quot; 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23</Keywords>
+        </KeywordLists>
+        <Styles>
+            <WordsStyle name="DEFAULT" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="COMMENTS" fgColor="008040" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="LINE COMMENTS" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="NUMBERS" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="KEYWORDS1" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="KEYWORDS2" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="KEYWORDS3" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="KEYWORDS4" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="KEYWORDS5" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="KEYWORDS6" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="KEYWORDS7" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="KEYWORDS8" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="OPERATORS" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="FOLDER IN CODE1" fgColor="8000FF" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="FOLDER IN CODE2" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="FOLDER IN COMMENT" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="DELIMITERS1" fgColor="0080FF" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="DELIMITERS2" fgColor="8000FF" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="DELIMITERS3" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="DELIMITERS4" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="DELIMITERS5" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="DELIMITERS6" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="DELIMITERS7" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+            <WordsStyle name="DELIMITERS8" fgColor="000000" bgColor="FFFFFF" fontStyle="0" nesting="0" />
+        </Styles>
+    </UserLang>
+</NotepadPlus>
